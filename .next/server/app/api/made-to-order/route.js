"use strict";(()=>{var r={};r.id=6103,r.ids=[6103],r.modules={30517:r=>{r.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:r=>{r.exports=require("http")},95687:r=>{r.exports=require("https")},85477:r=>{r.exports=require("punycode")},12781:r=>{r.exports=require("stream")},57310:r=>{r.exports=require("url")},59796:r=>{r.exports=require("zlib")},89079:(r,e,o)=>{o.r(e),o.d(e,{headerHooks:()=>D,originalPathname:()=>_,patchFetch:()=>j,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>y});var t={};o.r(t),o.d(t,{DELETE:()=>p,GET:()=>u,POST:()=>c,PUT:()=>l});var s=o(95419),a=o(69108),n=o(99678),i=o(78070),d=o(4750);async function u(){try{console.log("\uD83D\uDD27 Fetching made-to-order products...");let{data:r,error:e}=await d.OQ.from("made_to_order_products").select("*").eq("is_active",!0).order("display_order",{ascending:!0});if(console.log("\uD83D\uDD27 Full query result:",{data:r,error:e}),e){console.log("\uD83D\uDD27 Trying without is_active filter...");let o=await d.OQ.from("made_to_order_products").select("*").order("display_order",{ascending:!0});r=o.data,e=o.error,console.log("\uD83D\uDD27 Simple query result:",{data:r,error:e})}if(e){console.log("\uD83D\uDD27 Trying basic query...");let o=await d.OQ.from("made_to_order_products").select("*");r=o.data,e=o.error,console.log("\uD83D\uDD27 Basic query result:",{data:r,error:e})}if(e)return console.error("❌ Error fetching made-to-order products:",e),i.Z.json({error:"Failed to fetch products",details:e.message,code:e.code},{status:500});return console.log("✅ Successfully fetched products:",r?.length||0),i.Z.json(r||[])}catch(r){return console.error("❌ Error in made-to-order GET:",r),i.Z.json({error:"Internal server error",details:r instanceof Error?r.message:"Unknown error"},{status:500})}}async function c(r){try{let{name:e,description:o,price:t,image:s,images:a,colors:n,sizes:u,category:c,tags:l,displayOrder:p}=await r.json();if(!e||!t)return i.Z.json({error:"Name and price are required"},{status:400});let m=s,g=a||[];s&&s.length>500&&(console.warn("⚠️ Image data is too large for VARCHAR(500) schema. Length:",s.length),console.warn("⚠️ Moving image to images array instead"),g=[s,...a||[]],m="");let{data:f,error:h}=await d.OQ.from("made_to_order_products").insert({name:e,description:o,price:t,image:m,images:g,colors:n||["Noir"],sizes:u||["S","M","L","XL"],category:c||"Custom",tags:l||[],display_order:p||0,is_active:!0}).select().single();if(h)return console.error("Error creating made-to-order product:",h),i.Z.json({error:"Failed to create product"},{status:500});return i.Z.json(f,{status:201})}catch(r){return console.error("Error in made-to-order POST:",r),i.Z.json({error:"Internal server error"},{status:500})}}async function l(r){try{let{id:e,name:o,description:t,price:s,image:a,images:n,colors:u,sizes:c,category:l,tags:p,displayOrder:m,isActive:g}=await r.json();if(!e)return i.Z.json({error:"Product ID is required"},{status:400});let f=a,h=n||[];a&&a.length>500&&(console.warn("⚠️ Image data is too large for VARCHAR(500) schema. Length:",a.length),console.warn("⚠️ Moving image to images array instead"),h=[a,...n||[]],f="");let{data:D,error:y}=await d.OQ.from("made_to_order_products").update({name:o,description:t,price:s,image:f,images:h,colors:u||["Noir"],sizes:c||["S","M","L","XL"],category:l||"Custom",tags:p||[],display_order:m,is_active:g}).eq("id",e).select().single();if(y)return console.error("Error updating made-to-order product:",y),i.Z.json({error:"Failed to update product"},{status:500});return i.Z.json(D)}catch(r){return console.error("Error in made-to-order PUT:",r),i.Z.json({error:"Internal server error"},{status:500})}}async function p(r){try{let{searchParams:e}=new URL(r.url),o=e.get("id");if(!o)return i.Z.json({error:"Product ID is required"},{status:400});let{error:t}=await d.OQ.from("made_to_order_products").delete().eq("id",o);if(t)return console.error("Error deleting made-to-order product:",t),i.Z.json({error:"Failed to delete product"},{status:500});return i.Z.json({message:"Product deleted successfully"})}catch(r){return console.error("Error in made-to-order DELETE:",r),i.Z.json({error:"Internal server error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/made-to-order/route",pathname:"/api/made-to-order",filename:"route",bundlePath:"app/api/made-to-order/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\projectt\\src\\app\\api\\made-to-order\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:h,headerHooks:D,staticGenerationBailout:y}=m,_="/api/made-to-order/route";function j(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}}};var e=require("../../../webpack-runtime.js");e.C(r);var o=r=>e(e.s=r),t=e.X(0,[1638,6206,2409,4750],()=>o(89079));module.exports=t})();