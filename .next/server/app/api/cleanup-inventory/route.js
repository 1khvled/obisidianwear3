"use strict";(()=>{var e={};e.id=9072,e.ids=[9072],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},38381:(e,r,o)=>{o.r(r),o.d(r,{headerHooks:()=>f,originalPathname:()=>I,patchFetch:()=>j,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>m});var t={};o.r(t),o.d(t,{POST:()=>p});var n=o(95419),s=o(69108),i=o(99678),c=o(78070),a=o(32409);let u="https://twlegtqcyydgjkycxngw.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3bGVndHFjeXlkZ2preWN4bmd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzQ2MDAsImV4cCI6MjA3Mjc1MDYwMH0.uD9GD_ksHCDgmmPAgR7fcLUAJHRJtTkT-J-SVjU-WR0";if(!u||!d)throw Error("Missing Supabase environment variables");let l=(0,a.eI)(u,d);async function p(){try{console.log("\uD83E\uDDF9 Starting inventory cleanup...");let{data:e,error:r}=await l.from("inventory").select("id, product_id, size, color");if(r)return console.error("âŒ Error fetching inventory records:",r),c.Z.json({success:!1,error:"Failed to fetch inventory records"},{status:500});if(!e||0===e.length)return console.log("âœ… No inventory records to clean up"),c.Z.json({success:!0,message:"No inventory records to clean up",cleaned:0});let{data:o,error:t}=await l.from("products").select("id, colors, sizes");if(t)return console.error("âŒ Error fetching products:",t),c.Z.json({success:!1,error:"Failed to fetch products"},{status:500});let n=new Set;o?.forEach(e=>{let r=e.colors||[],o=e.sizes||[];r.forEach(r=>{o.forEach(o=>{n.add(`${e.id}-${o}-${r}`)})})});let s=e.filter(e=>{let r=`${e.product_id}-${e.size}-${e.color}`;return!n.has(r)});if(console.log(`ðŸ” Found ${s.length} orphaned inventory records`),0===s.length)return console.log("âœ… No orphaned records found"),c.Z.json({success:!0,message:"No orphaned records found",cleaned:0});let i=s.map(e=>e.id),{error:a}=await l.from("inventory").delete().in("id",i);if(a)return console.error("âŒ Error deleting orphaned records:",a),c.Z.json({success:!1,error:"Failed to delete orphaned records"},{status:500});return console.log(`âœ… Successfully cleaned up ${s.length} orphaned inventory records`),c.Z.json({success:!0,message:`Cleaned up ${s.length} orphaned inventory records`,cleaned:s.length,orphanedRecords:s.map(e=>({id:e.id,product_id:e.product_id,size:e.size,color:e.color}))})}catch(e){return console.error("âŒ Error in inventory cleanup:",e),c.Z.json({success:!1,error:"Internal server error"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/cleanup-inventory/route",pathname:"/api/cleanup-inventory",filename:"route",bundlePath:"app/api/cleanup-inventory/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\Obsidian wear\\projectt\\src\\app\\api\\cleanup-inventory\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:y,headerHooks:f,staticGenerationBailout:m}=h,I="/api/cleanup-inventory/route";function j(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:v})}}};var r=require("../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[1638,6206,2409],()=>o(38381));module.exports=t})();