"use strict";(()=>{var e={};e.id=2e3,e.ids=[2e3],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},42118:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>q});var o={};t.r(o),t.d(o,{POST:()=>l});var n=t(95419),a=t(69108),i=t(99678),s=t(78070),u=t(4750);async function l(e){try{let{productId:r,size:t,color:o,quantity:n}=await e.json();if(!r||!t||!o||!n)return s.Z.json({error:"Missing required fields"},{status:400});console.log("\uD83D\uDD04 Restoring inventory from inventory table:",{productId:r,size:t,color:o,quantity:n});let{data:a,error:i}=await u.OQ.from("inventory").select("available_quantity, quantity, reserved_quantity").eq("product_id",r).eq("size",t).eq("color",o).single();if(i||!a)return console.error("❌ Error fetching inventory:",i),s.Z.json({error:"Inventory record not found"},{status:404});let l=Math.max(0,a.reserved_quantity-n),{error:d}=await u.OQ.from("inventory").update({reserved_quantity:l,last_updated:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("product_id",r).eq("size",t).eq("color",o);if(d)return console.error("❌ Error restoring inventory:",d),s.Z.json({error:"Failed to restore inventory"},{status:500});let{error:c}=await u.OQ.from("inventory_transactions").insert({id:`TXN-${Date.now()}-${r}-${t}-${o}`,product_id:r,size:t,color:o,transaction_type:"unreserve",quantity_change:-n,previous_quantity:a.quantity,new_quantity:a.quantity,reason:"Cart restoration",created_by:"system"});return c&&console.warn("Failed to log inventory transaction:",c),console.log("✅ Inventory restored successfully:",{productId:r,size:t,color:o,restored:n,available:a.quantity-l}),s.Z.json({success:!0,restored:n,available:a.quantity-l})}catch(e){return console.error("❌ Error in inventory restore:",e),s.Z.json({error:"Internal server error",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/inventory/restore/route",pathname:"/api/inventory/restore",filename:"route",bundlePath:"app/api/inventory/restore/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\Obsidian wear\\projectt\\src\\app\\api\\inventory\\restore\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:y,headerHooks:v,staticGenerationBailout:q}=d,g="/api/inventory/restore/route";function f(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:p})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,6206,2409,4750],()=>t(42118));module.exports=o})();