"use strict";(()=>{var e={};e.id=986,e.ids=[986],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},11039:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>q,originalPathname:()=>T,patchFetch:()=>R,requestAsyncStorage:()=>h,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>x});var s={};r.r(s),r.d(s,{GET:()=>d,POST:()=>m});var a=r(95419),n=r(69108),i=r(99678),o=r(78070),u=r(4750);class c{constructor(e=6e4,t=100){this.requests=new Map,this.windowMs=e,this.maxRequests=t}isAllowed(e){let t=Date.now(),r=this.requests.get(e);return!r||t>r.resetTime?(this.requests.set(e,{count:1,resetTime:t+this.windowMs}),{allowed:!0,remaining:this.maxRequests-1,resetTime:t+this.windowMs}):r.count>=this.maxRequests?{allowed:!1,remaining:0,resetTime:r.resetTime}:(r.count++,this.requests.set(e,r),{allowed:!0,remaining:this.maxRequests-r.count,resetTime:r.resetTime})}cleanup(){let e=Date.now();this.requests.forEach((t,r)=>{e>t.resetTime&&this.requests.delete(r)})}}let l=new c(6e4,100);async function d(){try{let e=await (0,u.Qu)(),t=o.Z.json(e);return t.headers.set("Cache-Control","public, max-age=30, stale-while-revalidate=60"),t.headers.set("Pragma","no-cache"),t.headers.set("Expires",new Date(Date.now()+3e4).toUTCString()),t}catch(e){return o.Z.json({error:"Failed to fetch maintenance settings",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}new c(3e5,5);let m=function(e){return async(t,...r)=>{let s=new URL(t.url);if(["/api/maintenance","/api/test-db","/api/test-supabase"].some(e=>s.pathname.startsWith(e)))return e(t,...r);let a=function(e,t){let r=t.isAllowed(e);.01>Math.random()&&t.cleanup();let s={"X-RateLimit-Limit":t.maxRequests.toString(),"X-RateLimit-Remaining":r.remaining.toString(),"X-RateLimit-Reset":new Date(r.resetTime).toISOString()};return{allowed:r.allowed,headers:s}}(t.ip||t.headers.get("x-forwarded-for")||"unknown",l);return a.allowed?!function(e){let t=e.headers.get("authorization");return!!(t&&t.startsWith("Bearer "))&&t.substring(7)===(process.env.NEXT_PUBLIC_API_AUTH_TOKEN||"obsidian-api-token-2025")}(t)?o.Z.json({success:!1,error:"Unauthorized",message:"Authentication required"},{status:401,headers:a.headers}):e(t,...r):o.Z.json({success:!1,error:"Too Many Requests",message:"Rate limit exceeded. Please try again later."},{status:429,headers:a.headers})}}(async e=>{try{let{is_maintenance_mode:t,drop_date:r,maintenance_message:s}=await e.json(),a=await (0,u.Qc)({is_maintenance_mode:t,drop_date:r,maintenance_message:s});return o.Z.json(a)}catch(e){return o.Z.json({error:"Failed to update maintenance settings",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}),p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/maintenance/route",pathname:"/api/maintenance",filename:"route",bundlePath:"app/api/maintenance/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\Obsidian wear\\projectt\\src\\app\\api\\maintenance\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:w,serverHooks:g,headerHooks:q,staticGenerationBailout:x}=p,T="/api/maintenance/route";function R(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:w})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,2409,4750],()=>r(11039));module.exports=s})();