"use strict";(()=>{var e={};e.id=9684,e.ids=[9684],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},17035:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>z,originalPathname:()=>j,patchFetch:()=>b,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>P});var s={};r.r(s),r.d(s,{DELETE:()=>p,GET:()=>l,POST:()=>m,runtime:()=>d});var i=r(95419),a=r(69108),o=r(99678),n=r(78070),u=r(4750);class c{static sanitizeHtml(e){return"string"!=typeof e?"":e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}static isValidEmail(e){return"string"==typeof e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())}static isValidPhone(e){return"string"==typeof e&&/^[\+]?[0-9\s\-\(\)]{8,}$/.test(e.trim())}static validateRequired(e,t){let r=[];for(let s of t)e[s]&&("string"!=typeof e[s]||""!==e[s].trim())||r.push(s);return{isValid:0===r.length,missingFields:r}}static validateLength(e,t,r){if("string"!=typeof e)return!1;let s=e.trim().length;return s>=t&&s<=r}static isValidNumber(e,t,r){let s=Number(e);return!isNaN(s)&&(void 0===t||!(s<t))&&(void 0===r||!(s>r))}static sanitizeProductData(e){return{...e,name:this.sanitizeHtml(e.name||""),description:this.sanitizeHtml(e.description||""),category:this.sanitizeHtml(e.category||""),price:this.isValidNumber(e.price,0,999999)?Number(e.price):0,stock:e.stock||{},image:this.sanitizeHtml(e.image||""),colors:Array.isArray(e.colors)?e.colors.map(e=>this.sanitizeHtml(e)):[],sizes:Array.isArray(e.sizes)?e.sizes.map(e=>this.sanitizeHtml(e)):[]}}static sanitizeOrderData(e){return{...e,customerName:this.sanitizeHtml(e.customerName||""),customerEmail:this.isValidEmail(e.customerEmail)?e.customerEmail.trim():"",customerPhone:this.isValidPhone(e.customerPhone)?e.customerPhone.trim():"",customerAddress:this.sanitizeHtml(e.customerAddress||""),productName:this.sanitizeHtml(e.productName||""),selectedSize:this.sanitizeHtml(e.selectedSize||""),selectedColor:this.sanitizeHtml(e.selectedColor||""),notes:this.sanitizeHtml(e.notes||""),quantity:this.isValidNumber(e.quantity,1,100)?Number(e.quantity):1,total:this.isValidNumber(e.total,0,999999)?Number(e.total):0}}}let d="nodejs";async function l(){try{let e=await (0,u.Xp)(),t=n.Z.json({success:!0,data:e,count:e.length,timestamp:Date.now()});return t.headers.set("Cache-Control","no-cache, no-store, must-revalidate"),t.headers.set("Pragma","no-cache"),t.headers.set("Expires","0"),t}catch(e){return n.Z.json({success:!1,error:"Failed to fetch products"},{status:500})}}async function m(e){try{let t=await e.json(),r=c.validateRequired(t,["name","price"]);if(!r.isValid)return n.Z.json({success:!1,error:`Missing required fields: ${r.missingFields.join(", ")}`},{status:400});if(!c.validateLength(t.name,1,100))return n.Z.json({success:!1,error:"Product name must be between 1 and 100 characters"},{status:400});if(!c.isValidNumber(t.price,0,999999))return n.Z.json({success:!1,error:"Price must be a valid number between 0 and 999999"},{status:400});let s=c.sanitizeProductData(t),i={id:Date.now().toString(),...s,createdAt:new Date,updatedAt:new Date};try{let e=await (0,u.gK)(i);if(!e)return n.Z.json({success:!1,error:"Failed to create product - addProduct returned null"},{status:500});return n.Z.json({success:!0,data:e,message:"Product created successfully"})}catch(e){return n.Z.json({success:!1,error:"Failed to create product",details:e instanceof Error?e.message:"Unknown error",errorType:typeof e,fullError:JSON.stringify(e,null,2)},{status:500})}}catch(e){return n.Z.json({success:!1,error:"Failed to create product",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("id");if(!r)return n.Z.json({success:!1,error:"Product ID is required"},{status:400});if(await (0,u.Ir)(r))return n.Z.json({success:!0,message:"Product deleted successfully",deletedId:r});return n.Z.json({success:!1,error:"Failed to delete product"},{status:500})}catch(e){return n.Z.json({success:!1,error:"Failed to delete product",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let h=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\Obsidian wear\\projectt\\src\\app\\api\\products\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:y,headerHooks:z,staticGenerationBailout:P}=h,j="/api/products/route";function b(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,2409,4750],()=>r(17035));module.exports=s})();