"use strict";(()=>{var e={};e.id=87,e.ids=[87],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},883:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>y,originalPathname:()=>P,patchFetch:()=>j,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>w,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>v});var t={};s.r(t),s.d(t,{DELETE:()=>f,GET:()=>l,PUT:()=>p,runtime:()=>c});var o=s(5419),n=s(9108),a=s(9678),i=s(8070),u=s(4750),d=s(9372);let c="nodejs";async function l(e,{params:r}){try{let{id:e}=r,s=await (0,u.co)(e);if(!s)return i.Z.json({success:!1,error:"Order not found"},{status:404});return console.log("Orders API: GET single order:",e),i.Z.json({success:!0,data:s,timestamp:Date.now()})}catch(e){return console.error("Orders API: GET single error:",e),i.Z.json({success:!1,error:"Failed to fetch order"},{status:500})}}async function p(e,{params:r}){try{let{id:t}=r,o=await e.json(),n=await (0,u.co)(t);if(n&&"cancelled"===o.status&&"cancelled"!==n.status){let{returnStockFromOrder:e}=await s.e(814).then(s.bind(s,4814));await e(n),console.log("Orders API: Returned stock for cancelled order:",t)}let a=await (0,u.Cs)(t,o);if(!a)return i.Z.json({success:!1,error:"Order not found"},{status:404});return console.log("Orders API: PUT request - updated order:",t),i.Z.json({success:!0,data:a,message:"cancelled"===o.status?"Order cancelled and stock returned to inventory":"Order updated successfully",timestamp:Date.now()})}catch(e){return console.error("Orders API: PUT error:",e),i.Z.json({success:!1,error:"Failed to update order"},{status:500})}}let f=(0,d.x)(async(e,{params:r})=>{try{let{id:e}=r,s=await (0,u.co)(e);if(!s)return i.Z.json({success:!1,error:"Order not found"},{status:404});if(!await (0,u.wH)(e))return i.Z.json({success:!1,error:"Failed to delete order"},{status:500});return console.log("Orders API: DELETE request - deleted order and returned stock:",e),i.Z.json({success:!0,data:s,message:"Order deleted successfully and stock returned to inventory",timestamp:Date.now()})}catch(e){return console.error("Orders API: DELETE error:",e),i.Z.json({success:!1,error:"Failed to delete order"},{status:500})}}),h=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/orders/[id]/route",pathname:"/api/orders/[id]",filename:"route",bundlePath:"app/api/orders/[id]/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\projectt\\src\\app\\api\\orders\\[id]\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:w,headerHooks:y,staticGenerationBailout:v}=h,P="/api/orders/[id]/route";function j(){return(0,a.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:g})}},9372:(e,r,s)=>{s.d(r,{x:()=>i});var t=s(8070);async function o(e){try{let r=e.headers.get("x-session-id")||e.cookies.get("obsidian-admin-session-id")?.value;if(!r)return console.log("No session ID found in request"),t.Z.json({error:"Authentication required"},{status:401});console.log("Checking session:",r);let s=await n(r);if(!s||!s.isActive)return t.Z.json({error:"Invalid or expired session"},{status:401});let o=new Date,i=new Date(s.expiresAt);if(o>i)return await a(r),t.Z.json({error:"Session expired"},{status:401});return e.user={username:s.username,sessionId:s.sessionId},null}catch(e){return console.error("Authentication error:",e),t.Z.json({error:"Authentication failed"},{status:500})}}async function n(e){try{let{supabase:r}=await Promise.resolve().then(s.bind(s,4750));if(!r)return null;let{data:t,error:o}=await r.from("admin_sessions").select("*").eq("session_id",e).eq("is_active",!0).single();if(o&&"PGRST116"!==o.code)return console.error("Error fetching session:",o),null;return t}catch(e){return console.error("Error verifying session:",e),null}}async function a(e){try{let{supabase:r}=await Promise.resolve().then(s.bind(s,4750));if(!r)return!1;let{error:t}=await r.from("admin_sessions").update({is_active:!1}).eq("session_id",e);return!t}catch(e){return console.error("Error deactivating session:",e),!1}}function i(e){return async(r,s)=>await o(r)||e(r,s)}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[638,206,409,750],()=>s(883));module.exports=t})();