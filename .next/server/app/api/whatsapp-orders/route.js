"use strict";(()=>{var e={};e.id=3229,e.ids=[3229],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},93038:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>v,patchFetch:()=>I,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>w,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>_});var s={};r.r(s),r.d(s,{POST:()=>l});var o=r(95419),a=r(69108),i=r(99678),u=r(78070),n=r(32409);let c="https://twlegtqcyydgjkycxngw.supabase.co",p="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3bGVndHFjeXlkZ2preWN4bmd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzQ2MDAsImV4cCI6MjA3Mjc1MDYwMH0.uD9GD_ksHCDgmmPAgR7fcLUAJHRJtTkT-J-SVjU-WR0";if(!c||!p)throw Error("Missing Supabase environment variables");let d=(0,n.eI)(c,p);async function l(e){try{let t=await e.json();if(!c||!p)return u.Z.json({success:!1,error:"Missing Supabase configuration"},{status:500});let r=`whatsapp_order_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s=`customer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,o={id:s,name:t.customer.name,phone:t.customer.phone,email:t.customer.email||null,address:t.customer.address||null,wilaya:t.customer.wilaya,created_at:new Date().toISOString()},a={id:r,customer_id:s,product_name:t.product.name,product_price:t.product.price,product_type:"made-to-order",selected_size:t.product.customSize||"Custom",selected_color:t.product.customColor||"Custom",quantity:t.product.quantity||1,subtotal:t.product.price*(t.product.quantity||1),delivery_option:t.delivery?.option||"domicile",delivery_cost:t.delivery?.cost||0,total_price:t.product.price*(t.product.quantity||1)+(t.delivery?.cost||0),status:"pending_whatsapp_confirmation",order_source:"whatsapp",notes:t.product.notes||"Custom made-to-order item",created_at:new Date().toISOString()},{data:i,error:n}=await d.from("customers").select("count").limit(1);if(n)return u.Z.json({success:!1,error:"Database connection failed: "+n.message},{status:500});let{data:l,error:m}=await d.from("customers").insert([o]).select().single();if(m)return u.Z.json({success:!1,error:"Failed to save customer data: "+m.message},{status:500});let{data:h,error:g}=await d.from("orders").insert([a]).select().single();if(g)return u.Z.json({success:!1,error:"Failed to save order data: "+g.message},{status:500});return u.Z.json({success:!0,order:h,message:"WhatsApp order saved successfully"},{status:200})}catch(e){return u.Z.json({success:!1,error:"Internal server error: "+e.message},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/whatsapp-orders/route",pathname:"/api/whatsapp-orders",filename:"route",bundlePath:"app/api/whatsapp-orders/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\Obsidian wear\\projectt\\src\\app\\api\\whatsapp-orders\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:w,headerHooks:y,staticGenerationBailout:_}=m,v="/api/whatsapp-orders/route";function I(){return(0,i.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,2409],()=>r(93038));module.exports=s})();