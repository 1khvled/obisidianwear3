"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_lib_optimizedDatabase_ts";
exports.ids = ["_rsc_src_lib_optimizedDatabase_ts"];
exports.modules = {

/***/ "(rsc)/./src/lib/optimizedDatabase.ts":
/*!**************************************!*\
  !*** ./src/lib/optimizedDatabase.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addOrder: () => (/* binding */ addOrder),\n/* harmony export */   addProduct: () => (/* binding */ addProduct),\n/* harmony export */   dbCache: () => (/* binding */ dbCache),\n/* harmony export */   deleteOrder: () => (/* binding */ deleteOrder),\n/* harmony export */   deleteProduct: () => (/* binding */ deleteProduct),\n/* harmony export */   getMaintenanceStatus: () => (/* binding */ getMaintenanceStatus),\n/* harmony export */   getOrder: () => (/* binding */ getOrder),\n/* harmony export */   getOrders: () => (/* binding */ getOrders),\n/* harmony export */   getProduct: () => (/* binding */ getProduct),\n/* harmony export */   getProducts: () => (/* binding */ getProducts),\n/* harmony export */   returnStockFromOrder: () => (/* binding */ returnStockFromOrder),\n/* harmony export */   setMaintenanceStatus: () => (/* binding */ setMaintenanceStatus),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   updateOrder: () => (/* binding */ updateOrder),\n/* harmony export */   updateProduct: () => (/* binding */ updateProduct)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n// Optimized database service with aggressive caching and connection optimization\n\n// Supabase configuration\nconst supabaseUrl = \"https://zrmxcjklkthpyanfslsw.supabase.co\";\nconst supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpybXhjamtsa3RocHlhbmZzbHN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5MDYxMzAsImV4cCI6MjA3MjQ4MjEzMH0.2Tjh9pPzc6BUGoV3lDUBymXzE_dvAGs1O_WewTdetE0\";\n// Only throw error during server-side rendering, not during build or client-side\nif (!supabaseUrl || !supabaseKey) {\n    if (true) {\n        throw new Error(\"Missing Supabase environment variables\");\n    }\n}\n// Create optimized Supabase client with better connection settings\nconst supabase = supabaseUrl && supabaseKey ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseKey, {\n    db: {\n        schema: \"public\"\n    },\n    auth: {\n        persistSession: false,\n        autoRefreshToken: false\n    },\n    global: {\n        headers: {\n            \"Cache-Control\": \"max-age=60\"\n        }\n    }\n}) : null;\n// Aggressive caching system\nclass DatabaseCache {\n    set(key, data, ttl = this.DEFAULT_TTL) {\n        this.cache.set(key, {\n            data,\n            timestamp: Date.now(),\n            ttl\n        });\n    }\n    get(key) {\n        const item = this.cache.get(key);\n        if (!item) return null;\n        const now = Date.now();\n        if (now - item.timestamp > item.ttl) {\n            this.cache.delete(key);\n            return null;\n        }\n        return item.data;\n    }\n    invalidate(pattern) {\n        if (pattern) {\n            const keysToDelete = [];\n            this.cache.forEach((_, key)=>{\n                if (key.includes(pattern)) {\n                    keysToDelete.push(key);\n                }\n            });\n            keysToDelete.forEach((key)=>this.cache.delete(key));\n        } else {\n            this.cache.clear();\n        }\n    }\n    // Preload critical data\n    async preloadCriticalData() {\n        try {\n            console.log(\"Preloading critical data...\");\n            // Preload products\n            const products = await this.getProducts();\n            this.set(\"products\", products, this.LONG_TTL);\n            // Preload maintenance status\n            const maintenance = await this.getMaintenanceStatus();\n            this.set(\"maintenance\", maintenance, this.DEFAULT_TTL);\n            console.log(\"Critical data preloaded successfully\");\n        } catch (error) {\n            console.error(\"Error preloading data:\", error);\n        }\n    }\n    async getProducts() {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return [];\n        }\n        const { data, error } = await supabase.from(\"products\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return (data || []).map(convertDbProductToProduct);\n    }\n    async getMaintenanceStatus() {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return {\n                is_maintenance: false,\n                drop_date: null\n            };\n        }\n        const { data, error } = await supabase.from(\"maintenance_status\").select(\"*\").single();\n        if (error) throw error;\n        return data;\n    }\n    constructor(){\n        this.cache = new Map();\n        this.DEFAULT_TTL = 60000 // 1 minute default\n        ;\n        this.LONG_TTL = 300000 // 5 minutes for static data\n        ;\n    }\n}\nconst dbCache = new DatabaseCache();\n// Helper function to convert database product to Product interface\nfunction convertDbProductToProduct(dbProduct) {\n    return {\n        id: dbProduct.id,\n        name: dbProduct.name,\n        description: dbProduct.description,\n        price: dbProduct.price,\n        originalPrice: dbProduct.original_price,\n        image: dbProduct.image,\n        images: dbProduct.images || [],\n        stock: dbProduct.stock || {},\n        category: dbProduct.category,\n        sizes: dbProduct.sizes || [],\n        colors: dbProduct.colors || [],\n        inStock: dbProduct.in_stock,\n        status: dbProduct.status || \"available\",\n        rating: dbProduct.rating || 0,\n        reviews: dbProduct.reviews || 0,\n        sku: dbProduct.sku,\n        weight: dbProduct.weight,\n        dimensions: dbProduct.dimensions,\n        tags: dbProduct.tags || [],\n        featured: dbProduct.featured || false,\n        createdAt: new Date(dbProduct.created_at),\n        updatedAt: new Date(dbProduct.updated_at)\n    };\n}\n// Optimized Products operations\nasync function getProducts() {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return [];\n        }\n        // Check cache first\n        const cached = dbCache.get(\"products\");\n        if (cached) {\n            console.log(\"Database: Returning cached products\");\n            return cached;\n        }\n        console.log(\"Database: Fetching products from Supabase\");\n        const { data, error } = await supabase.from(\"products\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        if (error) {\n            console.error(\"Database getProducts error:\", error);\n            return [];\n        }\n        const products = (data || []).map(convertDbProductToProduct);\n        // Cache for 5 minutes (products don't change often)\n        dbCache.set(\"products\", products, 300000);\n        return products;\n    } catch (error) {\n        console.error(\"Database getProducts error:\", error);\n        return [];\n    }\n}\nasync function getProduct(id) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return null;\n        }\n        // Check cache first\n        const cached = dbCache.get(`product_${id}`);\n        if (cached) {\n            return cached;\n        }\n        const { data, error } = await supabase.from(\"products\").select(\"*\").eq(\"id\", id).single();\n        if (error) {\n            console.error(\"Database getProduct error:\", error);\n            return null;\n        }\n        const product = convertDbProductToProduct(data);\n        // Cache for 5 minutes\n        dbCache.set(`product_${id}`, product, 300000);\n        return product;\n    } catch (error) {\n        console.error(\"Database getProduct error:\", error);\n        return null;\n    }\n}\nasync function addProduct(product) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            throw new Error(\"Database not available\");\n        }\n        const dbProduct = {\n            id: product.id,\n            name: product.name,\n            description: product.description,\n            price: product.price,\n            original_price: product.originalPrice,\n            image: product.image,\n            images: product.images || [],\n            stock: product.stock,\n            category: product.category,\n            sizes: product.sizes || [],\n            colors: product.colors || [],\n            in_stock: product.inStock,\n            rating: product.rating,\n            reviews: product.reviews,\n            sku: product.sku,\n            weight: product.weight,\n            dimensions: product.dimensions,\n            tags: product.tags || [],\n            featured: product.featured || false\n        };\n        const { data, error } = await supabase.from(\"products\").insert([\n            dbProduct\n        ]).select().single();\n        if (error) {\n            console.error(\"Database addProduct error:\", error);\n            throw error;\n        }\n        const newProduct = convertDbProductToProduct(data);\n        // Invalidate products cache\n        dbCache.invalidate(\"products\");\n        return newProduct;\n    } catch (error) {\n        console.error(\"Database addProduct error:\", error);\n        throw error;\n    }\n}\nasync function updateProduct(id, updates) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            throw new Error(\"Database not available\");\n        }\n        const dbUpdates = {};\n        if (updates.name !== undefined) dbUpdates.name = updates.name;\n        if (updates.description !== undefined) dbUpdates.description = updates.description;\n        if (updates.price !== undefined) dbUpdates.price = updates.price;\n        if (updates.originalPrice !== undefined) dbUpdates.original_price = updates.originalPrice;\n        if (updates.image !== undefined) dbUpdates.image = updates.image;\n        if (updates.images !== undefined) dbUpdates.images = updates.images;\n        if (updates.stock !== undefined) dbUpdates.stock = updates.stock;\n        if (updates.category !== undefined) dbUpdates.category = updates.category;\n        if (updates.sizes !== undefined) dbUpdates.sizes = updates.sizes;\n        if (updates.colors !== undefined) dbUpdates.colors = updates.colors;\n        if (updates.inStock !== undefined) dbUpdates.in_stock = updates.inStock;\n        if (updates.rating !== undefined) dbUpdates.rating = updates.rating;\n        if (updates.reviews !== undefined) dbUpdates.reviews = updates.reviews;\n        if (updates.sku !== undefined) dbUpdates.sku = updates.sku;\n        if (updates.weight !== undefined) dbUpdates.weight = updates.weight;\n        if (updates.dimensions !== undefined) dbUpdates.dimensions = updates.dimensions;\n        if (updates.tags !== undefined) dbUpdates.tags = updates.tags;\n        if (updates.featured !== undefined) dbUpdates.featured = updates.featured;\n        const { data, error } = await supabase.from(\"products\").update(dbUpdates).eq(\"id\", id).select().single();\n        if (error) {\n            console.error(\"Database updateProduct error:\", error);\n            throw error;\n        }\n        const updatedProduct = convertDbProductToProduct(data);\n        // Invalidate caches\n        dbCache.invalidate(\"products\");\n        dbCache.invalidate(`product_${id}`);\n        return updatedProduct;\n    } catch (error) {\n        console.error(\"Database updateProduct error:\", error);\n        throw error;\n    }\n}\nasync function deleteProduct(id) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            throw new Error(\"Database not available\");\n        }\n        const { error } = await supabase.from(\"products\").delete().eq(\"id\", id);\n        if (error) {\n            console.error(\"Database deleteProduct error:\", error);\n            throw error;\n        }\n        // Invalidate caches\n        dbCache.invalidate(\"products\");\n        dbCache.invalidate(`product_${id}`);\n    } catch (error) {\n        console.error(\"Database deleteProduct error:\", error);\n        throw error;\n    }\n}\n// Optimized Orders operations\nasync function getOrders() {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return [];\n        }\n        // Check cache first\n        const cached = dbCache.get(\"orders\");\n        if (cached) {\n            console.log(\"Database: Returning cached orders\");\n            return cached;\n        }\n        console.log(\"Database: Fetching orders from Supabase\");\n        const { data, error } = await supabase.from(\"orders\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        if (error) {\n            console.error(\"Database getOrders error:\", error);\n            return [];\n        }\n        const orders = (data || []).map((order)=>({\n                ...order,\n                createdAt: new Date(order.created_at),\n                updatedAt: new Date(order.updated_at)\n            }));\n        // Cache for 1 minute (orders change more frequently)\n        dbCache.set(\"orders\", orders, 60000);\n        return orders;\n    } catch (error) {\n        console.error(\"Database getOrders error:\", error);\n        return [];\n    }\n}\nasync function getOrder(id) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return null;\n        }\n        // Check cache first\n        const cached = dbCache.get(`order_${id}`);\n        if (cached) {\n            return cached;\n        }\n        const { data, error } = await supabase.from(\"orders\").select(\"*\").eq(\"id\", id).single();\n        if (error) {\n            console.error(\"Database getOrder error:\", error);\n            return null;\n        }\n        const order = {\n            ...data,\n            createdAt: new Date(data.created_at),\n            updatedAt: new Date(data.updated_at)\n        };\n        // Cache for 1 minute\n        dbCache.set(`order_${id}`, order, 60000);\n        return order;\n    } catch (error) {\n        console.error(\"Database getOrder error:\", error);\n        return null;\n    }\n}\nasync function addOrder(order) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            throw new Error(\"Database not available\");\n        }\n        const dbOrder = {\n            id: order.id,\n            product_id: order.productId,\n            product_name: order.productName,\n            product_image: order.productImage,\n            customer_name: order.customerName,\n            customer_email: order.customerEmail,\n            customer_phone: order.customerPhone,\n            customer_address: order.customerAddress,\n            wilaya_id: order.wilayaId,\n            wilaya_name: order.wilayaName,\n            shipping_type: order.shippingType,\n            shipping_cost: order.shippingCost,\n            quantity: order.quantity,\n            selected_size: order.selectedSize,\n            selected_color: order.selectedColor,\n            subtotal: order.subtotal,\n            total: order.total,\n            status: order.status,\n            tracking_number: order.trackingNumber,\n            notes: order.notes,\n            payment_method: order.paymentMethod,\n            payment_status: order.paymentStatus,\n            estimated_delivery: order.estimatedDelivery,\n            order_date: order.orderDate,\n            created_at: order.createdAt,\n            updated_at: order.updatedAt\n        };\n        const { data, error } = await supabase.from(\"orders\").insert([\n            dbOrder\n        ]).select().single();\n        if (error) {\n            console.error(\"Database addOrder error:\", error);\n            throw error;\n        }\n        const newOrder = {\n            ...data,\n            createdAt: new Date(data.created_at),\n            updatedAt: new Date(data.updated_at)\n        };\n        // Invalidate orders cache\n        dbCache.invalidate(\"orders\");\n        return newOrder;\n    } catch (error) {\n        console.error(\"Database addOrder error:\", error);\n        throw error;\n    }\n}\nasync function updateOrder(id, updates) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            throw new Error(\"Database not available\");\n        }\n        const dbUpdates = {};\n        if (updates.status !== undefined) dbUpdates.status = updates.status;\n        if (updates.customerName !== undefined) dbUpdates.customer_name = updates.customerName;\n        if (updates.customerEmail !== undefined) dbUpdates.customer_email = updates.customerEmail;\n        if (updates.customerPhone !== undefined) dbUpdates.customer_phone = updates.customerPhone;\n        if (updates.customerAddress !== undefined) dbUpdates.customer_address = updates.customerAddress;\n        if (updates.total !== undefined) dbUpdates.total = updates.total;\n        if (updates.paymentMethod !== undefined) dbUpdates.payment_method = updates.paymentMethod;\n        if (updates.notes !== undefined) dbUpdates.notes = updates.notes;\n        const { data, error } = await supabase.from(\"orders\").update(dbUpdates).eq(\"id\", id).select().single();\n        if (error) {\n            console.error(\"Database updateOrder error:\", error);\n            throw error;\n        }\n        const updatedOrder = {\n            ...data,\n            createdAt: new Date(data.created_at),\n            updatedAt: new Date(data.updated_at)\n        };\n        // Invalidate caches\n        dbCache.invalidate(\"orders\");\n        dbCache.invalidate(`order_${id}`);\n        return updatedOrder;\n    } catch (error) {\n        console.error(\"Database updateOrder error:\", error);\n        throw error;\n    }\n}\nasync function deleteOrder(id) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            throw new Error(\"Database not available\");\n        }\n        // First, get the order to return stock\n        const order = await getOrder(id);\n        if (order) {\n            // Return stock for the order\n            await returnStockFromOrder(order);\n        }\n        const { error } = await supabase.from(\"orders\").delete().eq(\"id\", id);\n        if (error) {\n            console.error(\"Database deleteOrder error:\", error);\n            throw error;\n        }\n        // Invalidate caches\n        dbCache.invalidate(\"orders\");\n        dbCache.invalidate(`order_${id}`);\n        dbCache.invalidate(\"products\"); // Invalidate products cache since stock changed\n    } catch (error) {\n        console.error(\"Database deleteOrder error:\", error);\n        throw error;\n    }\n}\n// Optimized Maintenance operations\nasync function getMaintenanceStatus() {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return {\n                is_maintenance: false,\n                drop_date: null\n            };\n        }\n        // Check cache first\n        const cached = dbCache.get(\"maintenance\");\n        if (cached) {\n            return cached;\n        }\n        const { data, error } = await supabase.from(\"maintenance_status\").select(\"*\").single();\n        if (error) {\n            console.error(\"Database getMaintenanceStatus error:\", error);\n            return null;\n        }\n        // Cache for 30 seconds\n        dbCache.set(\"maintenance\", data, 30000);\n        return data;\n    } catch (error) {\n        console.error(\"Database getMaintenanceStatus error:\", error);\n        return null;\n    }\n}\nasync function setMaintenanceStatus(isMaintenance, dropDate) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return false;\n        }\n        const { error } = await supabase.from(\"maintenance_status\").upsert({\n            id: \"maintenance\",\n            is_maintenance: isMaintenance,\n            drop_date: dropDate || new Date().toISOString(),\n            updated_at: new Date().toISOString()\n        });\n        if (error) {\n            console.error(\"Database setMaintenanceStatus error:\", error);\n            return false;\n        }\n        // Invalidate maintenance cache\n        dbCache.invalidate(\"maintenance\");\n        return true;\n    } catch (error) {\n        console.error(\"Database setMaintenanceStatus error:\", error);\n        return false;\n    }\n}\n// Stock return function for cancelled/deleted orders\nasync function returnStockFromOrder(order) {\n    try {\n        if (!supabase) {\n            console.error(\"Supabase client not initialized\");\n            return false;\n        }\n        console.log(\"Database: Returning stock for order:\", order.id);\n        // Get the product\n        const product = await getProduct(order.productId);\n        if (!product) {\n            console.error(\"Database: Product not found for order:\", order.productId);\n            return false;\n        }\n        // Get current stock\n        const currentStock = product.stock?.[order.selectedSize]?.[order.selectedColor] || 0;\n        // Return the stock\n        const newStock = {\n            ...product.stock,\n            [order.selectedSize]: {\n                ...product.stock?.[order.selectedSize],\n                [order.selectedColor]: currentStock + order.quantity\n            }\n        };\n        // Update the product stock\n        const updatedProduct = await updateProduct(order.productId, {\n            stock: newStock,\n            inStock: calculateTotalStock(newStock) > 0\n        });\n        if (updatedProduct) {\n            console.log(\"Database: Successfully returned stock for order:\", order.id, {\n                productId: order.productId,\n                size: order.selectedSize,\n                color: order.selectedColor,\n                quantity: order.quantity,\n                newTotalStock: calculateTotalStock(newStock)\n            });\n            // Invalidate product cache\n            dbCache.invalidate(\"products\");\n            dbCache.invalidate(`product_${order.productId}`);\n            return true;\n        } else {\n            console.error(\"Database: Failed to return product stock for order:\", order.id);\n            return false;\n        }\n    } catch (error) {\n        console.error(\"Database: Error returning stock for order:\", error);\n        return false;\n    }\n}\n// Helper function to calculate total stock\nfunction calculateTotalStock(stock) {\n    if (!stock || typeof stock !== \"object\") return 0;\n    let total = 0;\n    Object.values(stock).forEach((colorStock)=>{\n        if (colorStock && typeof colorStock === \"object\") {\n            Object.values(colorStock).forEach((qty)=>{\n                if (typeof qty === \"number\") {\n                    total += qty;\n                }\n            });\n        }\n    });\n    return total;\n}\n// Initialize cache on module load\nif (false) {}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGFBQWE7Z0JBQzFCSixVQUFVN0UsTUFBTTZFLFFBQVE7Z0JBQ3hCaUMsZUFBZUgsb0JBQW9CRDtZQUNyQztZQUVBLDJCQUEyQjtZQUMzQmxHLFFBQVEzQixVQUFVLENBQUM7WUFDbkIyQixRQUFRM0IsVUFBVSxDQUFDLENBQUMsUUFBUSxFQUFFbUIsTUFBTXdELFNBQVMsQ0FBQyxDQUFDO1lBRS9DLE9BQU87UUFDVCxPQUFPO1lBQ0xsRSxRQUFRTyxLQUFLLENBQUMsdURBQXVERyxNQUFNVSxFQUFFO1lBQzdFLE9BQU87UUFDVDtJQUNGLEVBQUUsT0FBT2IsT0FBTztRQUNkUCxRQUFRTyxLQUFLLENBQUMsOENBQThDQTtRQUM1RCxPQUFPO0lBQ1Q7QUFDRjtBQUVBLDJDQUEyQztBQUMzQyxTQUFTOEcsb0JBQW9CekYsS0FBVTtJQUNyQyxJQUFJLENBQUNBLFNBQVMsT0FBT0EsVUFBVSxVQUFVLE9BQU87SUFFaEQsSUFBSWlFLFFBQVE7SUFDWjRCLE9BQU9DLE1BQU0sQ0FBQzlGLE9BQU9sQyxPQUFPLENBQUMsQ0FBQ2lJO1FBQzVCLElBQUlBLGNBQWMsT0FBT0EsZUFBZSxVQUFVO1lBQ2hERixPQUFPQyxNQUFNLENBQUNDLFlBQVlqSSxPQUFPLENBQUMsQ0FBQ2tJO2dCQUNqQyxJQUFJLE9BQU9BLFFBQVEsVUFBVTtvQkFDM0IvQixTQUFTK0I7Z0JBQ1g7WUFDRjtRQUNGO0lBQ0Y7SUFFQSxPQUFPL0I7QUFDVDtBQUVBLGtDQUFrQztBQUNsQyxJQUFJLEtBQWtCLEVBQWEsRUFHbEM7QUFFNEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vYnNpZGlhbi13ZWFyLy4vc3JjL2xpYi9vcHRpbWl6ZWREYXRhYmFzZS50cz83ZmMwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIE9wdGltaXplZCBkYXRhYmFzZSBzZXJ2aWNlIHdpdGggYWdncmVzc2l2ZSBjYWNoaW5nIGFuZCBjb25uZWN0aW9uIG9wdGltaXphdGlvblxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xyXG5pbXBvcnQgeyBQcm9kdWN0LCBPcmRlciB9IGZyb20gJ0AvdHlwZXMnO1xyXG5cclxuLy8gU3VwYWJhc2UgY29uZmlndXJhdGlvblxyXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcclxuY29uc3Qgc3VwYWJhc2VLZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWTtcclxuXHJcbi8vIE9ubHkgdGhyb3cgZXJyb3IgZHVyaW5nIHNlcnZlci1zaWRlIHJlbmRlcmluZywgbm90IGR1cmluZyBidWlsZCBvciBjbGllbnQtc2lkZVxyXG5pZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZUtleSkge1xyXG4gIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzJyk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDcmVhdGUgb3B0aW1pemVkIFN1cGFiYXNlIGNsaWVudCB3aXRoIGJldHRlciBjb25uZWN0aW9uIHNldHRpbmdzXHJcbmNvbnN0IHN1cGFiYXNlID0gc3VwYWJhc2VVcmwgJiYgc3VwYWJhc2VLZXkgPyBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlS2V5LCB7XHJcbiAgZGI6IHtcclxuICAgIHNjaGVtYTogJ3B1YmxpYycsXHJcbiAgfSxcclxuICBhdXRoOiB7XHJcbiAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2UsIC8vIERvbid0IHBlcnNpc3QgYXV0aCBzZXNzaW9ucyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXHJcbiAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSwgLy8gRGlzYWJsZSBhdXRvIHJlZnJlc2ggZm9yIGJldHRlciBwZXJmb3JtYW5jZVxyXG4gIH0sXHJcbiAgZ2xvYmFsOiB7XHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICdDYWNoZS1Db250cm9sJzogJ21heC1hZ2U9NjAnLCAvLyBBZGQgY2FjaGUgaGVhZGVyc1xyXG4gICAgfSxcclxuICB9LFxyXG59KSA6IG51bGw7XHJcblxyXG4vLyBBZ2dyZXNzaXZlIGNhY2hpbmcgc3lzdGVtXHJcbmNsYXNzIERhdGFiYXNlQ2FjaGUge1xyXG4gIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgeyBkYXRhOiBhbnk7IHRpbWVzdGFtcDogbnVtYmVyOyB0dGw6IG51bWJlciB9PigpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgREVGQVVMVF9UVEwgPSA2MDAwMDsgLy8gMSBtaW51dGUgZGVmYXVsdFxyXG4gIHByaXZhdGUgcmVhZG9ubHkgTE9OR19UVEwgPSAzMDAwMDA7IC8vIDUgbWludXRlcyBmb3Igc3RhdGljIGRhdGFcclxuXHJcbiAgc2V0KGtleTogc3RyaW5nLCBkYXRhOiBhbnksIHR0bDogbnVtYmVyID0gdGhpcy5ERUZBVUxUX1RUTCkge1xyXG4gICAgdGhpcy5jYWNoZS5zZXQoa2V5LCB7XHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcclxuICAgICAgdHRsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldChrZXk6IHN0cmluZyk6IGFueSB8IG51bGwge1xyXG4gICAgY29uc3QgaXRlbSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XHJcbiAgICBpZiAoIWl0ZW0pIHJldHVybiBudWxsO1xyXG5cclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBpZiAobm93IC0gaXRlbS50aW1lc3RhbXAgPiBpdGVtLnR0bCkge1xyXG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaXRlbS5kYXRhO1xyXG4gIH1cclxuXHJcbiAgaW52YWxpZGF0ZShwYXR0ZXJuPzogc3RyaW5nKSB7XHJcbiAgICBpZiAocGF0dGVybikge1xyXG4gICAgICBjb25zdCBrZXlzVG9EZWxldGU6IHN0cmluZ1tdID0gW107XHJcbiAgICAgIHRoaXMuY2FjaGUuZm9yRWFjaCgoXywga2V5KSA9PiB7XHJcbiAgICAgICAgaWYgKGtleS5pbmNsdWRlcyhwYXR0ZXJuKSkge1xyXG4gICAgICAgICAga2V5c1RvRGVsZXRlLnB1c2goa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBrZXlzVG9EZWxldGUuZm9yRWFjaChrZXkgPT4gdGhpcy5jYWNoZS5kZWxldGUoa2V5KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNhY2hlLmNsZWFyKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQcmVsb2FkIGNyaXRpY2FsIGRhdGFcclxuICBhc3luYyBwcmVsb2FkQ3JpdGljYWxEYXRhKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coJ1ByZWxvYWRpbmcgY3JpdGljYWwgZGF0YS4uLicpO1xyXG4gICAgICBcclxuICAgICAgLy8gUHJlbG9hZCBwcm9kdWN0c1xyXG4gICAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IHRoaXMuZ2V0UHJvZHVjdHMoKTtcclxuICAgICAgdGhpcy5zZXQoJ3Byb2R1Y3RzJywgcHJvZHVjdHMsIHRoaXMuTE9OR19UVEwpO1xyXG4gICAgICBcclxuICAgICAgLy8gUHJlbG9hZCBtYWludGVuYW5jZSBzdGF0dXNcclxuICAgICAgY29uc3QgbWFpbnRlbmFuY2UgPSBhd2FpdCB0aGlzLmdldE1haW50ZW5hbmNlU3RhdHVzKCk7XHJcbiAgICAgIHRoaXMuc2V0KCdtYWludGVuYW5jZScsIG1haW50ZW5hbmNlLCB0aGlzLkRFRkFVTFRfVFRMKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKCdDcml0aWNhbCBkYXRhIHByZWxvYWRlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByZWxvYWRpbmcgZGF0YTonLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdldFByb2R1Y3RzKCk6IFByb21pc2U8UHJvZHVjdFtdPiB7XHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvZHVjdHMnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gKGRhdGEgfHwgW10pLm1hcChjb252ZXJ0RGJQcm9kdWN0VG9Qcm9kdWN0KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2V0TWFpbnRlbmFuY2VTdGF0dXMoKSB7XHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgcmV0dXJuIHsgaXNfbWFpbnRlbmFuY2U6IGZhbHNlLCBkcm9wX2RhdGU6IG51bGwgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ21haW50ZW5hbmNlX3N0YXR1cycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgZGJDYWNoZSA9IG5ldyBEYXRhYmFzZUNhY2hlKCk7XHJcblxyXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBkYXRhYmFzZSBwcm9kdWN0IHRvIFByb2R1Y3QgaW50ZXJmYWNlXHJcbmZ1bmN0aW9uIGNvbnZlcnREYlByb2R1Y3RUb1Byb2R1Y3QoZGJQcm9kdWN0OiBhbnkpOiBQcm9kdWN0IHtcclxuICByZXR1cm4ge1xyXG4gICAgaWQ6IGRiUHJvZHVjdC5pZCxcclxuICAgIG5hbWU6IGRiUHJvZHVjdC5uYW1lLFxyXG4gICAgZGVzY3JpcHRpb246IGRiUHJvZHVjdC5kZXNjcmlwdGlvbixcclxuICAgIHByaWNlOiBkYlByb2R1Y3QucHJpY2UsXHJcbiAgICBvcmlnaW5hbFByaWNlOiBkYlByb2R1Y3Qub3JpZ2luYWxfcHJpY2UsXHJcbiAgICBpbWFnZTogZGJQcm9kdWN0LmltYWdlLFxyXG4gICAgaW1hZ2VzOiBkYlByb2R1Y3QuaW1hZ2VzIHx8IFtdLFxyXG4gICAgc3RvY2s6IGRiUHJvZHVjdC5zdG9jayB8fCB7fSxcclxuICAgIGNhdGVnb3J5OiBkYlByb2R1Y3QuY2F0ZWdvcnksXHJcbiAgICBzaXplczogZGJQcm9kdWN0LnNpemVzIHx8IFtdLFxyXG4gICAgY29sb3JzOiBkYlByb2R1Y3QuY29sb3JzIHx8IFtdLFxyXG4gICAgaW5TdG9jazogZGJQcm9kdWN0LmluX3N0b2NrLFxyXG4gICAgc3RhdHVzOiBkYlByb2R1Y3Quc3RhdHVzIHx8ICdhdmFpbGFibGUnLFxyXG4gICAgcmF0aW5nOiBkYlByb2R1Y3QucmF0aW5nIHx8IDAsXHJcbiAgICByZXZpZXdzOiBkYlByb2R1Y3QucmV2aWV3cyB8fCAwLFxyXG4gICAgc2t1OiBkYlByb2R1Y3Quc2t1LFxyXG4gICAgd2VpZ2h0OiBkYlByb2R1Y3Qud2VpZ2h0LFxyXG4gICAgZGltZW5zaW9uczogZGJQcm9kdWN0LmRpbWVuc2lvbnMsXHJcbiAgICB0YWdzOiBkYlByb2R1Y3QudGFncyB8fCBbXSxcclxuICAgIGZlYXR1cmVkOiBkYlByb2R1Y3QuZmVhdHVyZWQgfHwgZmFsc2UsXHJcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKGRiUHJvZHVjdC5jcmVhdGVkX2F0KSxcclxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoZGJQcm9kdWN0LnVwZGF0ZWRfYXQpXHJcbiAgfTtcclxufVxyXG5cclxuLy8gT3B0aW1pemVkIFByb2R1Y3RzIG9wZXJhdGlvbnNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCk6IFByb21pc2U8UHJvZHVjdFtdPiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghc3VwYWJhc2UpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgY2xpZW50IG5vdCBpbml0aWFsaXplZCcpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0XHJcbiAgICBjb25zdCBjYWNoZWQgPSBkYkNhY2hlLmdldCgncHJvZHVjdHMnKTtcclxuICAgIGlmIChjYWNoZWQpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0RhdGFiYXNlOiBSZXR1cm5pbmcgY2FjaGVkIHByb2R1Y3RzJyk7XHJcbiAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0RhdGFiYXNlOiBGZXRjaGluZyBwcm9kdWN0cyBmcm9tIFN1cGFiYXNlJyk7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvZHVjdHMnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xyXG4gICAgXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgZ2V0UHJvZHVjdHMgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gKGRhdGEgfHwgW10pLm1hcChjb252ZXJ0RGJQcm9kdWN0VG9Qcm9kdWN0KTtcclxuICAgIFxyXG4gICAgLy8gQ2FjaGUgZm9yIDUgbWludXRlcyAocHJvZHVjdHMgZG9uJ3QgY2hhbmdlIG9mdGVuKVxyXG4gICAgZGJDYWNoZS5zZXQoJ3Byb2R1Y3RzJywgcHJvZHVjdHMsIDMwMDAwMCk7XHJcbiAgICBcclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgZ2V0UHJvZHVjdHMgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3QoaWQ6IHN0cmluZyk6IFByb21pc2U8UHJvZHVjdCB8IG51bGw+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBjbGllbnQgbm90IGluaXRpYWxpemVkJyk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBjYWNoZSBmaXJzdFxyXG4gICAgY29uc3QgY2FjaGVkID0gZGJDYWNoZS5nZXQoYHByb2R1Y3RfJHtpZH1gKTtcclxuICAgIGlmIChjYWNoZWQpIHtcclxuICAgICAgcmV0dXJuIGNhY2hlZDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvZHVjdHMnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBnZXRQcm9kdWN0IGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHByb2R1Y3QgPSBjb252ZXJ0RGJQcm9kdWN0VG9Qcm9kdWN0KGRhdGEpO1xyXG4gICAgXHJcbiAgICAvLyBDYWNoZSBmb3IgNSBtaW51dGVzXHJcbiAgICBkYkNhY2hlLnNldChgcHJvZHVjdF8ke2lkfWAsIHByb2R1Y3QsIDMwMDAwMCk7XHJcbiAgICBcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBnZXRQcm9kdWN0IGVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZFByb2R1Y3QocHJvZHVjdDogUHJvZHVjdCk6IFByb21pc2U8UHJvZHVjdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBub3QgYXZhaWxhYmxlJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IGRiUHJvZHVjdCA9IHtcclxuICAgICAgaWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgZGVzY3JpcHRpb246IHByb2R1Y3QuZGVzY3JpcHRpb24sXHJcbiAgICAgIHByaWNlOiBwcm9kdWN0LnByaWNlLFxyXG4gICAgICBvcmlnaW5hbF9wcmljZTogcHJvZHVjdC5vcmlnaW5hbFByaWNlLFxyXG4gICAgICBpbWFnZTogcHJvZHVjdC5pbWFnZSxcclxuICAgICAgaW1hZ2VzOiBwcm9kdWN0LmltYWdlcyB8fCBbXSxcclxuICAgICAgc3RvY2s6IHByb2R1Y3Quc3RvY2ssXHJcbiAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5LFxyXG4gICAgICBzaXplczogcHJvZHVjdC5zaXplcyB8fCBbXSxcclxuICAgICAgY29sb3JzOiBwcm9kdWN0LmNvbG9ycyB8fCBbXSxcclxuICAgICAgaW5fc3RvY2s6IHByb2R1Y3QuaW5TdG9jayxcclxuICAgICAgcmF0aW5nOiBwcm9kdWN0LnJhdGluZyxcclxuICAgICAgcmV2aWV3czogcHJvZHVjdC5yZXZpZXdzLFxyXG4gICAgICBza3U6IHByb2R1Y3Quc2t1LFxyXG4gICAgICB3ZWlnaHQ6IHByb2R1Y3Qud2VpZ2h0LFxyXG4gICAgICBkaW1lbnNpb25zOiBwcm9kdWN0LmRpbWVuc2lvbnMsXHJcbiAgICAgIHRhZ3M6IHByb2R1Y3QudGFncyB8fCBbXSxcclxuICAgICAgZmVhdHVyZWQ6IHByb2R1Y3QuZmVhdHVyZWQgfHwgZmFsc2VcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Byb2R1Y3RzJylcclxuICAgICAgLmluc2VydChbZGJQcm9kdWN0XSlcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGFkZFByb2R1Y3QgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgbmV3UHJvZHVjdCA9IGNvbnZlcnREYlByb2R1Y3RUb1Byb2R1Y3QoZGF0YSk7XHJcbiAgICBcclxuICAgIC8vIEludmFsaWRhdGUgcHJvZHVjdHMgY2FjaGVcclxuICAgIGRiQ2FjaGUuaW52YWxpZGF0ZSgncHJvZHVjdHMnKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIG5ld1Byb2R1Y3Q7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGFkZFByb2R1Y3QgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHJvZHVjdChpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPFByb2R1Y3Q+KTogUHJvbWlzZTxQcm9kdWN0PiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghc3VwYWJhc2UpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgY2xpZW50IG5vdCBpbml0aWFsaXplZCcpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIG5vdCBhdmFpbGFibGUnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgZGJVcGRhdGVzOiBhbnkgPSB7fTtcclxuICAgIFxyXG4gICAgaWYgKHVwZGF0ZXMubmFtZSAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMubmFtZSA9IHVwZGF0ZXMubmFtZTtcclxuICAgIGlmICh1cGRhdGVzLmRlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5kZXNjcmlwdGlvbiA9IHVwZGF0ZXMuZGVzY3JpcHRpb247XHJcbiAgICBpZiAodXBkYXRlcy5wcmljZSAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMucHJpY2UgPSB1cGRhdGVzLnByaWNlO1xyXG4gICAgaWYgKHVwZGF0ZXMub3JpZ2luYWxQcmljZSAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMub3JpZ2luYWxfcHJpY2UgPSB1cGRhdGVzLm9yaWdpbmFsUHJpY2U7XHJcbiAgICBpZiAodXBkYXRlcy5pbWFnZSAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMuaW1hZ2UgPSB1cGRhdGVzLmltYWdlO1xyXG4gICAgaWYgKHVwZGF0ZXMuaW1hZ2VzICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5pbWFnZXMgPSB1cGRhdGVzLmltYWdlcztcclxuICAgIGlmICh1cGRhdGVzLnN0b2NrICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5zdG9jayA9IHVwZGF0ZXMuc3RvY2s7XHJcbiAgICBpZiAodXBkYXRlcy5jYXRlZ29yeSAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMuY2F0ZWdvcnkgPSB1cGRhdGVzLmNhdGVnb3J5O1xyXG4gICAgaWYgKHVwZGF0ZXMuc2l6ZXMgIT09IHVuZGVmaW5lZCkgZGJVcGRhdGVzLnNpemVzID0gdXBkYXRlcy5zaXplcztcclxuICAgIGlmICh1cGRhdGVzLmNvbG9ycyAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMuY29sb3JzID0gdXBkYXRlcy5jb2xvcnM7XHJcbiAgICBpZiAodXBkYXRlcy5pblN0b2NrICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5pbl9zdG9jayA9IHVwZGF0ZXMuaW5TdG9jaztcclxuICAgIGlmICh1cGRhdGVzLnJhdGluZyAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMucmF0aW5nID0gdXBkYXRlcy5yYXRpbmc7XHJcbiAgICBpZiAodXBkYXRlcy5yZXZpZXdzICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5yZXZpZXdzID0gdXBkYXRlcy5yZXZpZXdzO1xyXG4gICAgaWYgKHVwZGF0ZXMuc2t1ICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5za3UgPSB1cGRhdGVzLnNrdTtcclxuICAgIGlmICh1cGRhdGVzLndlaWdodCAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMud2VpZ2h0ID0gdXBkYXRlcy53ZWlnaHQ7XHJcbiAgICBpZiAodXBkYXRlcy5kaW1lbnNpb25zICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5kaW1lbnNpb25zID0gdXBkYXRlcy5kaW1lbnNpb25zO1xyXG4gICAgaWYgKHVwZGF0ZXMudGFncyAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMudGFncyA9IHVwZGF0ZXMudGFncztcclxuICAgIGlmICh1cGRhdGVzLmZlYXR1cmVkICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5mZWF0dXJlZCA9IHVwZGF0ZXMuZmVhdHVyZWQ7XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Byb2R1Y3RzJylcclxuICAgICAgLnVwZGF0ZShkYlVwZGF0ZXMpXHJcbiAgICAgIC5lcSgnaWQnLCBpZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHVwZGF0ZVByb2R1Y3QgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgdXBkYXRlZFByb2R1Y3QgPSBjb252ZXJ0RGJQcm9kdWN0VG9Qcm9kdWN0KGRhdGEpO1xyXG4gICAgXHJcbiAgICAvLyBJbnZhbGlkYXRlIGNhY2hlc1xyXG4gICAgZGJDYWNoZS5pbnZhbGlkYXRlKCdwcm9kdWN0cycpO1xyXG4gICAgZGJDYWNoZS5pbnZhbGlkYXRlKGBwcm9kdWN0XyR7aWR9YCk7XHJcbiAgICBcclxuICAgIHJldHVybiB1cGRhdGVkUHJvZHVjdDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgdXBkYXRlUHJvZHVjdCBlcnJvcjonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVQcm9kdWN0KGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBjbGllbnQgbm90IGluaXRpYWxpemVkJyk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2Ugbm90IGF2YWlsYWJsZScpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvZHVjdHMnKVxyXG4gICAgICAuZGVsZXRlKClcclxuICAgICAgLmVxKCdpZCcsIGlkKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGRlbGV0ZVByb2R1Y3QgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSW52YWxpZGF0ZSBjYWNoZXNcclxuICAgIGRiQ2FjaGUuaW52YWxpZGF0ZSgncHJvZHVjdHMnKTtcclxuICAgIGRiQ2FjaGUuaW52YWxpZGF0ZShgcHJvZHVjdF8ke2lkfWApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBkZWxldGVQcm9kdWN0IGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLy8gT3B0aW1pemVkIE9yZGVycyBvcGVyYXRpb25zXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcmRlcnMoKTogUHJvbWlzZTxPcmRlcltdPiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghc3VwYWJhc2UpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgY2xpZW50IG5vdCBpbml0aWFsaXplZCcpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0XHJcbiAgICBjb25zdCBjYWNoZWQgPSBkYkNhY2hlLmdldCgnb3JkZXJzJyk7XHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZTogUmV0dXJuaW5nIGNhY2hlZCBvcmRlcnMnKTtcclxuICAgICAgcmV0dXJuIGNhY2hlZDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZygnRGF0YWJhc2U6IEZldGNoaW5nIG9yZGVycyBmcm9tIFN1cGFiYXNlJyk7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnb3JkZXJzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGdldE9yZGVycyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3Qgb3JkZXJzID0gKGRhdGEgfHwgW10pLm1hcCgob3JkZXI6IGFueSkgPT4gKHtcclxuICAgICAgLi4ub3JkZXIsXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUob3JkZXIuY3JlYXRlZF9hdCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUob3JkZXIudXBkYXRlZF9hdClcclxuICAgIH0pKTtcclxuICAgIFxyXG4gICAgLy8gQ2FjaGUgZm9yIDEgbWludXRlIChvcmRlcnMgY2hhbmdlIG1vcmUgZnJlcXVlbnRseSlcclxuICAgIGRiQ2FjaGUuc2V0KCdvcmRlcnMnLCBvcmRlcnMsIDYwMDAwKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIG9yZGVycztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgZ2V0T3JkZXJzIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcmRlcihpZDogc3RyaW5nKTogUHJvbWlzZTxPcmRlciB8IG51bGw+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBjbGllbnQgbm90IGluaXRpYWxpemVkJyk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBjYWNoZSBmaXJzdFxyXG4gICAgY29uc3QgY2FjaGVkID0gZGJDYWNoZS5nZXQoYG9yZGVyXyR7aWR9YCk7XHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ29yZGVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgaWQpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGdldE9yZGVyIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IG9yZGVyID0ge1xyXG4gICAgICAuLi5kYXRhLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKGRhdGEuY3JlYXRlZF9hdCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoZGF0YS51cGRhdGVkX2F0KVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQ2FjaGUgZm9yIDEgbWludXRlXHJcbiAgICBkYkNhY2hlLnNldChgb3JkZXJfJHtpZH1gLCBvcmRlciwgNjAwMDApO1xyXG4gICAgXHJcbiAgICByZXR1cm4gb3JkZXI7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGdldE9yZGVyIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZE9yZGVyKG9yZGVyOiBPcmRlcik6IFByb21pc2U8T3JkZXI+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBjbGllbnQgbm90IGluaXRpYWxpemVkJyk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2Ugbm90IGF2YWlsYWJsZScpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBkYk9yZGVyID0ge1xyXG4gICAgICBpZDogb3JkZXIuaWQsXHJcbiAgICAgIHByb2R1Y3RfaWQ6IG9yZGVyLnByb2R1Y3RJZCxcclxuICAgICAgcHJvZHVjdF9uYW1lOiBvcmRlci5wcm9kdWN0TmFtZSxcclxuICAgICAgcHJvZHVjdF9pbWFnZTogb3JkZXIucHJvZHVjdEltYWdlLFxyXG4gICAgICBjdXN0b21lcl9uYW1lOiBvcmRlci5jdXN0b21lck5hbWUsXHJcbiAgICAgIGN1c3RvbWVyX2VtYWlsOiBvcmRlci5jdXN0b21lckVtYWlsLFxyXG4gICAgICBjdXN0b21lcl9waG9uZTogb3JkZXIuY3VzdG9tZXJQaG9uZSxcclxuICAgICAgY3VzdG9tZXJfYWRkcmVzczogb3JkZXIuY3VzdG9tZXJBZGRyZXNzLFxyXG4gICAgICB3aWxheWFfaWQ6IG9yZGVyLndpbGF5YUlkLFxyXG4gICAgICB3aWxheWFfbmFtZTogb3JkZXIud2lsYXlhTmFtZSxcclxuICAgICAgc2hpcHBpbmdfdHlwZTogb3JkZXIuc2hpcHBpbmdUeXBlLFxyXG4gICAgICBzaGlwcGluZ19jb3N0OiBvcmRlci5zaGlwcGluZ0Nvc3QsXHJcbiAgICAgIHF1YW50aXR5OiBvcmRlci5xdWFudGl0eSxcclxuICAgICAgc2VsZWN0ZWRfc2l6ZTogb3JkZXIuc2VsZWN0ZWRTaXplLFxyXG4gICAgICBzZWxlY3RlZF9jb2xvcjogb3JkZXIuc2VsZWN0ZWRDb2xvcixcclxuICAgICAgc3VidG90YWw6IG9yZGVyLnN1YnRvdGFsLFxyXG4gICAgICB0b3RhbDogb3JkZXIudG90YWwsXHJcbiAgICAgIHN0YXR1czogb3JkZXIuc3RhdHVzLFxyXG4gICAgICB0cmFja2luZ19udW1iZXI6IG9yZGVyLnRyYWNraW5nTnVtYmVyLFxyXG4gICAgICBub3Rlczogb3JkZXIubm90ZXMsXHJcbiAgICAgIHBheW1lbnRfbWV0aG9kOiBvcmRlci5wYXltZW50TWV0aG9kLFxyXG4gICAgICBwYXltZW50X3N0YXR1czogb3JkZXIucGF5bWVudFN0YXR1cyxcclxuICAgICAgZXN0aW1hdGVkX2RlbGl2ZXJ5OiBvcmRlci5lc3RpbWF0ZWREZWxpdmVyeSxcclxuICAgICAgb3JkZXJfZGF0ZTogb3JkZXIub3JkZXJEYXRlLFxyXG4gICAgICBjcmVhdGVkX2F0OiBvcmRlci5jcmVhdGVkQXQsXHJcbiAgICAgIHVwZGF0ZWRfYXQ6IG9yZGVyLnVwZGF0ZWRBdFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnb3JkZXJzJylcclxuICAgICAgLmluc2VydChbZGJPcmRlcl0pXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBhZGRPcmRlciBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBuZXdPcmRlciA9IHtcclxuICAgICAgLi4uZGF0YSxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRfYXQpLFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKGRhdGEudXBkYXRlZF9hdClcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIEludmFsaWRhdGUgb3JkZXJzIGNhY2hlXHJcbiAgICBkYkNhY2hlLmludmFsaWRhdGUoJ29yZGVycycpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gbmV3T3JkZXI7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGFkZE9yZGVyIGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU9yZGVyKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8T3JkZXI+KTogUHJvbWlzZTxPcmRlcj4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBub3QgYXZhaWxhYmxlJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IGRiVXBkYXRlczogYW55ID0ge307XHJcbiAgICBcclxuICAgIGlmICh1cGRhdGVzLnN0YXR1cyAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMuc3RhdHVzID0gdXBkYXRlcy5zdGF0dXM7XHJcbiAgICBpZiAodXBkYXRlcy5jdXN0b21lck5hbWUgIT09IHVuZGVmaW5lZCkgZGJVcGRhdGVzLmN1c3RvbWVyX25hbWUgPSB1cGRhdGVzLmN1c3RvbWVyTmFtZTtcclxuICAgIGlmICh1cGRhdGVzLmN1c3RvbWVyRW1haWwgIT09IHVuZGVmaW5lZCkgZGJVcGRhdGVzLmN1c3RvbWVyX2VtYWlsID0gdXBkYXRlcy5jdXN0b21lckVtYWlsO1xyXG4gICAgaWYgKHVwZGF0ZXMuY3VzdG9tZXJQaG9uZSAhPT0gdW5kZWZpbmVkKSBkYlVwZGF0ZXMuY3VzdG9tZXJfcGhvbmUgPSB1cGRhdGVzLmN1c3RvbWVyUGhvbmU7XHJcbiAgICBpZiAodXBkYXRlcy5jdXN0b21lckFkZHJlc3MgIT09IHVuZGVmaW5lZCkgZGJVcGRhdGVzLmN1c3RvbWVyX2FkZHJlc3MgPSB1cGRhdGVzLmN1c3RvbWVyQWRkcmVzcztcclxuICAgIGlmICh1cGRhdGVzLnRvdGFsICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy50b3RhbCA9IHVwZGF0ZXMudG90YWw7XHJcbiAgICBpZiAodXBkYXRlcy5wYXltZW50TWV0aG9kICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5wYXltZW50X21ldGhvZCA9IHVwZGF0ZXMucGF5bWVudE1ldGhvZDtcclxuICAgIGlmICh1cGRhdGVzLm5vdGVzICE9PSB1bmRlZmluZWQpIGRiVXBkYXRlcy5ub3RlcyA9IHVwZGF0ZXMubm90ZXM7XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ29yZGVycycpXHJcbiAgICAgIC51cGRhdGUoZGJVcGRhdGVzKVxyXG4gICAgICAuZXEoJ2lkJywgaWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSB1cGRhdGVPcmRlciBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB1cGRhdGVkT3JkZXIgPSB7XHJcbiAgICAgIC4uLmRhdGEsXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoZGF0YS5jcmVhdGVkX2F0KSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShkYXRhLnVwZGF0ZWRfYXQpXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBJbnZhbGlkYXRlIGNhY2hlc1xyXG4gICAgZGJDYWNoZS5pbnZhbGlkYXRlKCdvcmRlcnMnKTtcclxuICAgIGRiQ2FjaGUuaW52YWxpZGF0ZShgb3JkZXJfJHtpZH1gKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHVwZGF0ZWRPcmRlcjtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgdXBkYXRlT3JkZXIgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlT3JkZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBub3QgYXZhaWxhYmxlJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZpcnN0LCBnZXQgdGhlIG9yZGVyIHRvIHJldHVybiBzdG9ja1xyXG4gICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBnZXRPcmRlcihpZCk7XHJcbiAgICBpZiAob3JkZXIpIHtcclxuICAgICAgLy8gUmV0dXJuIHN0b2NrIGZvciB0aGUgb3JkZXJcclxuICAgICAgYXdhaXQgcmV0dXJuU3RvY2tGcm9tT3JkZXIob3JkZXIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnb3JkZXJzJylcclxuICAgICAgLmRlbGV0ZSgpXHJcbiAgICAgIC5lcSgnaWQnLCBpZCk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBkZWxldGVPcmRlciBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJbnZhbGlkYXRlIGNhY2hlc1xyXG4gICAgZGJDYWNoZS5pbnZhbGlkYXRlKCdvcmRlcnMnKTtcclxuICAgIGRiQ2FjaGUuaW52YWxpZGF0ZShgb3JkZXJfJHtpZH1gKTtcclxuICAgIGRiQ2FjaGUuaW52YWxpZGF0ZSgncHJvZHVjdHMnKTsgLy8gSW52YWxpZGF0ZSBwcm9kdWN0cyBjYWNoZSBzaW5jZSBzdG9jayBjaGFuZ2VkXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGRlbGV0ZU9yZGVyIGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLy8gT3B0aW1pemVkIE1haW50ZW5hbmNlIG9wZXJhdGlvbnNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE1haW50ZW5hbmNlU3RhdHVzKCkge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgcmV0dXJuIHsgaXNfbWFpbnRlbmFuY2U6IGZhbHNlLCBkcm9wX2RhdGU6IG51bGwgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcclxuICAgIGNvbnN0IGNhY2hlZCA9IGRiQ2FjaGUuZ2V0KCdtYWludGVuYW5jZScpO1xyXG4gICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICByZXR1cm4gY2FjaGVkO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdtYWludGVuYW5jZV9zdGF0dXMnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBnZXRNYWludGVuYW5jZVN0YXR1cyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENhY2hlIGZvciAzMCBzZWNvbmRzXHJcbiAgICBkYkNhY2hlLnNldCgnbWFpbnRlbmFuY2UnLCBkYXRhLCAzMDAwMCk7XHJcbiAgICBcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBnZXRNYWludGVuYW5jZVN0YXR1cyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRNYWludGVuYW5jZVN0YXR1cyhpc01haW50ZW5hbmNlOiBib29sZWFuLCBkcm9wRGF0ZT86IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXN1cGFiYXNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnbWFpbnRlbmFuY2Vfc3RhdHVzJylcclxuICAgICAgLnVwc2VydCh7XHJcbiAgICAgICAgaWQ6ICdtYWludGVuYW5jZScsXHJcbiAgICAgICAgaXNfbWFpbnRlbmFuY2U6IGlzTWFpbnRlbmFuY2UsXHJcbiAgICAgICAgZHJvcF9kYXRlOiBkcm9wRGF0ZSB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBzZXRNYWludGVuYW5jZVN0YXR1cyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJbnZhbGlkYXRlIG1haW50ZW5hbmNlIGNhY2hlXHJcbiAgICBkYkNhY2hlLmludmFsaWRhdGUoJ21haW50ZW5hbmNlJyk7XHJcbiAgICBcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBzZXRNYWludGVuYW5jZVN0YXR1cyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBTdG9jayByZXR1cm4gZnVuY3Rpb24gZm9yIGNhbmNlbGxlZC9kZWxldGVkIG9yZGVyc1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmV0dXJuU3RvY2tGcm9tT3JkZXIob3JkZXI6IE9yZGVyKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghc3VwYWJhc2UpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgY2xpZW50IG5vdCBpbml0aWFsaXplZCcpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZTogUmV0dXJuaW5nIHN0b2NrIGZvciBvcmRlcjonLCBvcmRlci5pZCk7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgcHJvZHVjdFxyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGdldFByb2R1Y3Qob3JkZXIucHJvZHVjdElkKTtcclxuICAgIGlmICghcHJvZHVjdCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZTogUHJvZHVjdCBub3QgZm91bmQgZm9yIG9yZGVyOicsIG9yZGVyLnByb2R1Y3RJZCk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IGN1cnJlbnQgc3RvY2tcclxuICAgIGNvbnN0IGN1cnJlbnRTdG9jayA9IHByb2R1Y3Quc3RvY2s/LltvcmRlci5zZWxlY3RlZFNpemVdPy5bb3JkZXIuc2VsZWN0ZWRDb2xvcl0gfHwgMDtcclxuICAgIFxyXG4gICAgLy8gUmV0dXJuIHRoZSBzdG9ja1xyXG4gICAgY29uc3QgbmV3U3RvY2sgPSB7XHJcbiAgICAgIC4uLnByb2R1Y3Quc3RvY2ssXHJcbiAgICAgIFtvcmRlci5zZWxlY3RlZFNpemVdOiB7XHJcbiAgICAgICAgLi4ucHJvZHVjdC5zdG9jaz8uW29yZGVyLnNlbGVjdGVkU2l6ZV0sXHJcbiAgICAgICAgW29yZGVyLnNlbGVjdGVkQ29sb3JdOiBjdXJyZW50U3RvY2sgKyBvcmRlci5xdWFudGl0eVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgdGhlIHByb2R1Y3Qgc3RvY2tcclxuICAgIGNvbnN0IHVwZGF0ZWRQcm9kdWN0ID0gYXdhaXQgdXBkYXRlUHJvZHVjdChvcmRlci5wcm9kdWN0SWQsIHtcclxuICAgICAgc3RvY2s6IG5ld1N0b2NrLFxyXG4gICAgICBpblN0b2NrOiBjYWxjdWxhdGVUb3RhbFN0b2NrKG5ld1N0b2NrKSA+IDBcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAodXBkYXRlZFByb2R1Y3QpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0RhdGFiYXNlOiBTdWNjZXNzZnVsbHkgcmV0dXJuZWQgc3RvY2sgZm9yIG9yZGVyOicsIG9yZGVyLmlkLCB7XHJcbiAgICAgICAgcHJvZHVjdElkOiBvcmRlci5wcm9kdWN0SWQsXHJcbiAgICAgICAgc2l6ZTogb3JkZXIuc2VsZWN0ZWRTaXplLFxyXG4gICAgICAgIGNvbG9yOiBvcmRlci5zZWxlY3RlZENvbG9yLFxyXG4gICAgICAgIHF1YW50aXR5OiBvcmRlci5xdWFudGl0eSxcclxuICAgICAgICBuZXdUb3RhbFN0b2NrOiBjYWxjdWxhdGVUb3RhbFN0b2NrKG5ld1N0b2NrKVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIEludmFsaWRhdGUgcHJvZHVjdCBjYWNoZVxyXG4gICAgICBkYkNhY2hlLmludmFsaWRhdGUoJ3Byb2R1Y3RzJyk7XHJcbiAgICAgIGRiQ2FjaGUuaW52YWxpZGF0ZShgcHJvZHVjdF8ke29yZGVyLnByb2R1Y3RJZH1gKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2U6IEZhaWxlZCB0byByZXR1cm4gcHJvZHVjdCBzdG9jayBmb3Igb3JkZXI6Jywgb3JkZXIuaWQpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlOiBFcnJvciByZXR1cm5pbmcgc3RvY2sgZm9yIG9yZGVyOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbi8vIEhlbHBlciBmdW5jdGlvbiB0byBjYWxjdWxhdGUgdG90YWwgc3RvY2tcclxuZnVuY3Rpb24gY2FsY3VsYXRlVG90YWxTdG9jayhzdG9jazogYW55KTogbnVtYmVyIHtcclxuICBpZiAoIXN0b2NrIHx8IHR5cGVvZiBzdG9jayAhPT0gJ29iamVjdCcpIHJldHVybiAwO1xyXG4gIFxyXG4gIGxldCB0b3RhbCA9IDA7XHJcbiAgT2JqZWN0LnZhbHVlcyhzdG9jaykuZm9yRWFjaCgoY29sb3JTdG9jazogYW55KSA9PiB7XHJcbiAgICBpZiAoY29sb3JTdG9jayAmJiB0eXBlb2YgY29sb3JTdG9jayA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgT2JqZWN0LnZhbHVlcyhjb2xvclN0b2NrKS5mb3JFYWNoKChxdHk6IGFueSkgPT4ge1xyXG4gICAgICAgIGlmICh0eXBlb2YgcXR5ID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgdG90YWwgKz0gcXR5O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIHRvdGFsO1xyXG59XHJcblxyXG4vLyBJbml0aWFsaXplIGNhY2hlIG9uIG1vZHVsZSBsb2FkXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gIC8vIE9ubHkgcHJlbG9hZCBvbiBjbGllbnQgc2lkZVxyXG4gIGRiQ2FjaGUucHJlbG9hZENyaXRpY2FsRGF0YSgpO1xyXG59XHJcblxyXG5leHBvcnQgeyBzdXBhYmFzZSwgZGJDYWNoZSB9O1xyXG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VLZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIkVycm9yIiwic3VwYWJhc2UiLCJkYiIsInNjaGVtYSIsImF1dGgiLCJwZXJzaXN0U2Vzc2lvbiIsImF1dG9SZWZyZXNoVG9rZW4iLCJnbG9iYWwiLCJoZWFkZXJzIiwiRGF0YWJhc2VDYWNoZSIsInNldCIsImtleSIsImRhdGEiLCJ0dGwiLCJERUZBVUxUX1RUTCIsImNhY2hlIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsImdldCIsIml0ZW0iLCJkZWxldGUiLCJpbnZhbGlkYXRlIiwicGF0dGVybiIsImtleXNUb0RlbGV0ZSIsImZvckVhY2giLCJfIiwiaW5jbHVkZXMiLCJwdXNoIiwiY2xlYXIiLCJwcmVsb2FkQ3JpdGljYWxEYXRhIiwiY29uc29sZSIsImxvZyIsInByb2R1Y3RzIiwiZ2V0UHJvZHVjdHMiLCJMT05HX1RUTCIsIm1haW50ZW5hbmNlIiwiZ2V0TWFpbnRlbmFuY2VTdGF0dXMiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJvcmRlciIsImFzY2VuZGluZyIsIm1hcCIsImNvbnZlcnREYlByb2R1Y3RUb1Byb2R1Y3QiLCJpc19tYWludGVuYW5jZSIsImRyb3BfZGF0ZSIsInNpbmdsZSIsIk1hcCIsImRiQ2FjaGUiLCJkYlByb2R1Y3QiLCJpZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInByaWNlIiwib3JpZ2luYWxQcmljZSIsIm9yaWdpbmFsX3ByaWNlIiwiaW1hZ2UiLCJpbWFnZXMiLCJzdG9jayIsImNhdGVnb3J5Iiwic2l6ZXMiLCJjb2xvcnMiLCJpblN0b2NrIiwiaW5fc3RvY2siLCJzdGF0dXMiLCJyYXRpbmciLCJyZXZpZXdzIiwic2t1Iiwid2VpZ2h0IiwiZGltZW5zaW9ucyIsInRhZ3MiLCJmZWF0dXJlZCIsImNyZWF0ZWRBdCIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkQXQiLCJ1cGRhdGVkX2F0IiwiY2FjaGVkIiwiZ2V0UHJvZHVjdCIsImVxIiwicHJvZHVjdCIsImFkZFByb2R1Y3QiLCJpbnNlcnQiLCJuZXdQcm9kdWN0IiwidXBkYXRlUHJvZHVjdCIsInVwZGF0ZXMiLCJkYlVwZGF0ZXMiLCJ1bmRlZmluZWQiLCJ1cGRhdGUiLCJ1cGRhdGVkUHJvZHVjdCIsImRlbGV0ZVByb2R1Y3QiLCJnZXRPcmRlcnMiLCJvcmRlcnMiLCJnZXRPcmRlciIsImFkZE9yZGVyIiwiZGJPcmRlciIsInByb2R1Y3RfaWQiLCJwcm9kdWN0SWQiLCJwcm9kdWN0X25hbWUiLCJwcm9kdWN0TmFtZSIsInByb2R1Y3RfaW1hZ2UiLCJwcm9kdWN0SW1hZ2UiLCJjdXN0b21lcl9uYW1lIiwiY3VzdG9tZXJOYW1lIiwiY3VzdG9tZXJfZW1haWwiLCJjdXN0b21lckVtYWlsIiwiY3VzdG9tZXJfcGhvbmUiLCJjdXN0b21lclBob25lIiwiY3VzdG9tZXJfYWRkcmVzcyIsImN1c3RvbWVyQWRkcmVzcyIsIndpbGF5YV9pZCIsIndpbGF5YUlkIiwid2lsYXlhX25hbWUiLCJ3aWxheWFOYW1lIiwic2hpcHBpbmdfdHlwZSIsInNoaXBwaW5nVHlwZSIsInNoaXBwaW5nX2Nvc3QiLCJzaGlwcGluZ0Nvc3QiLCJxdWFudGl0eSIsInNlbGVjdGVkX3NpemUiLCJzZWxlY3RlZFNpemUiLCJzZWxlY3RlZF9jb2xvciIsInNlbGVjdGVkQ29sb3IiLCJzdWJ0b3RhbCIsInRvdGFsIiwidHJhY2tpbmdfbnVtYmVyIiwidHJhY2tpbmdOdW1iZXIiLCJub3RlcyIsInBheW1lbnRfbWV0aG9kIiwicGF5bWVudE1ldGhvZCIsInBheW1lbnRfc3RhdHVzIiwicGF5bWVudFN0YXR1cyIsImVzdGltYXRlZF9kZWxpdmVyeSIsImVzdGltYXRlZERlbGl2ZXJ5Iiwib3JkZXJfZGF0ZSIsIm9yZGVyRGF0ZSIsIm5ld09yZGVyIiwidXBkYXRlT3JkZXIiLCJ1cGRhdGVkT3JkZXIiLCJkZWxldGVPcmRlciIsInJldHVyblN0b2NrRnJvbU9yZGVyIiwic2V0TWFpbnRlbmFuY2VTdGF0dXMiLCJpc01haW50ZW5hbmNlIiwiZHJvcERhdGUiLCJ1cHNlcnQiLCJ0b0lTT1N0cmluZyIsImN1cnJlbnRTdG9jayIsIm5ld1N0b2NrIiwiY2FsY3VsYXRlVG90YWxTdG9jayIsInNpemUiLCJjb2xvciIsIm5ld1RvdGFsU3RvY2siLCJPYmplY3QiLCJ2YWx1ZXMiLCJjb2xvclN0b2NrIiwicXR5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/optimizedDatabase.ts\n");

/***/ })

};
;