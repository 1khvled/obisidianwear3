"use strict";exports.id=750,exports.ids=[750],exports.modules={4750:(e,r,t)=>{t.d(r,{$v:()=>C,AU:()=>S,Cs:()=>w,Ir:()=>g,OL:()=>v,OQ:()=>n,Sy:()=>z,Vn:()=>D,XK:()=>I,Xp:()=>d,co:()=>_,e9:()=>q,fS:()=>h,gK:()=>p,ix:()=>O,n3:()=>N,nE:()=>P,nM:()=>m,wH:()=>k,wv:()=>l});var o=t(2409);let a="https://zrmxcjklkthpyanfslsw.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpybXhjamtsa3RocHlhbmZzbHN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5MDYxMzAsImV4cCI6MjA3MjQ4MjEzMH0.2Tjh9pPzc6BUGoV3lDUBymXzE_dvAGs1O_WewTdetE0",n=a&&i?(0,o.eI)(a,i):null;function s(e){return{id:e.id,name:e.name||"",description:e.description||"",price:Number(e.price)||0,originalPrice:Number(e.original_price)||0,image:e.image||"",images:e.images||[],stock:e.stock||{},category:e.category||"",sizes:e.sizes||[],colors:e.colors||[],inStock:e.in_stock||!1,status:e.status||"available",rating:Number(e.rating)||0,reviews:Number(e.reviews)||0,sku:e.sku||"",weight:Number(e.weight)||0,dimensions:e.dimensions||null,tags:e.tags||[],featured:e.featured||!1,createdAt:e.created_at?new Date(e.created_at):new Date,updatedAt:e.updated_at?new Date(e.updated_at):new Date}}let c=null,u=0;async function d(){try{if(c&&Date.now()-u<3e4)return console.log("Supabase: Returning cached products"),c;if(!n)return console.error("Supabase client not initialized"),c||[];let{data:e,error:r}=await n.from("products").select("*").order("created_at",{ascending:!1});if(r)return console.error("Supabase getProducts error:",r),c||[];let t=(e||[]).map(s);return c=t,u=Date.now(),t}catch(e){return console.error("Supabase getProducts error:",e),c||[]}}async function l(e){try{if(!n)return console.error("Supabase client not initialized"),null;let{data:r,error:t}=await n.from("products").select("*").eq("id",e).single();if(t)return console.error("Supabase getProduct error:",t),null;return s(r)}catch(e){return console.error("Supabase getProduct error:",e),null}}async function p(e){try{if(!n)throw console.error("Supabase client not initialized"),Error("Database not available");let r={id:e.id,name:e.name,description:e.description,price:e.price,original_price:e.originalPrice,image:e.image,images:e.images||[],stock:e.stock,category:e.category,sizes:e.sizes||[],colors:e.colors||[],in_stock:e.inStock,rating:e.rating,reviews:e.reviews,sku:e.sku,weight:e.weight,dimensions:e.dimensions,tags:e.tags||[],featured:e.featured||!1},{data:t,error:o}=await n.from("products").insert([r]).select().single();if(o)throw console.error("Supabase addProduct error:",o),o;return console.log("Supabase: Added product:",e.id),c=null,s(t)}catch(e){throw console.error("Supabase addProduct error:",e),e}}async function m(e,r){try{if(!n)return console.error("Supabase client not initialized"),null;let t={};void 0!==r.name&&(t.name=r.name),void 0!==r.description&&(t.description=r.description),void 0!==r.price&&(t.price=r.price),void 0!==r.originalPrice&&(t.original_price=r.originalPrice),void 0!==r.image&&(t.image=r.image),void 0!==r.images&&(t.images=r.images),void 0!==r.stock&&(t.stock=r.stock),void 0!==r.category&&(t.category=r.category),void 0!==r.sizes&&(t.sizes=r.sizes),void 0!==r.colors&&(t.colors=r.colors),void 0!==r.inStock&&(t.in_stock=r.inStock),void 0!==r.rating&&(t.rating=r.rating),void 0!==r.reviews&&(t.reviews=r.reviews),void 0!==r.sku&&(t.sku=r.sku),void 0!==r.weight&&(t.weight=r.weight),void 0!==r.dimensions&&(t.dimensions=r.dimensions),void 0!==r.tags&&(t.tags=r.tags),void 0!==r.featured&&(t.featured=r.featured);let{data:o,error:a}=await n.from("products").update(t).eq("id",e).select().single();if(a)return console.error("Supabase updateProduct error:",a),null;return console.log("Supabase: Updated product:",e),c=null,s(o)}catch(e){return console.error("Supabase updateProduct error:",e),null}}async function g(e){try{if(!n)return console.error("Supabase client not initialized"),!1;let{error:r}=await n.from("products").delete().eq("id",e);if(r)return console.error("Supabase deleteProduct error:",r),!1;return console.log("Supabase: Deleted product:",e),c=null,!0}catch(e){return console.error("Supabase deleteProduct error:",e),!1}}function y(e){if(!(e.items&&Array.isArray(e.items)))return{id:e.id,productId:e.product_id||"",productName:e.product_name||"",productImage:e.product_image||"",customerName:e.customer_name||"",customerPhone:e.customer_phone||"",customerEmail:e.customer_email||"",customerAddress:e.customer_address||"",wilayaId:e.wilaya_id||0,wilayaName:e.wilaya_name||"",shippingType:e.shipping_type||"homeDelivery",shippingCost:Number(e.shipping_cost)||0,quantity:e.quantity||1,selectedSize:e.selected_size||"",selectedColor:e.selected_color||"",subtotal:Number(e.subtotal)||0,total:Number(e.total)||0,orderDate:new Date(e.order_date),status:e.status||"pending",trackingNumber:e.tracking_number||"",notes:e.notes||"",paymentMethod:e.payment_method||"cod",paymentStatus:e.payment_status||"pending",estimatedDelivery:e.estimated_delivery||"",createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)};{let r=e.items&&e.items.length>0?e.items[0]:{};return{id:e.id,productId:r.productId||"",productName:r.productName||"",productImage:r.productImage||"",customerName:r.customerName||"",customerPhone:r.customerPhone||"",customerEmail:r.customerEmail||"",customerAddress:r.customerAddress||"",wilayaId:r.wilayaId||0,wilayaName:r.wilayaName||"",shippingType:e.shipping_type||"homeDelivery",shippingCost:Number(e.shipping_cost)||0,quantity:r.quantity||1,selectedSize:r.selectedSize||"",selectedColor:r.selectedColor||"",subtotal:Number(e.total)-Number(e.shipping_cost)||0,total:Number(e.total)||0,orderDate:new Date(e.order_date),status:e.status||"pending",trackingNumber:e.tracking_number||"",notes:r.notes||"",paymentMethod:e.payment_method||"cod",paymentStatus:e.payment_status||"pending",estimatedDelivery:r.estimatedDelivery||"",createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)}}}let f=null,b=0;async function S(){try{if(!n)return console.error("Supabase client not initialized"),f||[];if(f&&Date.now()-b<3e4)return console.log("Supabase: Returning cached orders"),f;let{data:e,error:r}=await n.from("orders").select("*").order("order_date",{ascending:!1});if(r)return console.error("Supabase getOrders error:",r),f||[];let t=(e||[]).map(y);return f=t,b=Date.now(),t}catch(e){return console.error("Supabase getOrders error:",e),f||[]}}async function _(e){try{if(!n)return console.error("Supabase client not initialized"),null;let{data:r,error:t}=await n.from("orders").select("*").eq("id",e).single();if(t)return console.error("Supabase getOrder error:",t),null;return y(r)}catch(e){return console.error("Supabase getOrder error:",e),null}}async function h(e){try{if(!n)throw console.error("Supabase client not initialized"),Error("Database not available");let r={id:e.id,customer_name:e.customerName,customer_email:e.customerEmail,customer_phone:e.customerPhone,customer_address:e.customerAddress,wilaya_id:e.wilayaId,wilaya_name:e.wilayaName,product_id:e.productId,product_name:e.productName,product_image:e.productImage,selected_size:e.selectedSize,selected_color:e.selectedColor,quantity:e.quantity,subtotal:e.subtotal,shipping_cost:e.shippingCost,total:e.total,shipping_type:e.shippingType,payment_method:e.paymentMethod,payment_status:e.paymentStatus,status:e.status,order_date:e.orderDate.toISOString(),notes:e.notes,tracking_number:e.trackingNumber,estimated_delivery:e.estimatedDelivery,created_at:e.createdAt.toISOString(),updated_at:e.updatedAt.toISOString()},{data:t,error:o}=await n.from("orders").insert([r]).select().single();if(o)throw console.error("Supabase addOrder error:",o),o;return console.log("Supabase: Added order:",e.id),y(t)}catch(e){throw console.error("Supabase addOrder error:",e),e}}async function w(e,r){try{if(!n)return console.error("Supabase client not initialized"),null;let t={updated_at:new Date().toISOString()};void 0!==r.status&&(t.status=r.status),void 0!==r.paymentStatus&&(t.payment_status=r.paymentStatus),void 0!==r.trackingNumber&&(t.tracking_number=r.trackingNumber),void 0!==r.shippingType&&(t.shipping_type=r.shippingType),void 0!==r.shippingCost&&(t.shipping_cost=r.shippingCost),void 0!==r.total&&(t.total=r.total),void 0!==r.paymentMethod&&(t.payment_method=r.paymentMethod);let{data:o,error:a}=await n.from("orders").update(t).eq("id",e).select().single();if(a)return console.error("Supabase updateOrder error:",a),null;return console.log("Supabase: Updated order:",e),y(o)}catch(e){return console.error("Supabase updateOrder error:",e),null}}async function k(e){try{if(!n)return console.error("Supabase client not initialized"),!1;let{error:r}=await n.from("orders").delete().eq("id",e);if(r)return console.error("Supabase deleteOrder error:",r),!1;return console.log("Supabase: Deleted order:",e),!0}catch(e){return console.error("Supabase deleteOrder error:",e),!1}}async function v(){try{if(!n)return console.error("Supabase client not initialized"),[];let{data:e,error:r}=await n.from("customers").select("*").order("created_at",{ascending:!1});if(r)return console.error("Supabase getCustomers error:",r),[];return e||[]}catch(e){return console.error("Supabase getCustomers error:",e),[]}}async function z(e){try{if(!n)throw console.error("Supabase client not initialized"),Error("Database not available");let{data:r,error:t}=await n.from("customers").insert([e]).select().single();if(t)throw console.error("Supabase addCustomer error:",t),t;return r}catch(e){throw console.error("Supabase addCustomer error:",e),e}}async function I(){try{if(!n)return console.error("Supabase client not initialized"),{is_maintenance:!1,drop_date:null};let{data:e,error:r}=await n.from("maintenance_status").select("*").eq("id","maintenance").single();if(r)return console.error("Supabase getMaintenanceStatus error:",r),{is_maintenance:!1,drop_date:null};return e||{is_maintenance:!1,drop_date:null}}catch(e){return console.error("Supabase getMaintenanceStatus error:",e),{is_maintenance:!1,drop_date:null}}}async function D(e,r){try{if(!n)return console.error("Supabase client not initialized"),!1;let t={is_maintenance:e,updated_at:new Date().toISOString()};r&&(t.drop_date=r);let{error:o}=await n.from("maintenance_status").update(t).eq("id","maintenance");if(o)return console.error("Supabase updateMaintenanceStatus error:",o),!1;return console.log("Supabase: Updated maintenance status"),!0}catch(e){return console.error("Supabase updateMaintenanceStatus error:",e),!1}}async function N(){try{if(!n)return console.error("Supabase client not initialized"),[];let{data:e,error:r}=await n.from("wilaya_tariffs").select("*").order("wilaya_code",{ascending:!0});if(r)return console.error("Supabase getWilayaTariffs error:",r),[];return e||[]}catch(e){return console.error("Supabase getWilayaTariffs error:",e),[]}}async function O(e){try{if(!n)throw console.error("Supabase client not initialized"),Error("Database not available");if(await n.from("wilaya_tariffs").delete().neq("id",0),e.length>0){let{error:r}=await n.from("wilaya_tariffs").insert(e);if(r)throw console.error("Supabase updateWilayaTariffs error:",r),r}console.log("Supabase: Updated wilaya tariffs")}catch(e){throw console.error("Supabase updateWilayaTariffs error:",e),e}}async function C(){try{if(!n)return console.error("Supabase client not initialized"),[];let{data:e,error:r}=await n.from("products").select("id, name, sku, stock, sizes, colors, in_stock, category").order("name");if(r)return console.error("Supabase getInventory error:",r),[];return(e||[]).map(e=>({id:e.id,name:e.name,sku:e.sku,category:e.category,inStock:e.in_stock,stock:e.stock||{},sizes:e.sizes||[],colors:e.colors||[],totalStock:A(e.stock||{}),stockBySize:function(e,r,t){let o={};return r.forEach(r=>{o[r]={},t.forEach(t=>{o[r][t]=Number(e[r]?.[t])||0})}),o}(e.stock||{},e.sizes||[],e.colors||[])}))}catch(e){return console.error("Supabase getInventory error:",e),[]}}async function q(e,r){try{if(!n)throw console.error("Supabase client not initialized"),Error("Database not available");let t={updated_at:new Date().toISOString()};r.stock&&(t.stock=r.stock),void 0!==r.inStock&&(t.in_stock=r.inStock);let{data:o,error:a}=await n.from("products").update(t).eq("id",e).select().single();if(a)throw console.error("Supabase updateInventory error:",a),a;return console.log("Supabase: Updated inventory for product:",e),{id:o.id,name:o.name,stock:o.stock,inStock:o.in_stock,totalStock:A(o.stock)}}catch(e){throw console.error("Supabase updateInventory error:",e),e}}function A(e){if(!e||"object"!=typeof e)return 0;let r=0;for(let t in e)if("object"==typeof e[t])for(let o in e[t])r+=Number(e[t][o])||0;return r}async function P(e){try{console.log("Supabase: Deducting stock for order:",e.id);let r=await l(e.productId);if(!r)return console.error("Supabase: Product not found for order:",e.productId),!1;let t=r.stock?.[e.selectedSize]?.[e.selectedColor]||0;if(t<e.quantity)return console.error("Supabase: Insufficient stock for order:",{productId:e.productId,size:e.selectedSize,color:e.selectedColor,requested:e.quantity,available:t}),!1;let o={...r.stock,[e.selectedSize]:{...r.stock?.[e.selectedSize],[e.selectedColor]:t-e.quantity}};if(await m(e.productId,{stock:o,inStock:A(o)>0}))return console.log("Supabase: Successfully deducted stock for order:",e.id),!0;return console.error("Supabase: Failed to update product stock for order:",e.id),!1}catch(e){return console.error("Supabase: Error deducting stock for order:",e),!1}}}};