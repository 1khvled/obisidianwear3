"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{3098:function(e,r,t){t.d(r,{addInventory:function(){return a},initializeProductInventory:function(){return s}});var n=t(7440);let o="https://twlegtqcyydgjkycxngw.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3bGVndHFjeXlkZ2preWN4bmd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzQ2MDAsImV4cCI6MjA3Mjc1MDYwMH0.uD9GD_ksHCDgmmPAgR7fcLUAJHRJtTkT-J-SVjU-WR0";if(!o||!i)throw Error("Missing Supabase environment variables");let c=(0,n.eI)(o,i);async function a(e,r,t,n,o,i){try{let a="INV-".concat(e,"-").concat(r,"-").concat(t),{data:s,error:l}=await c.from("inventory").select("*").eq("id",a).single(),u=(null==s?void 0:s.quantity)||0,d=u+n,{error:v}=await c.from("inventory").upsert([{id:a,product_id:e,size:r,color:t,quantity:d,reserved_quantity:(null==s?void 0:s.reserved_quantity)||0,min_stock_level:(null==s?void 0:s.min_stock_level)||5,max_stock_level:(null==s?void 0:s.max_stock_level)||100}]);if(v)return console.error("Inventory service: addInventory error:",v),!1;return await c.from("inventory_transactions").insert([{id:"TXN-".concat(Date.now(),"-").concat(a),product_id:e,size:r,color:t,transaction_type:"in",quantity_change:n,previous_quantity:u,new_quantity:d,reason:o||"Stock added",created_by:i||"admin"}]),!0}catch(e){return console.error("Inventory service: addInventory error:",e),!1}}async function s(e){try{let{data:t,error:n}=await c.from("products").select("sizes, colors, stock").eq("id",e).single();if(n||!t)return console.error("Inventory service: Product not found:",e),!1;let o=t.sizes||[],i=t.colors||[],a=t.stock||{},s=[];for(let t of o)for(let n of i){var r;let o=(null===(r=a[t])||void 0===r?void 0:r[n])||0;s.push({id:"INV-".concat(e,"-").concat(t,"-").concat(n),product_id:e,size:t,color:n,quantity:o,reserved_quantity:0,min_stock_level:5,max_stock_level:100})}if(s.length>0){let{error:e}=await c.from("inventory").upsert(s);if(e)return console.error("Inventory service: initializeProductInventory error:",e),!1}return!0}catch(e){return console.error("Inventory service: initializeProductInventory error:",e),!1}}}}]);