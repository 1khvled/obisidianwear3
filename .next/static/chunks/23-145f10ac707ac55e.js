"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23],{7023:function(e,t,o){o.d(t,{R:function(){return n},V:function(){return d}});var r=o(7437),c=o(2265),i=o(3325),s=o(2671);let a=(0,c.createContext)(void 0),d=e=>{let{children:t}=e,[o,d]=(0,c.useState)([]);(0,c.useEffect)(()=>{(async()=>{try{console.log("ProductContext: Loading products directly from server...");let e=await i.k.getProducts();console.log("ProductContext: Loaded products from server:",e.length),d(e)}catch(e){console.error("ProductContext: Error loading products:",e),d([])}})();let e=e=>{let t=e.detail;t&&t.products&&d(t.products)},t=e=>{let t=e.detail;t&&t.products&&d(t.products)};return window.addEventListener("data-updated",e),window.addEventListener("data-sync",t),()=>{window.removeEventListener("data-updated",e),window.removeEventListener("data-sync",t)}},[]);let n=async e=>{console.log("\uD83D\uDD27 ProductContext: addProduct called with:",e);try{console.log("\uD83D\uDD27 ProductContext: Calling backendService.addProduct...");let t=await i.k.addProduct(e);console.log("\uD83D\uDD27 ProductContext: backendService.addProduct result:",t),t?(console.log("\uD83D\uDD27 ProductContext: Product added successfully, refreshing..."),await p(),console.log("✅ ProductContext: Product added and refreshed successfully")):console.error("❌ ProductContext: backendService.addProduct returned null")}catch(e){console.error("❌ ProductContext: Error in addProduct:",e)}},u=async(e,t)=>{try{let o=t.stock&&"object"==typeof t.stock?Object.values(t.stock).reduce((e,t)=>t&&"object"==typeof t?e+Object.values(t).reduce((e,t)=>e+("number"==typeof t?t:0),0):e,0):0,r={...t,inStock:o>0};if(console.log("ProductContext: Updating product",e,r.name,"Stock:",o,"InStock:",r.inStock),await i.k.updateProduct(e,r))console.log("✅ ProductContext: Product updated successfully, refreshing..."),await p(),console.log("✅ ProductContext: Products refreshed successfully");else throw console.error("❌ ProductContext: Failed to update product - backendService returned null"),Error("Failed to update product")}catch(e){throw console.error("❌ ProductContext: Error updating product:",e),e}},l=async e=>{try{console.log("ProductContext: Deleting product:",e),await i.k.deleteProduct(e)?(console.log("ProductContext: Product deleted successfully:",e),await p()):console.error("ProductContext: Failed to delete product:",e)}catch(e){console.error("ProductContext: Error deleting product:",e)}},p=async()=>{try{console.log("ProductContext: Refreshing products from server..."),(0,s.f0)();let e=await i.k.getProducts();console.log("ProductContext: Refreshed products from server:",e.length),d(e),window.dispatchEvent(new CustomEvent("data-sync",{detail:{products:e}}))}catch(e){console.error("ProductContext: Error refreshing products:",e)}},g=async()=>{if(0===o.length){let e=[{id:"1",name:"OBSIDIAN HOODIE BLACK",price:4500,originalPrice:5e3,image:"https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=500&h=600&fit=crop",description:"Premium black hoodie with embroidered OBSIDIAN logo. Made from 100% cotton for ultimate comfort.",category:"Hoodies",sizes:["S","M","L","XL"],colors:["Black"],inStock:!0,rating:4.9,reviews:127,stock:{S:{Black:15},M:{Black:20},L:{Black:18},XL:{Black:12}},sku:"OBS-HOODIE-001",weight:.8,tags:["hoodie","black","premium"],featured:!0,createdAt:new Date("2025-01-01"),updatedAt:new Date("2025-01-15")},{id:"2",name:"OBSIDIAN TEE WHITE",price:2500,originalPrice:3e3,image:"https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=500&h=600&fit=crop",description:"Premium white t-shirt with subtle OBSIDIAN branding. 100% cotton oversized fit.",category:"T-Shirts",sizes:["S","M","L","XL"],colors:["White","Black"],inStock:!0,rating:4.8,reviews:89,stock:{S:{White:25,Black:20},M:{White:30,Black:25},L:{White:22,Black:18},XL:{White:18,Black:15}},sku:"OBS-TEE-002",weight:.3,tags:["tshirt","white","black"],featured:!1,createdAt:new Date("2025-01-05"),updatedAt:new Date("2025-01-10")}];for(let t of e){let{id:e,...o}=t;await i.k.addProduct(o)}d(e)}};return(0,r.jsx)(a.Provider,{value:{products:o,setProducts:d,addProduct:n,updateProduct:u,deleteProduct:l,getProduct:e=>o.find(t=>t.id===e),initializeDefaultProducts:g,refreshProducts:p},children:t})},n=()=>{let e=(0,c.useContext)(a);if(void 0===e)throw Error("useAdminProducts must be used within an AdminProductProvider");return e}},2671:function(e,t,o){o.d(t,{OQ:function(){return s},f0:function(){return a},nM:function(){return d}});var r=o(7440);let c="https://twlegtqcyydgjkycxngw.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3bGVndHFjeXlkZ2preWN4bmd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzQ2MDAsImV4cCI6MjA3Mjc1MDYwMH0.uD9GD_ksHCDgmmPAgR7fcLUAJHRJtTkT-J-SVjU-WR0";if(!c||!i)throw Error("Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");let s=(0,r.eI)(c,i);function a(){console.log("Supabase: Products cache cleared")}async function d(e,t){try{let o={};void 0!==t.name&&(o.name=t.name),void 0!==t.description&&(o.description=t.description),void 0!==t.price&&(o.price=t.price),void 0!==t.originalPrice&&(o.original_price=t.originalPrice),void 0!==t.image&&(o.image=t.image),void 0!==t.images&&(o.images=t.images),void 0!==t.stock&&(o.stock=t.stock),void 0!==t.category&&(o.category=t.category),void 0!==t.sizes&&(o.sizes=t.sizes),void 0!==t.colors&&(o.colors=t.colors),void 0!==t.inStock&&(o.in_stock=t.inStock),void 0!==t.rating&&(o.rating=t.rating),void 0!==t.reviews&&(o.reviews=t.reviews),void 0!==t.sku&&(o.sku=t.sku),void 0!==t.weight&&(o.weight=t.weight),void 0!==t.dimensions&&(o.dimensions=t.dimensions),void 0!==t.tags&&(o.tags=t.tags),void 0!==t.featured&&(o.featured=t.featured),void 0!==t.sizeChartCategory&&(o.size_chart_category=t.sizeChartCategory),void 0!==t.customSizeChart&&(o.custom_size_chart=t.customSizeChart),void 0!==t.useCustomSizeChart&&(o.use_custom_size_chart=t.useCustomSizeChart);let{data:r,error:c}=await s.from("products").update(o).eq("id",e).select().single();if(c)return console.error("Supabase updateProduct error:",c),null;return console.log("Supabase: Updated product:",e),function(e){console.log("\uD83D\uDD0D DEBUG: Raw price from DB:",e.price,"Type:",typeof e.price),console.log("\uD83D\uDD0D DEBUG: Parsed price:",parseFloat(e.price),"Type:",typeof parseFloat(e.price));let t={id:e.id,name:e.name,description:e.description,price:parseFloat(e.price),originalPrice:e.original_price?parseFloat(e.original_price):void 0,image:e.image,images:e.images||[],stock:e.stock||{},category:e.category,sizes:e.sizes||[],colors:e.colors||[],inStock:e.in_stock,rating:parseFloat(e.rating||0),reviews:e.reviews||0,sku:e.sku,weight:e.weight?parseFloat(e.weight):void 0,dimensions:e.dimensions,tags:e.tags||[],featured:e.featured||!1,sizeChartCategory:e.size_chart_category||"T-Shirts",customSizeChart:e.custom_size_chart||void 0,useCustomSizeChart:e.use_custom_size_chart||!1,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)};return console.log("\uD83D\uDD0D DEBUG: Final converted product price:",t.price,"Type:",typeof t.price),t}(r)}catch(e){return console.error("Supabase updateProduct error:",e),null}}a(),console.log("\uD83D\uDE80 Cache buster timestamp:",Date.now())}}]);