"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[868],{3917:function(e,r,t){t.d(r,{K:function(){return a}});class o{isCacheValid(){try{let e=localStorage.getItem(this.CACHE_KEY);if(!e)return!1;let r=JSON.parse(e);if(r.version!==this.CACHE_VERSION)return console.log("\uD83D\uDD04 Cache version mismatch, invalidating cache"),!1;let t=Date.now()-r.lastUpdated;if(t>this.CACHE_DURATION)return console.log("\uD83D\uDD04 Cache expired, invalidating cache"),!1;return console.log("✅ Cache is valid, age:",Math.round(t/1e3/60),"minutes"),!0}catch(e){return console.error("❌ Error checking cache validity:",e),!1}}getCache(){try{if(!this.isCacheValid())return null;let e=localStorage.getItem(this.CACHE_KEY);if(!e)return null;let r=JSON.parse(e);return console.log("\uD83D\uDCE6 Retrieved from cache:",{products:r.products.length,orders:r.orders.length,customers:r.customers.length,madeToOrderProducts:r.madeToOrderProducts.length,wilayaTariffs:r.wilayaTariffs.length}),r}catch(e){return console.error("❌ Error getting cache:",e),null}}setCache(e){try{let r={...this.getCache()||{products:[],orders:[],customers:[],madeToOrderProducts:[],wilayaTariffs:[],lastUpdated:0,version:this.CACHE_VERSION},...e,lastUpdated:Date.now(),version:this.CACHE_VERSION};localStorage.setItem(this.CACHE_KEY,JSON.stringify(r)),console.log("\uD83D\uDCBE Cached data:",{products:r.products.length,orders:r.orders.length,customers:r.customers.length,madeToOrderProducts:r.madeToOrderProducts.length,wilayaTariffs:r.wilayaTariffs.length})}catch(e){console.error("❌ Error setting cache:",e)}}clearCache(){try{localStorage.removeItem(this.CACHE_KEY),console.log("\uD83D\uDDD1️ Cache cleared")}catch(e){console.error("❌ Error clearing cache:",e)}}getCacheInfo(){try{let e=localStorage.getItem(this.CACHE_KEY);if(!e)return{exists:!1,age:0,size:0};let r=JSON.parse(e),t=Date.now()-r.lastUpdated,o=new Blob([e]).size;return{exists:!0,age:Math.round(t/1e3/60),size:Math.round(o/1024)}}catch(e){return console.error("❌ Error getting cache info:",e),{exists:!1,age:0,size:0}}}async downloadAllData(){console.log("\uD83D\uDE80 Downloading all data from server...");try{let[e,r,t,o,a]=await Promise.all([fetch("/api/products"),fetch("/api/orders"),fetch("/api/customers"),fetch("/api/made-to-order"),fetch("/api/wilaya")]),[c,s,n,i,d]=await Promise.all([e.ok?e.json():{success:!1,data:[]},r.ok?r.json():{success:!1,data:[]},t.ok?t.json():{success:!1,data:[]},o.ok?o.json():{success:!1,data:[]},a.ok?a.json():{success:!1,data:[]}]),l={products:c.success?c.data:[],orders:s.success?s.data:[],customers:n.success?n.data:[],madeToOrderProducts:i.success?i.data:[],wilayaTariffs:d.success?d.data:[],lastUpdated:Date.now(),version:this.CACHE_VERSION};return this.setCache(l),console.log("✅ All data downloaded and cached successfully"),l}catch(e){throw console.error("❌ Error downloading data:",e),e}}async getProducts(){let e=this.getCache();if(e&&e.products.length>0)return console.log("\uD83D\uDCE6 Using cached products"),e.products;console.log("\uD83C\uDF10 Fetching products from server");try{let e=await fetch("/api/products"),r=await e.json(),t=r.success?r.data:[];return this.setCache({products:t}),t}catch(e){return console.error("❌ Error fetching products:",e),[]}}async getMadeToOrderProducts(){let e=this.getCache();if(e&&e.madeToOrderProducts.length>0)return console.log("\uD83D\uDCE6 Using cached made-to-order products"),e.madeToOrderProducts;console.log("\uD83C\uDF10 Fetching made-to-order products from server");try{let e=await fetch("/api/made-to-order"),r=await e.json(),t=r.success?r.data:[];return this.setCache({madeToOrderProducts:t}),t}catch(e){return console.error("❌ Error fetching made-to-order products:",e),[]}}async getWilayaTariffs(){let e=this.getCache();if(e&&e.wilayaTariffs.length>0)return console.log("\uD83D\uDCE6 Using cached wilaya tariffs"),e.wilayaTariffs;console.log("\uD83C\uDF10 Fetching wilaya tariffs from server");try{let e=await fetch("/api/wilaya"),r=await e.json(),t=r.success?r.data:[];return this.setCache({wilayaTariffs:t}),t}catch(e){return console.error("❌ Error fetching wilaya tariffs:",e),[]}}constructor(){this.CACHE_KEY="obsidian-cache",this.CACHE_VERSION="1.0.0",this.CACHE_DURATION=864e5}}let a=new o},3325:function(e,r,t){t.d(r,{k:function(){return c}});var o=t(2601);class a{getApiUrl(e){return"".concat(this.baseUrl).concat(e)}isBrowser(){return"undefined"!=typeof fetch}getAuthHeaders(){let e=o.env.NEXT_PUBLIC_API_AUTH_TOKEN||"obsidian-api-token-2025";return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}async getProducts(){try{let e=await fetch(this.getApiUrl("/products"),{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=30"},next:{revalidate:30}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();if(r.success)return console.log("BackendService: Fetched",r.count,"products"),r.data||[];return console.error("BackendService: Failed to fetch products:",r.error),[]}catch(e){return console.error("BackendService: Error fetching products:",e),[]}}async getProduct(e){try{let r=await fetch(this.getApiUrl("/products/".concat(e))),t=await r.json();if(t.success)return console.log("BackendService: Fetched product:",e),t.data;return console.error("BackendService: Failed to fetch product:",t.error),null}catch(e){return console.error("BackendService: Error fetching product:",e),null}}async addProduct(e){try{let r=await fetch(this.getApiUrl("/products"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)}),t=await r.json();if(t.success)return console.log("BackendService: Created product:",t.data.id),t.data;return console.error("BackendService: Failed to create product:",t.error),null}catch(e){return console.error("BackendService: Error creating product:",e),null}}async updateProduct(e,r){try{let t=await fetch(this.getApiUrl("/products/".concat(e)),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(r)}),o=await t.json();if(o.success)return console.log("BackendService: Updated product:",e),o.data;return console.error("BackendService: Failed to update product:",o.error),null}catch(e){return console.error("BackendService: Error updating product:",e),null}}async deleteProduct(e){try{let r=await fetch(this.getApiUrl("/products/".concat(e)),{method:"DELETE",headers:this.getAuthHeaders()}),t=await r.json();if(t.success)return console.log("BackendService: Deleted product:",e),!0;return console.error("BackendService: Failed to delete product:",t.error),!1}catch(e){return console.error("BackendService: Error deleting product:",e),!1}}async getOrders(){try{let e=await fetch(this.getApiUrl("/orders"),{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=30"},next:{revalidate:30}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=e.headers.get("content-type");if(!r||!r.includes("application/json")){let t=await e.text();return console.error("BackendService: Received non-JSON response:",{status:e.status,contentType:r,text:t.substring(0,200)}),[]}let t=await e.json();if(t.success)return console.log("BackendService: Fetched",t.count,"orders"),t.data||[];return console.error("BackendService: Failed to fetch orders:",t.error),[]}catch(e){return console.error("BackendService: Error fetching orders:",e),[]}}async getOrder(e){try{let r=await fetch(this.getApiUrl("/orders/".concat(e))),t=await r.json();if(t.success)return console.log("BackendService: Fetched order:",e),t.data;return console.error("BackendService: Failed to fetch order:",t.error),null}catch(e){return console.error("BackendService: Error fetching order:",e),null}}async addOrder(e){try{let r=await fetch(this.getApiUrl("/orders"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)}),t=await r.json();if(t.success)return console.log("BackendService: Created order:",t.data.id),t.data;return console.error("BackendService: Failed to create order:",t.error),null}catch(e){return console.error("BackendService: Error creating order:",e),null}}async updateOrder(e,r){try{let t=await fetch(this.getApiUrl("/orders/".concat(e)),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(r)}),o=await t.json();if(o.success)return console.log("BackendService: Updated order:",e),o.data;return console.error("BackendService: Failed to update order:",o.error),null}catch(e){return console.error("BackendService: Error updating order:",e),null}}async deleteOrder(e){try{let r=await fetch(this.getApiUrl("/orders/".concat(e)),{method:"DELETE",headers:this.getAuthHeaders()}),t=await r.json();if(t.success)return console.log("BackendService: Deleted order:",e),!0;return console.error("BackendService: Failed to delete order:",t.error),!1}catch(e){return console.error("BackendService: Error deleting order:",e),!1}}async getCustomers(){try{let e=await fetch(this.getApiUrl("/customers")),r=await e.json();if(r.success)return console.log("BackendService: Fetched",r.count,"customers"),r.data||[];return console.error("BackendService: Failed to fetch customers:",r.error),[]}catch(e){return console.error("BackendService: Error fetching customers:",e),[]}}async addCustomer(e){try{let r=await fetch(this.getApiUrl("/customers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();if(t.success)return console.log("BackendService: Created customer:",t.data.id),t.data;return console.error("BackendService: Failed to create customer:",t.error),null}catch(e){return console.error("BackendService: Error creating customer:",e),null}}async getWilayaTariffs(){try{let e=await fetch(this.getApiUrl("/wilaya")),r=await e.json();if(r.success)return console.log("BackendService: Fetched",r.count,"wilaya tariffs"),r.data||[];return console.error("BackendService: Failed to fetch wilaya tariffs:",r.error),[]}catch(e){return console.error("BackendService: Error fetching wilaya tariffs:",e),[]}}async updateWilayaTariffs(e){try{let r=await fetch(this.getApiUrl("/wilaya"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();if(t.success)return console.log("BackendService: Updated wilaya tariffs"),!0;return console.error("BackendService: Failed to update wilaya tariffs:",t.error),!1}catch(e){return console.error("BackendService: Error updating wilaya tariffs:",e),!1}}constructor(){this.baseUrl="/api"}}let c=new a}}]);