"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{9755:function(e,t,r){r.r(t);var n=r(2671);class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}generateSessionId(){{let e=sessionStorage.getItem("obsidian-preferences-session-id");return e||(e="prefs_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("obsidian-preferences-session-id",e)),e}}async getPreferences(){let e=Date.now();if(this.cache&&e-this.cacheTime<this.CACHE_DURATION)return this.cache;try{if(!n.OQ)return console.error("Supabase client not initialized"),null;let{data:t,error:r}=await n.OQ.from("user_preferences").select("*").eq("session_id",this.sessionId).single();if(r&&"PGRST116"!==r.code)return console.error("Error fetching preferences:",r),null;if(t)return this.cache=t,this.cacheTime=e,t;return null}catch(e){return console.error("Error fetching preferences:",e),null}}async setLanguage(e){try{if(!n.OQ)return console.error("Supabase client not initialized"),!1;let{error:t}=await n.OQ.from("user_preferences").upsert({session_id:this.sessionId,language:e,updated_at:new Date().toISOString()});if(t)return console.error("Error setting language:",t),!1;return this.cache=null,this.cacheTime=0,!0}catch(e){return console.error("Error setting language:",e),!1}}async setTheme(e){try{if(!n.OQ)return console.error("Supabase client not initialized"),!1;let{error:t}=await n.OQ.from("user_preferences").upsert({session_id:this.sessionId,theme:e,updated_at:new Date().toISOString()});if(t)return console.error("Error setting theme:",t),!1;return this.cache=null,this.cacheTime=0,!0}catch(e){return console.error("Error setting theme:",e),!1}}async getLanguage(){let e=await this.getPreferences();return(null==e?void 0:e.language)||"en"}async getTheme(){let e=await this.getPreferences();return(null==e?void 0:e.theme)||"dark"}getLanguageSync(){return localStorage.getItem("obsidian-language")||"en"}getThemeSync(){return localStorage.getItem("admin-theme")||"dark"}async syncFromLocalStorage(){{let e=localStorage.getItem("obsidian-language"),t=localStorage.getItem("admin-theme");e&&await this.setLanguage(e),t&&await this.setTheme(t)}}constructor(){this.cache=null,this.cacheTime=0,this.CACHE_DURATION=3e4,this.sessionId=this.generateSessionId()}}t.default=s.getInstance()}}]);