(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{1981:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(2898).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3067:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(2898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3008:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1738:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(2898).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},6142:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(2898).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},1961:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(2898).Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]])},7972:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(2898).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},851:function(e,r,t){Promise.resolve().then(t.bind(t,645))},645:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return j}});var s=t(7437),c=t(2265),o=t(4033),a=t(6691),i=t.n(a),l=t(5454),n=t(8722),d=t(861),m=t(9298),u=t(5109),h=t(4401),p=t(3067),x=t(3008),g=t(1981),y=t(7972),f=t(6142),b=t(1961),k=t(1738),v=t(2831);function j(){let e=(0,o.useSearchParams)(),r=(0,o.useRouter)(),{getProduct:t}=(0,d.useProducts)(),{t:a}=(0,m.useLanguage)(),[j,E]=(0,c.useState)(null),[N,D]=(0,c.useState)({name:"",phone:"",email:"",address:"",city:"",wilaya:"",notes:""}),[w,A]=(0,c.useState)(!1),[S,O]=(0,c.useState)("idle"),[C,I]=(0,c.useState)(""),[P,z]=(0,c.useState)(""),[T,Z]=(0,c.useState)("stopDeskEcommerce"),[M,q]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let r=e.get("productId"),s=e.get("productData"),c=e.get("size"),o=e.get("color"),a=parseInt(e.get("quantity")||"1");if(r){var i,l,n,d;if(s)try{let e=JSON.parse(decodeURIComponent(s));if(E(e),c&&o){let r=(null===(l=e.stock)||void 0===l?void 0:null===(i=l[c])||void 0===i?void 0:i[o])||0;if(r<a){O("error"),I("❌ This item is out of stock. Only ".concat(r," items available in ").concat(c," ").concat(o,"."));return}}}catch(e){console.error("Error parsing product data from URL:",e),E(t(r)||null)}else{let e=t(r);if(E(e||null),e&&c&&o){let r=(null===(d=e.stock)||void 0===d?void 0:null===(n=d[c])||void 0===n?void 0:n[o])||0;if(r<a){O("error"),I("❌ This item is out of stock. Only ".concat(r," items available in ").concat(c," ").concat(o,"."));return}}}}B()},[e,t]);let B=()=>{try{let e=localStorage.getItem("checkoutFormData");if(e){let r=JSON.parse(e);D(e=>({...e,...r}))}let r=localStorage.getItem("checkoutShippingMethod");r&&("stopDeskEcommerce"===r||"domicileEcommerce"===r)&&Z(r)}catch(e){console.error("Error loading saved form data:",e)}},U=e=>{try{localStorage.setItem("checkoutFormData",JSON.stringify(e)),q(!0),setTimeout(()=>q(!1),2e3)}catch(e){console.error("Error saving form data:",e)}},F=()=>{try{localStorage.removeItem("checkoutFormData"),localStorage.removeItem("checkoutShippingMethod")}catch(e){console.error("Error clearing saved form data:",e)}},R=e=>{let{name:r,value:t}=e.target,s={...N,[r]:t};D(s),U(s)},L=async t=>{if(t.preventDefault(),!j){O("error"),I("Product information is missing");return}if(!N.city.trim()){O("error"),I("Please enter your city");return}if(!N.wilaya){O("error"),I("Please select a wilaya for shipping");return}A(!0),O("idle");try{var s,c;let t=parseInt(e.get("quantity")||"1"),o=e.get("size")||"M",a=e.get("color")||"Black",i=u.rA.find(e=>e.id.toString()===N.wilaya);if(!i)throw Error("Invalid wilaya selection");let l=i[T],n=(null===(c=j.stock)||void 0===c?void 0:null===(s=c[o])||void 0===s?void 0:s[a])||0;if(n<t){O("error"),I("❌ Not enough stock available. Only ".concat(n," items available in ").concat(o," ").concat(a,".")),A(!1);return}let d={customerName:N.name,customerEmail:N.email,customerPhone:N.phone,customerAddress:N.address,customerCity:N.city,wilayaId:i.id,wilayaName:i.name,productId:j.id,selectedSize:o,selectedColor:a,quantity:t,subtotal:j.price*t,shippingCost:l,total:j.price*t+l,shippingType:T,paymentMethod:"cod",notes:N.notes},m=await h.X.createOrder(d,j);if(m.success&&m.orderId)console.log("✅ Order created successfully, inventory has been reserved and deducted"),O("success"),z(m.orderId),I("Order #".concat(m.orderId," placed successfully! \uD83C\uDF89\n\nWe'll contact you within 24 hours via WhatsApp.")),F(),setTimeout(()=>{r.push("/order-success?orderId=".concat(m.orderId))},3e3);else throw Error(m.error||"Failed to place order")}catch(e){console.error("Order submission error:",e),O("error"),I("Failed to place order. Please check your information and try again.")}finally{A(!1)}};if(!j)return(0,s.jsxs)("div",{className:"min-h-screen bg-black",children:[(0,s.jsx)(l.default,{}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(v.sr,{message:"Loading product details..."}),(0,s.jsxs)("button",{onClick:()=>r.push("/"),className:"mt-8 text-white hover:text-gray-300 flex items-center justify-center mx-auto",children:[(0,s.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Back to Home"]})]})}),(0,s.jsx)(n.Z,{})]});let W=parseInt(e.get("quantity")||"1"),_=e.get("size")||"",H=e.get("color")||"",J=j.price*W,V=u.rA.find(e=>e.id.toString()===N.wilaya),G=V?V[T]:0,X=J+G;return(0,s.jsxs)("div",{className:"min-h-screen bg-black",children:[(0,s.jsx)(l.default,{}),(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("button",{onClick:()=>r.back(),className:"flex items-center text-white hover:text-gray-300 mb-8 transition-colors",children:[(0,s.jsx)(p.Z,{size:20,className:"mr-2"}),a("checkout.backToProduct")]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,s.jsxs)("div",{className:"space-y-6 lg:order-2 order-1",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:a("checkout.deliveryInformation")}),"success"===S&&(0,s.jsx)("div",{className:"bg-green-900/20 border border-green-700 rounded-lg p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.Z,{className:"w-5 h-5 text-green-400 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-green-300 font-semibold",children:"Order Placed Successfully!"}),(0,s.jsx)("p",{className:"text-green-200 text-sm whitespace-pre-line",children:C})]})]})}),"error"===S&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-700 rounded-lg p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(g.Z,{className:"w-5 h-5 text-red-400 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-red-300 font-semibold",children:"Order Failed"}),(0,s.jsx)("p",{className:"text-red-200 text-sm",children:C})]})]})}),(0,s.jsxs)("form",{onSubmit:L,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-800",children:[(0,s.jsxs)("h3",{className:"text-white font-semibold text-lg mb-4 flex items-center",children:[(0,s.jsx)(y.Z,{size:20,className:"mr-2"}),a("checkout.personalInformation")]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:[a("checkout.fullName")," *"]}),(0,s.jsx)("input",{type:"text",name:"name",value:N.name,onChange:R,required:!0,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-white",placeholder:a("checkout.enterFullName")})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:[a("checkout.phoneNumber")," *"]}),(0,s.jsx)("input",{type:"tel",name:"phone",value:N.phone,onChange:R,required:!0,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-white",placeholder:a("checkout.enterPhoneNumber")})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:[a("checkout.emailAddress")," (",a("checkout.optional"),")"]}),(0,s.jsx)("input",{type:"email",name:"email",value:N.email,onChange:R,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-white",placeholder:a("checkout.enterEmailAddress")})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-800",children:[(0,s.jsxs)("h3",{className:"text-white font-semibold text-lg mb-4 flex items-center",children:[(0,s.jsx)(f.Z,{size:20,className:"mr-2"}),a("domicileEcommerce"===T?"checkout.deliveryAddress":"checkout.pickupLocation")]}),(0,s.jsxs)("div",{className:"space-y-4",children:["domicileEcommerce"===T&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:[a("checkout.streetAddress")," *"]}),(0,s.jsx)("input",{type:"text",name:"address",value:N.address,onChange:R,required:!0,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-white",placeholder:a("checkout.enterStreetAddress")})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:[a("checkout.city")," *"]}),(0,s.jsx)("input",{type:"text",name:"city",value:N.city,onChange:R,required:!0,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-white",placeholder:a("checkout.enterCity")})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:[a("checkout.wilaya")," *"]}),(0,s.jsxs)("select",{name:"wilaya",value:N.wilaya,onChange:R,required:!0,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-white",children:[(0,s.jsx)("option",{value:"",children:a("checkout.selectWilaya")}),u.rA.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," (#",e.id,")"]},e.id))]})]})]}),"stopDeskEcommerce"===T&&(0,s.jsx)("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-lg p-4",children:(0,s.jsx)("p",{className:"text-blue-300 text-sm",children:"\uD83D\uDCCD You will pick up your order at the nearest stop desk in your selected wilaya"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-400 text-sm font-medium mb-2",children:a("checkout.deliveryNotes")}),(0,s.jsx)("textarea",{name:"notes",value:N.notes,onChange:R,rows:3,className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-white resize-none",placeholder:a("checkout.deliveryInstructionsPlaceholder")})]})]})]}),(0,s.jsx)("button",{type:"submit",disabled:w,className:"w-full bg-white text-black py-4 px-6 rounded-lg font-semibold text-lg hover:bg-gray-200 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-gray-600 border-t-black rounded-full animate-spin"}),(0,s.jsx)("span",{children:a("checkout.placingOrder")})]}):(0,s.jsxs)("span",{children:[a("checkout.placeOrder")," - ",X.toFixed(0)," DA"]})})]})]}),(0,s.jsxs)("div",{className:"space-y-6 lg:order-1 order-2",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:a("checkout.orderSummary")}),(0,s.jsx)("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-800",children:(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-gray-800 rounded-lg overflow-hidden flex-shrink-0",children:(0,s.jsx)(i(),{src:j.image,alt:j.name,width:80,height:80,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-white font-semibold text-lg",children:j.name}),(0,s.jsx)("p",{className:"text-gray-400",children:j.category}),(0,s.jsxs)("div",{className:"mt-2 space-y-1",children:[_&&(0,s.jsxs)("p",{className:"text-gray-400 text-sm",children:[a("checkout.size"),": ",_]}),H&&(0,s.jsxs)("p",{className:"text-gray-400 text-sm",children:[a("checkout.color"),": ",H]}),(0,s.jsxs)("p",{className:"text-gray-400 text-sm",children:[a("checkout.quantity"),": ",W]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-white font-semibold",children:[j.price," DZD"]}),(0,s.jsxs)("p",{className:"text-gray-400 text-sm",children:["x",W]})]})]})}),(0,s.jsxs)("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-800",children:[(0,s.jsxs)("h3",{className:"text-white font-semibold text-lg mb-2 flex items-center",children:[(0,s.jsx)(b.Z,{size:20,className:"mr-2"}),a("checkout.deliveryOptions")," ",(0,s.jsx)("span",{className:"text-red-400 ml-2",children:"*"})]}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:a("checkout.selectDeliveryOption")}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-center space-x-4 cursor-pointer p-4 rounded-lg border-2 transition-all duration-200 ".concat("stopDeskEcommerce"===T?"border-blue-500 bg-blue-500/10 shadow-lg shadow-blue-500/20":"border-gray-700 hover:border-gray-600 hover:bg-gray-800/30"),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"radio",name:"shipping",value:"stopDeskEcommerce",checked:"stopDeskEcommerce"===T,onChange:e=>{console.log("Radio clicked:",e.target.value);let r=e.target.value;Z(r),localStorage.setItem("checkoutShippingMethod",r)},className:"w-5 h-5 text-blue-500 accent-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900"}),"stopDeskEcommerce"===T&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-white font-semibold text-lg",children:a("checkout.stopDesk")}),"stopDeskEcommerce"===T&&(0,s.jsx)("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full font-medium",children:a("checkout.selected")})]}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:a("checkout.stopDeskDescription")})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("span",{className:"text-white font-bold text-lg",children:V?"".concat(V.stopDeskEcommerce," DZD"):"--"})})]}),(0,s.jsxs)("label",{className:"flex items-center space-x-4 cursor-pointer p-4 rounded-lg border-2 transition-all duration-200 ".concat("domicileEcommerce"===T?"border-blue-500 bg-blue-500/10 shadow-lg shadow-blue-500/20":"border-gray-700 hover:border-gray-600 hover:bg-gray-800/30"),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"radio",name:"shipping",value:"domicileEcommerce",checked:"domicileEcommerce"===T,onChange:e=>{console.log("Radio clicked:",e.target.value);let r=e.target.value;Z(r),localStorage.setItem("checkoutShippingMethod",r)},className:"w-5 h-5 text-blue-500 accent-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900"}),"domicileEcommerce"===T&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-white font-semibold text-lg",children:a("checkout.homeDelivery")}),"domicileEcommerce"===T&&(0,s.jsx)("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full font-medium",children:a("checkout.selected")})]}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:a("checkout.homeDeliveryDescription")})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("span",{className:"text-white font-bold text-lg",children:V?"".concat(V.domicileEcommerce," DZD"):"--"})})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-800",children:[(0,s.jsxs)("h3",{className:"text-white font-semibold text-lg mb-4 flex items-center",children:[(0,s.jsx)(k.Z,{size:20,className:"mr-2"}),"Mode de Paiement"]}),(0,s.jsx)("div",{className:"bg-green-900 border border-green-700 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-green-600 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-sm font-bold",children:"✓"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-green-300 font-semibold",children:"Paiement \xe0 la Livraison (COD)"}),(0,s.jsx)("p",{className:"text-green-400 text-sm",children:"Payez quand votre commande arrive"})]})]})})]}),(0,s.jsx)("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-800",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:a("checkout.subtotal")}),(0,s.jsxs)("span",{className:"text-white",children:[J.toFixed(0)," DA"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:a("checkout.shipping")}),(0,s.jsxs)("span",{className:"text-white",children:[G.toFixed(0)," DA"]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:a("stopDeskEcommerce"===T?"checkout.stopDesk":"checkout.homeDelivery")}),(0,s.jsx)("span",{className:"text-gray-500",children:V?V.name:a("checkout.selectWilaya")})]}),(0,s.jsx)("div",{className:"border-t border-gray-700 pt-3",children:(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-white font-semibold text-lg",children:a("checkout.total")}),(0,s.jsxs)("span",{className:"text-white font-bold text-xl",children:[X.toFixed(0)," DA"]})]})})]})})]})]})]}),(0,s.jsx)(n.Z,{})]})}},861:function(e,r,t){"use strict";t.r(r),t.d(r,{SmartProductProvider:function(){return d},useAdminProducts:function(){return a.R},useProducts:function(){return m},useUserProducts:function(){return n}});var s=t(7437),c=t(2265),o=t(4033),a=t(7023),i=t(2042);t(3325),t(2136);let l=(0,c.createContext)(void 0),n=()=>{let e=(0,c.useContext)(l);if(void 0===e)throw Error("useUserProducts must be used within a UserProductProvider");return e},d=e=>{let{children:r}=e,t=(0,o.usePathname)();return(null==t?void 0:t.startsWith("/admin"))?(console.log("\uD83D\uDD27 Using AdminProductProvider (no cache)"),(0,s.jsx)(a.V,{children:r})):(console.log("\uD83D\uDE80 Using OptimizedUserDataProvider (loads all user data at once)"),(0,s.jsx)(i.V,{children:r}))},m=()=>{let e=(0,o.usePathname)();if(null==e?void 0:e.startsWith("/admin"))return(0,a.R)();{let e=(0,i.E)();return{products:e.products,loading:e.loading,lastUpdated:e.lastUpdated,timeUntilRefresh:e.timeUntilRefresh,refreshProducts:e.refreshAllData,getProduct:e.getProduct}}}},5109:function(e,r,t){"use strict";t.d(r,{rA:function(){return s}});let s=[{id:1,name:"Adrar",nameAr:"أدرار",stopDeskEcommerce:800,domicileEcommerce:1200},{id:2,name:"Chlef",nameAr:"الشلف",stopDeskEcommerce:300,domicileEcommerce:500},{id:3,name:"Laghouat",nameAr:"الأغواط",stopDeskEcommerce:500,domicileEcommerce:800},{id:4,name:"Oum El Bouaghi",nameAr:"أم البواقي",stopDeskEcommerce:450,domicileEcommerce:700},{id:5,name:"Batna",nameAr:"باتنة",stopDeskEcommerce:500,domicileEcommerce:800},{id:6,name:"B\xe9ja\xefa",nameAr:"بجاية",stopDeskEcommerce:400,domicileEcommerce:600},{id:7,name:"Biskra",nameAr:"بسكرة",stopDeskEcommerce:600,domicileEcommerce:900},{id:8,name:"B\xe9char",nameAr:"بشار",stopDeskEcommerce:1e3,domicileEcommerce:1500},{id:9,name:"Blida",nameAr:"البليدة",stopDeskEcommerce:250,domicileEcommerce:400},{id:10,name:"Bouira",nameAr:"البويرة",stopDeskEcommerce:300,domicileEcommerce:500},{id:11,name:"Tamanrasset",nameAr:"تمنراست",stopDeskEcommerce:1300,domicileEcommerce:2e3},{id:12,name:"T\xe9bessa",nameAr:"تبسة",stopDeskEcommerce:650,domicileEcommerce:1e3},{id:13,name:"Tlemcen",nameAr:"تلمسان",stopDeskEcommerce:450,domicileEcommerce:700},{id:14,name:"Tiaret",nameAr:"تيارت",stopDeskEcommerce:400,domicileEcommerce:600},{id:15,name:"Tizi Ouzou",nameAr:"تيزي وزو",stopDeskEcommerce:300,domicileEcommerce:450},{id:16,name:"Alger",nameAr:"الجزائر",stopDeskEcommerce:200,domicileEcommerce:300},{id:17,name:"Djelfa",nameAr:"الجلفة",stopDeskEcommerce:450,domicileEcommerce:700},{id:18,name:"Jijel",nameAr:"جيجل",stopDeskEcommerce:350,domicileEcommerce:550},{id:19,name:"S\xe9tif",nameAr:"سطيف",stopDeskEcommerce:400,domicileEcommerce:600},{id:20,name:"Sa\xefda",nameAr:"سعيدة",stopDeskEcommerce:400,domicileEcommerce:600},{id:21,name:"Skikda",nameAr:"سكيكدة",stopDeskEcommerce:400,domicileEcommerce:650},{id:22,name:"Sidi Bel Abb\xe8s",nameAr:"سيدي بلعباس",stopDeskEcommerce:450,domicileEcommerce:700},{id:23,name:"Annaba",nameAr:"عنابة",stopDeskEcommerce:450,domicileEcommerce:700},{id:24,name:"Guelma",nameAr:"قالمة",stopDeskEcommerce:400,domicileEcommerce:650},{id:25,name:"Constantine",nameAr:"قسنطينة",stopDeskEcommerce:400,domicileEcommerce:600},{id:26,name:"M\xe9d\xe9a",nameAr:"المدية",stopDeskEcommerce:300,domicileEcommerce:500},{id:27,name:"Mostaganem",nameAr:"مستغانم",stopDeskEcommerce:400,domicileEcommerce:600},{id:28,name:"M'Sila",nameAr:"المسيلة",stopDeskEcommerce:450,domicileEcommerce:700},{id:29,name:"Mascara",nameAr:"معسكر",stopDeskEcommerce:400,domicileEcommerce:650},{id:30,name:"Ouargla",nameAr:"ورقلة",stopDeskEcommerce:650,domicileEcommerce:1e3},{id:31,name:"Oran",nameAr:"وهران",stopDeskEcommerce:250,domicileEcommerce:400},{id:32,name:"El Bayadh",nameAr:"البيض",stopDeskEcommerce:500,domicileEcommerce:800},{id:33,name:"Illizi",nameAr:"إليزي",stopDeskEcommerce:1200,domicileEcommerce:1800},{id:34,name:"Bordj Bou Arr\xe9ridj",nameAr:"برج بوعريريج",stopDeskEcommerce:400,domicileEcommerce:600},{id:35,name:"Boumerd\xe8s",nameAr:"بومرداس",stopDeskEcommerce:300,domicileEcommerce:450},{id:36,name:"El Tarf",nameAr:"الطارف",stopDeskEcommerce:450,domicileEcommerce:700},{id:37,name:"Tindouf",nameAr:"تندوف",stopDeskEcommerce:1200,domicileEcommerce:1800},{id:38,name:"Tissemsilt",nameAr:"تيسمسيلت",stopDeskEcommerce:350,domicileEcommerce:550},{id:39,name:"El Oued",nameAr:"الوادي",stopDeskEcommerce:600,domicileEcommerce:900},{id:40,name:"Khenchela",nameAr:"خنشلة",stopDeskEcommerce:500,domicileEcommerce:800},{id:41,name:"Souk Ahras",nameAr:"سوق أهراس",stopDeskEcommerce:450,domicileEcommerce:700},{id:42,name:"Tipaza",nameAr:"تيبازة",stopDeskEcommerce:250,domicileEcommerce:400},{id:43,name:"Mila",nameAr:"ميلة",stopDeskEcommerce:400,domicileEcommerce:600},{id:44,name:"A\xefn Defla",nameAr:"عين الدفلى",stopDeskEcommerce:300,domicileEcommerce:500},{id:45,name:"Na\xe2ma",nameAr:"النعامة",stopDeskEcommerce:500,domicileEcommerce:800},{id:46,name:"A\xefn T\xe9mouchent",nameAr:"عين تيموشنت",stopDeskEcommerce:400,domicileEcommerce:650},{id:47,name:"Gharda\xefa",nameAr:"غرداية",stopDeskEcommerce:650,domicileEcommerce:1e3},{id:48,name:"Relizane",nameAr:"غليزان",stopDeskEcommerce:400,domicileEcommerce:600},{id:49,name:"Timimoun",nameAr:"تيميمون",stopDeskEcommerce:900,domicileEcommerce:1400},{id:50,name:"Bordj Badji Mokhtar",nameAr:"برج باجي مختار",stopDeskEcommerce:1100,domicileEcommerce:1600},{id:51,name:"Ouled Djellal",nameAr:"أولاد جلال",stopDeskEcommerce:700,domicileEcommerce:1100},{id:52,name:"Beni Abbes",nameAr:"بني عباس",stopDeskEcommerce:850,domicileEcommerce:1300},{id:53,name:"In Salah",nameAr:"عين صالح",stopDeskEcommerce:1150,domicileEcommerce:1700},{id:54,name:"In Guezzam",nameAr:"عين قزام",stopDeskEcommerce:1250,domicileEcommerce:1900},{id:55,name:"Touggourt",nameAr:"تقرت",stopDeskEcommerce:600,domicileEcommerce:950},{id:56,name:"Djanet",nameAr:"جانت",stopDeskEcommerce:1300,domicileEcommerce:2e3},{id:57,name:"El M'Ghair",nameAr:"المغير",stopDeskEcommerce:800,domicileEcommerce:1200},{id:58,name:"El Meniaa",nameAr:"المنيعة",stopDeskEcommerce:900,domicileEcommerce:1400}].sort((e,r)=>e.id-r.id)},4401:function(e,r,t){"use strict";t.d(r,{X:function(){return o}});var s=t(3325);class c{async initializeOrders(){await this.loadOrders()}async loadOrders(){this.orders=await s.k.getOrders()}setupDataSync(){window.addEventListener("data-updated",e=>{let r=e.detail;r&&r.orders&&(this.orders=r.orders)})}generateOrderId(){let e=Date.now().toString(),r=Math.random().toString(36).substr(2,4).toUpperCase();return"OBS".concat(e.slice(-6)).concat(r)}async createOrder(e,r){try{var t,c;let o=(null===(c=r.stock)||void 0===c?void 0:null===(t=c[e.selectedSize])||void 0===t?void 0:t[e.selectedColor])||0;if(o<e.quantity)return console.error("❌ Insufficient stock for order:",{available:o,requested:e.quantity,size:e.selectedSize,color:e.selectedColor}),{success:!1,error:"Not enough stock available. Only ".concat(o," items available in ").concat(e.selectedSize," ").concat(e.selectedColor,".")};let a=await fetch("/api/inventory/reserve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e.productId,size:e.selectedSize,color:e.selectedColor,quantity:e.quantity})});if(!a.ok){let e=await a.json();return console.error("❌ Failed to reserve inventory:",e),{success:!1,error:"Inventory reservation failed: ".concat(e.error||"Unknown error")}}console.log("✅ Inventory reserved successfully for order");let i=this.generateOrderId(),l=new Date,n={id:i,customerName:e.customerName,customerEmail:e.customerEmail,customerPhone:e.customerPhone,customerAddress:e.customerAddress,customerCity:e.customerCity||"",wilayaId:e.wilayaId,wilayaName:e.wilayaName,productId:e.productId,productName:r.name,productImage:r.image,selectedSize:e.selectedSize,selectedColor:e.selectedColor,quantity:e.quantity,subtotal:e.subtotal,shippingCost:e.shippingCost,total:e.total,shippingType:"domicileEcommerce"===e.shippingType?"homeDelivery":"stopDesk",paymentMethod:e.paymentMethod,paymentStatus:"pending",status:"pending",orderDate:l,notes:e.notes||"",trackingNumber:"",estimatedDelivery:this.calculateEstimatedDelivery(e.shippingType),createdAt:l,updatedAt:l};return await s.k.addOrder(n),this.orders.unshift(n),console.log("✅ Order created successfully with inventory reserved, email will be sent via API"),{success:!0,orderId:i}}catch(e){return console.error("❌ Failed to create order:",e),{success:!1,error:"Failed to create order. Please try again."}}}getOrders(){return this.orders}getOrder(e){return this.orders.find(r=>r.id===e)}async updateOrderStatus(e,r,t){try{let c=this.orders.findIndex(r=>r.id===e);if(-1===c)return!1;let o={...this.orders[c],status:r,trackingNumber:t||this.orders[c].trackingNumber,updatedAt:new Date};return await s.k.updateOrder(e,o),this.orders[c]=o,!0}catch(e){return console.error("Failed to update order status:",e),!1}}calculateEstimatedDelivery(e){let r=new Date;return r.setDate(r.getDate()+("domicileEcommerce"===e?3:2)),r.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}getOrderStats(){let e=this.orders.length,r=this.orders.filter(e=>"pending"===e.status).length,t=this.orders.filter(e=>"confirmed"===e.status).length,s=this.orders.filter(e=>"shipped"===e.status).length;return{total:e,pending:r,confirmed:t,shipped:s,delivered:this.orders.filter(e=>"delivered"===e.status).length,cancelled:this.orders.filter(e=>"cancelled"===e.status).length,totalRevenue:this.orders.filter(e=>"delivered"===e.status).reduce((e,r)=>e+r.total,0)}}setOrders(e){this.orders=e}exportOrdersCSV(){return[["Order ID","Date","Customer","Email","Phone","Product","Size","Color","Quantity","Total","Status","Wilaya","Shipping"],...this.orders.map(e=>{let r="";try{if(e.orderDate instanceof Date)r=e.orderDate.toISOString().split("T")[0];else if("string"==typeof e.orderDate){let t=new Date(e.orderDate);r=isNaN(t.getTime())?e.orderDate:t.toISOString().split("T")[0]}else r="Unknown"}catch(t){console.warn("Error formatting date for order:",e.id,t),r="Unknown"}return[e.id||"N/A",r,e.customerName||"N/A",e.customerEmail||"N/A",e.customerPhone||"N/A",e.productName||"N/A",e.selectedSize||"N/A",e.selectedColor||"N/A",e.quantity||0,e.total||0,e.status||"N/A",e.wilayaName||"N/A",e.shippingType||"N/A"]})].map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(",")).join("\n")}clearOrders(){this.orders=[]}constructor(){this.orders=[],this.initializeOrders(),this.setupDataSync()}}let o=new c},4033:function(e,r,t){e.exports=t(5313)}},function(e){e.O(0,[986,902,440,298,454,42,23,44,971,938,744],function(){return e(e.s=851)}),_N_E=e.O()}]);