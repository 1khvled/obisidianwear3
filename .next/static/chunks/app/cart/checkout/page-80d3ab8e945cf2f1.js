(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[308],{2442:function(e,t,l){"use strict";l.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,l(2898).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},7972:function(e,t,l){"use strict";l.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,l(2898).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4578:function(e,t,l){Promise.resolve().then(l.bind(l,6262))},6262:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return b}});var i=l(7437),a=l(2265),s=l(4033),o=l(2095),r=l(5518),n=l(8722),d=l(8340),c=l(3067),h=l(7972),u=l(1961),p=l(7480);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,l(2898).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var x=l(4322),j=l(2442);function b(){let e=(0,s.useRouter)(),{items:t,getTotalPrice:l,clearCart:b}=(0,o.useCart)(),[f,v]=(0,a.useState)(!0),[g,k]=(0,a.useState)(!1),[y,w]=(0,a.useState)(0),[N,_]=(0,a.useState)(!1),[S,C]=(0,a.useState)(""),[D,M]=(0,a.useState)(null),[O,E]=(0,a.useState)([]),[T,B]=(0,a.useState)("domicile"),[A,z]=(0,a.useState)({name:"",phone:"",email:"",address:"",wilaya:""});(0,a.useEffect)(()=>{if(y>0){let e=setTimeout(()=>{w(e=>e-1)},1e3);return()=>clearTimeout(e)}0===y&&N&&e.push("/")},[y,N,e]),(0,a.useEffect)(()=>{if(0===t.length){e.push("/cart");return}v(!1)},[t,e]);let R=async()=>{let e=[];for(let a of t)try{let t=await fetch("/api/products/".concat(a.productId,"?t=").concat(Date.now()),{cache:"no-store"});if(t.ok){let s=await t.json();if(s.success&&s.data){var l,i;let t=s.data,o=(null===(i=t.stock)||void 0===i?void 0:null===(l=i[a.selectedSize])||void 0===l?void 0:l[a.selectedColor])||0;0===o?e.push("".concat(a.name," - Size ").concat(a.selectedSize," in ").concat(a.selectedColor," is OUT OF STOCK")):a.quantity>o&&e.push("".concat(a.name," - Size ").concat(a.selectedSize," in ").concat(a.selectedColor,": Only ").concat(o," available (requested ").concat(a.quantity,")"))}}}catch(t){e.push("".concat(a.name," - Could not verify stock availability"))}return e},I=async e=>{if(e.preventDefault(),g)return;if(!/^0\d{9}$/.test(A.phone)){alert("Please enter a valid phone number");return}if(!A.name||!A.phone||!A.wilaya){alert("Please fill in all required customer information");return}if(!T){alert("Please select a delivery option");return}if("domicile"===T&&!A.address){alert("Please provide your address for home delivery");return}k(!0);let i=await R();if(i.length>0){E(i),k(!1),alert("❌ Stock validation failed:\n\n".concat(i.join("\n"),"\n\nPlease remove out-of-stock items from your cart."));return}let a=Z(),s=l();try{let e={items:t.map(e=>({id:e.productId,name:e.name,price:e.price,type:"collection",selectedSize:e.selectedSize,selectedColor:e.selectedColor,quantity:e.quantity,subtotal:e.price*e.quantity})),customer:{name:A.name,phone:A.phone,email:A.email,address:A.address,wilaya:A.wilaya},delivery:{option:T,cost:a},total:s+a,subtotal:s},l=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await l.json();i.success?(C(i.order.id),M(e),_(!0),w(10),b()):alert("Failed to place order: "+i.error)}catch(e){alert("Failed to place order. Please try again.")}finally{k(!1)}},Z=()=>{if(!A.wilaya||!T)return 0;let e={Alger:{domicile:400,stop_desk:200},Oran:{domicile:600,stop_desk:300},Constantine:{domicile:800,stop_desk:400},Blida:{domicile:500,stop_desk:250},Setif:{domicile:700,stop_desk:350},Annaba:{domicile:900,stop_desk:450},Batna:{domicile:1e3,stop_desk:500},Djelfa:{domicile:1200,stop_desk:600},"Sidi Bel Abbes":{domicile:800,stop_desk:400},Biskra:{domicile:1e3,stop_desk:500},Tebessa:{domicile:1100,stop_desk:550},"El Oued":{domicile:1200,stop_desk:600},Khenchela:{domicile:1100,stop_desk:550},"Oum El Bouaghi":{domicile:1e3,stop_desk:500},Bouira:{domicile:500,stop_desk:250},Mostaganem:{domicile:800,stop_desk:400},Tlemcen:{domicile:900,stop_desk:450},Tiaret:{domicile:800,stop_desk:400},Chlef:{domicile:600,stop_desk:300},Laghouat:{domicile:1e3,stop_desk:500},Ouargla:{domicile:1200,stop_desk:600},Jijel:{domicile:800,stop_desk:400},Mila:{domicile:700,stop_desk:350},"Ain Defla":{domicile:500,stop_desk:250},Naama:{domicile:1e3,stop_desk:500},"Ain Temouchent":{domicile:800,stop_desk:400},Ghardaia:{domicile:1200,stop_desk:600},Relizane:{domicile:600,stop_desk:300},Timimoun:{domicile:1400,stop_desk:700},"Bordj Badji Mokhtar":{domicile:1600,stop_desk:800},"Ouled Djellal":{domicile:1200,stop_desk:600},"Beni Abbes":{domicile:1400,stop_desk:700},"In Salah":{domicile:1500,stop_desk:750},"In Guezzam":{domicile:1800,stop_desk:900},Touggourt:{domicile:1200,stop_desk:600},Djanet:{domicile:1600,stop_desk:800},"El M'Ghair":{domicile:1200,stop_desk:600},"El Menia":{domicile:1300,stop_desk:650}}[A.wilaya];return e?e[T]:0};if(f)return(0,i.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,i.jsx)(r.default,{}),(0,i.jsx)("div",{className:"pt-24 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-white text-lg",children:"Loading checkout..."})]})})]});let P=Z(),q=l();return(0,i.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,i.jsx)(r.default,{}),(0,i.jsx)("div",{className:"pt-20 pb-8 px-4",children:(0,i.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,i.jsxs)("button",{onClick:()=>window.history.back(),className:"flex items-center gap-2 text-white hover:text-purple-400 transition-colors mb-6",children:[(0,i.jsx)(c.Z,{size:20}),"Back"]}),(0,i.jsx)("h1",{className:"text-2xl font-black text-white mb-6 text-center",children:"CART CHECKOUT"}),(0,i.jsxs)("form",{onSubmit:I,className:"grid lg:grid-cols-2 gap-8",children:[(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"bg-white/5 border border-white/20 p-4 rounded-lg",children:[(0,i.jsxs)("h2",{className:"text-lg font-black text-white mb-3 flex items-center gap-2",children:[(0,i.jsx)(h.Z,{className:"w-5 h-5"}),"CUSTOMER INFORMATION"]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white font-bold uppercase tracking-wider mb-2",children:"FULL NAME *"}),(0,i.jsx)("input",{type:"text",value:A.name,onChange:e=>z({...A,name:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-black border-2 border-white text-white rounded-lg focus:border-purple-500 focus:outline-none",placeholder:"Your full name"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white font-bold uppercase tracking-wider mb-2",children:"PHONE NUMBER *"}),(0,i.jsx)("input",{type:"tel",value:A.phone,onChange:e=>z({...A,phone:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-black border-2 border-white text-white rounded-lg focus:border-purple-500 focus:outline-none",placeholder:"0123456789"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white font-bold uppercase tracking-wider mb-2",children:"EMAIL"}),(0,i.jsx)("input",{type:"email",value:A.email,onChange:e=>z({...A,email:e.target.value}),className:"w-full px-4 py-3 bg-black border-2 border-white text-white rounded-lg focus:border-purple-500 focus:outline-none",placeholder:"your@email.com"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white font-bold uppercase tracking-wider mb-2",children:"WILAYA *"}),(0,i.jsxs)("select",{value:A.wilaya,onChange:e=>z({...A,wilaya:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-black border-2 border-white text-white rounded-lg focus:border-purple-500 focus:outline-none",children:[(0,i.jsx)("option",{value:"",children:"Select your wilaya"}),(0,i.jsx)("option",{value:"Alger",children:"Alger"}),(0,i.jsx)("option",{value:"Oran",children:"Oran"}),(0,i.jsx)("option",{value:"Constantine",children:"Constantine"}),(0,i.jsx)("option",{value:"Blida",children:"Blida"}),(0,i.jsx)("option",{value:"Setif",children:"Setif"}),(0,i.jsx)("option",{value:"Annaba",children:"Annaba"}),(0,i.jsx)("option",{value:"Batna",children:"Batna"}),(0,i.jsx)("option",{value:"Djelfa",children:"Djelfa"}),(0,i.jsx)("option",{value:"Sidi Bel Abbes",children:"Sidi Bel Abbes"}),(0,i.jsx)("option",{value:"Biskra",children:"Biskra"}),(0,i.jsx)("option",{value:"Tebessa",children:"Tebessa"}),(0,i.jsx)("option",{value:"El Oued",children:"El Oued"}),(0,i.jsx)("option",{value:"Khenchela",children:"Khenchela"}),(0,i.jsx)("option",{value:"Oum El Bouaghi",children:"Oum El Bouaghi"}),(0,i.jsx)("option",{value:"Bouira",children:"Bouira"}),(0,i.jsx)("option",{value:"Mostaganem",children:"Mostaganem"}),(0,i.jsx)("option",{value:"Tlemcen",children:"Tlemcen"}),(0,i.jsx)("option",{value:"Tiaret",children:"Tiaret"}),(0,i.jsx)("option",{value:"Chlef",children:"Chlef"}),(0,i.jsx)("option",{value:"Laghouat",children:"Laghouat"}),(0,i.jsx)("option",{value:"Ouargla",children:"Ouargla"}),(0,i.jsx)("option",{value:"Jijel",children:"Jijel"}),(0,i.jsx)("option",{value:"Mila",children:"Mila"}),(0,i.jsx)("option",{value:"Ain Defla",children:"Ain Defla"}),(0,i.jsx)("option",{value:"Naama",children:"Naama"}),(0,i.jsx)("option",{value:"Ain Temouchent",children:"Ain Temouchent"}),(0,i.jsx)("option",{value:"Ghardaia",children:"Ghardaia"}),(0,i.jsx)("option",{value:"Relizane",children:"Relizane"}),(0,i.jsx)("option",{value:"Timimoun",children:"Timimoun"}),(0,i.jsx)("option",{value:"Bordj Badji Mokhtar",children:"Bordj Badji Mokhtar"}),(0,i.jsx)("option",{value:"Ouled Djellal",children:"Ouled Djellal"}),(0,i.jsx)("option",{value:"Beni Abbes",children:"Beni Abbes"}),(0,i.jsx)("option",{value:"In Salah",children:"In Salah"}),(0,i.jsx)("option",{value:"In Guezzam",children:"In Guezzam"}),(0,i.jsx)("option",{value:"Touggourt",children:"Touggourt"}),(0,i.jsx)("option",{value:"Djanet",children:"Djanet"}),(0,i.jsx)("option",{value:"El M'Ghair",children:"El M'Ghair"}),(0,i.jsx)("option",{value:"El Menia",children:"El Menia"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-white font-bold uppercase tracking-wider mb-2",children:"ADDRESS"}),(0,i.jsx)("textarea",{value:A.address,onChange:e=>z({...A,address:e.target.value}),rows:3,className:"w-full px-4 py-3 bg-black border-2 border-white text-white rounded-lg focus:border-purple-500 focus:outline-none resize-none",placeholder:"Your full address"})]})]})]}),(0,i.jsxs)("div",{className:"bg-white/5 border border-white/20 p-4 rounded-lg",children:[(0,i.jsxs)("h2",{className:"text-lg font-black text-white mb-3 flex items-center gap-2",children:[(0,i.jsx)(u.Z,{className:"w-5 h-5"}),"DELIVERY OPTIONS"]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"p-4 border-2 rounded-lg cursor-pointer transition-colors ".concat("domicile"===T?"border-purple-500 bg-purple-500/20":"border-gray-600 hover:border-gray-500"),onClick:()=>B("domicile"),children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(p.Z,{className:"w-5 h-5 text-purple-400"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold text-white",children:"Home Delivery"}),(0,i.jsx)("p",{className:"text-gray-400 text-sm",children:"Delivered to your address"})]})]})}),(0,i.jsx)("div",{className:"p-4 border-2 rounded-lg cursor-pointer transition-colors ".concat("stop_desk"===T?"border-purple-500 bg-purple-500/20":"border-gray-600 hover:border-gray-500"),onClick:()=>B("stop_desk"),children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(m,{className:"w-5 h-5 text-purple-400"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold text-white",children:"Stop Desk"}),(0,i.jsx)("p",{className:"text-gray-400 text-sm",children:"Pick up from nearest stop desk"})]})]})})]})]})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"bg-white/5 border border-white/20 p-4 rounded-lg",children:[(0,i.jsxs)("h2",{className:"text-lg font-black text-white mb-3 flex items-center gap-2",children:[(0,i.jsx)(x.Z,{className:"w-5 h-5"}),"ORDER ITEMS"]}),(0,i.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,i.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-white/5 border border-white/20 rounded",children:[(0,i.jsx)("img",{src:e.image,alt:e.name,className:"w-16 h-16 object-cover rounded"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h3",{className:"font-bold text-white",children:e.name}),(0,i.jsxs)("p",{className:"text-gray-400 text-sm",children:["Size: ",e.selectedSize," • Color: ",e.selectedColor]}),(0,i.jsxs)("p",{className:"text-gray-400 text-sm",children:["Quantity: ",e.quantity]})]}),(0,i.jsx)("div",{className:"text-right",children:(0,i.jsxs)("p",{className:"font-bold text-white",children:[(e.price*e.quantity).toFixed(0)," DZD"]})})]},e.id))})]}),(0,i.jsxs)("div",{className:"bg-white/5 border border-white/20 p-4 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-lg font-black text-white mb-3",children:"ORDER SUMMARY"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-400",children:"Subtotal:"}),(0,i.jsxs)("span",{className:"text-white font-medium",children:[q.toFixed(0)," DZD"]})]}),T&&A.wilaya&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)("span",{className:"text-gray-400",children:["Delivery (","domicile"===T?"Home":"Stop Desk","):"]}),(0,i.jsxs)("span",{className:"text-white font-medium",children:[P.toFixed(0)," DZD"]})]}),(0,i.jsx)("div",{className:"border-t border-gray-700 pt-4",children:(0,i.jsxs)("div",{className:"flex justify-between text-lg font-black",children:[(0,i.jsx)("span",{children:"Total:"}),(0,i.jsxs)("span",{children:[(q+P).toFixed(0)," DZD"]})]})})]})]}),(0,i.jsx)("button",{type:"submit",disabled:g,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white font-black py-4 px-6 rounded transition-colors flex items-center justify-center gap-2 disabled:cursor-not-allowed",children:g?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"PLACING ORDER..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{size:20}),"PLACE ORDER"]})})]})]})]})}),(0,i.jsx)(n.default,{}),(0,i.jsx)(d.Z,{isOpen:N,onClose:()=>_(!1),orderId:S,orderData:D,redirectCountdown:y})]})}}},function(e){e.O(0,[192,518,994,971,938,744],function(){return e(e.s=4578)}),_N_E=e.O()}]);