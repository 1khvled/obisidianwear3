(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2898:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),s=(e,t)=>{let n=(0,a.forwardRef)(({color:n="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:l="",children:u,...d},h)=>(0,a.createElement)("svg",{ref:h,...r,width:s,height:s,stroke:n,strokeWidth:c?24*Number(o)/Number(s):o,className:["lucide",`lucide-${i(e)}`,l].join(" "),...d},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(u)?u:[u]]));return n.displayName=`${e}`,n}},3008:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,n(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2549:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,n(2898).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},864:function(e,t,n){Promise.resolve().then(n.t.bind(n,5975,23)),Promise.resolve().then(n.t.bind(n,9979,23)),Promise.resolve().then(n.t.bind(n,3385,23)),Promise.resolve().then(n.bind(n,573)),Promise.resolve().then(n.bind(n,5501)),Promise.resolve().then(n.bind(n,5049)),Promise.resolve().then(n.bind(n,9298)),Promise.resolve().then(n.bind(n,7023)),Promise.resolve().then(n.bind(n,6713)),Promise.resolve().then(n.bind(n,3006))},573:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(7437),r=n(2265),i=n(4033),s=n(7508);function o(){let e=(0,i.usePathname)(),t=(0,i.useRouter)(),{status:n,loading:o,error:c}=(0,s.q)(),[l,u]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{if(e.startsWith("/admin")||"/maintenance"===e||e.startsWith("/_next")||e.includes(".")){u(!1);return}!o&&n&&(n.is_maintenance&&"/maintenance"!==e&&(console.log("\uD83D\uDD34 Store is in MAINTENANCE MODE - Redirecting to maintenance page"),t.push("/maintenance")),u(!1))},[e,t,n,o]),l)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-gray-900 rounded-lg p-6 flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),(0,a.jsx)("span",{className:"text-white",children:"Checking store status..."})]})}):null}},5501:function(e,t,n){"use strict";n.r(t),n.d(t,{AuthProvider:function(){return u},useAuth:function(){return d}});var a=n(7437),r=n(2265),i=n(2671);class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}generateSessionId(){{let e=sessionStorage.getItem("obsidian-admin-session-id");return e||(e="admin_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("obsidian-admin-session-id",e)),e}}async createSession(e){try{if(!i.OQ)return console.error("Supabase client not initialized"),!1;let t=new Date(Date.now()+this.SESSION_DURATION).toISOString(),{error:n}=await i.OQ.from("admin_sessions").upsert({session_id:this.sessionId,username:e,is_active:!0,expires_at:t});if(n)return console.error("Error creating session:",n),!1;return!0}catch(e){return console.error("Error creating session:",e),!1}}async getSession(){try{if(!i.OQ)return console.error("Supabase client not initialized"),null;let{data:e,error:t}=await i.OQ.from("admin_sessions").select("*").eq("session_id",this.sessionId).eq("is_active",!0).single();if(t&&"PGRST116"!==t.code)return console.error("Error fetching session:",t),null;if(!e)return null;let n=new Date,a=new Date(e.expires_at);if(n>a)return await this.deactivateSession(),null;return e}catch(e){return console.error("Error fetching session:",e),null}}async deactivateSession(){try{if(!i.OQ)return console.error("Supabase client not initialized"),!1;let{error:e}=await i.OQ.from("admin_sessions").update({is_active:!1}).eq("session_id",this.sessionId);if(e)return console.error("Error deactivating session:",e),!1;return!0}catch(e){return console.error("Error deactivating session:",e),!1}}async isAuthenticated(){return null!==await this.getSession()}async getUsername(){let e=await this.getSession();return(null==e?void 0:e.username)||null}async cleanupExpiredSessions(){try{if(!i.OQ){console.error("Supabase client not initialized");return}let e=new Date().toISOString();await i.OQ.from("admin_sessions").update({is_active:!1}).lt("expires_at",e)}catch(e){console.error("Error cleaning up expired sessions:",e)}}constructor(){this.SESSION_DURATION=864e5,this.sessionId=this.generateSessionId()}}var o=s.getInstance();let c=(0,r.createContext)(void 0),l={username:"admin",password:"admin123"},u=e=>{let{children:t}=e,[n,i]=(0,r.useState)(!1),[s,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{try{if(h(!0),await o.isAuthenticated()){let e=await o.getUsername();i(!0),u(e||"")}else i(!1),u("")}catch(e){console.error("Error checking authentication:",e),i(!1),u("")}finally{h(!1)}})()},[]);let m=async(e,t)=>{if(e===l.username&&t===l.password)try{if(await o.createSession(e))return i(!0),u(e),!0}catch(e){console.error("Error creating session:",e)}return!1},f=async()=>{try{await o.deactivateSession(),i(!1),u("")}catch(e){console.error("Error logging out:",e)}};return(0,a.jsx)(c.Provider,{value:{isAuthenticated:n,login:m,logout:f,username:s,loading:d},children:t})},d=()=>{let e=(0,r.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6713:function(e,t,n){"use strict";n.r(t),n.d(t,{ThemeProvider:function(){return s},useTheme:function(){return o}});var a=n(7437),r=n(2265);let i=(0,r.createContext)(void 0);function s(e){let{children:t}=e,[s,o]=(0,r.useState)("dark");return(0,r.useEffect)(()=>{(async()=>{try{let e=(await n.e(755).then(n.bind(n,9755))).default,t=await e.getTheme();if(t&&("light"===t||"dark"===t))o(t);else{let t=localStorage.getItem("admin-theme");t&&("light"===t||"dark"===t)&&(o(t),await e.setTheme(t))}}catch(t){console.error("Error loading theme:",t);let e=localStorage.getItem("admin-theme");e&&("light"===e||"dark"===e)&&o(e)}})()},[]),(0,r.useEffect)(()=>{if(localStorage.setItem("admin-theme",s),(async()=>{try{let e=(await n.e(755).then(n.bind(n,9755))).default;await e.setTheme(s)}catch(e){console.error("Error saving theme to database:",e)}})(),"undefined"!=typeof document){document.documentElement.setAttribute("data-theme",s);let e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content","dark"===s?"#000000":"#ffffff")}},[s]),(0,a.jsx)(i.Provider,{value:{theme:s,toggleTheme:()=>{o(e=>"dark"===e?"light":"dark")},setTheme:e=>{o(e)}},children:t})}function o(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},7508:function(e,t,n){"use strict";n.d(t,{q:function(){return o}});var a=n(2265),r=n(2671);class i{async getMaintenanceStatus(){let e=Date.now();if(this.cache&&e-this.lastFetch<this.cacheTimeout)return this.cache;try{if(!r.OQ)return console.error("Supabase client not initialized"),{is_maintenance:!1,drop_date:null};let{data:t,error:n}=await r.OQ.from("maintenance_status").select("*").eq("id","maintenance").single();if(n)throw n;let a=t||{id:"maintenance",is_maintenance:!1,drop_date:new Date(Date.now()+2592e6).toISOString(),updated_at:new Date().toISOString()};return this.cache=a,this.lastFetch=e,a}catch(e){return console.error("Failed to fetch maintenance status:",e),this.cache||{id:"maintenance",is_maintenance:!1,drop_date:new Date(Date.now()+2592e6).toISOString(),updated_at:new Date().toISOString()}}}async setMaintenanceStatus(e){try{var t;let n="offline"===e,a={id:"maintenance",is_maintenance:n,drop_date:(null===(t=this.cache)||void 0===t?void 0:t.drop_date)||new Date(Date.now()+2592e6).toISOString(),updated_at:new Date().toISOString()};return this.cache=a,this.lastFetch=Date.now(),setTimeout(async()=>{try{if(!r.OQ){console.error("Supabase client not initialized");return}let{error:e}=await r.OQ.from("maintenance_status").update({is_maintenance:n,updated_at:new Date().toISOString()}).eq("id","maintenance");e?console.error("Maintenance status update error:",e):console.log("Maintenance status updated successfully")}catch(e){console.error("Background maintenance update failed:",e)}},0),!0}catch(e){return console.error("Failed to set maintenance status:",e),!1}}async toggleMaintenanceStatus(){let e=(await this.getMaintenanceStatus()).is_maintenance?"online":"offline";return await this.setMaintenanceStatus(e)}async getMaintenanceAnalytics(){try{if(!r.OQ)return console.error("Supabase client not initialized"),null;let{data:e,error:t}=await r.OQ.rpc("get_maintenance_analytics");if(t)throw t;return(null==e?void 0:e[0])||null}catch(e){return console.error("Failed to get maintenance analytics:",e),null}}clearCache(){this.cache=null,this.lastFetch=0}getCachedStatus(){let e=Date.now();return this.cache&&e-this.lastFetch<this.cacheTimeout?this.cache:null}constructor(){this.cache=null,this.cacheTimeout=5e3,this.lastFetch=0}}let s=new i;function o(){let[e,t]=(0,a.useState)({id:"maintenance",is_maintenance:!1,drop_date:new Date(Date.now()+2592e6).toISOString(),updated_at:new Date().toISOString()}),[n,r]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null),[c,l]=(0,a.useState)(null),u=(0,a.useCallback)(async()=>{try{r(!0),o(null);let[e,n]=await Promise.all([s.getMaintenanceStatus(),s.getMaintenanceAnalytics()]);t(e),l(n)}catch(e){o(e instanceof Error?e.message:"Failed to load maintenance status")}finally{r(!1)}},[]),d=(0,a.useCallback)(async()=>{await u()},[u]),h=(0,a.useCallback)(async e=>{try{if(t(t=>({...t,status:e,updated_at:new Date().toISOString()})),!await s.setMaintenanceStatus(e))return await u(),!1;return!0}catch(e){return console.error("Failed to set maintenance status:",e),await u(),!1}},[u]),m=(0,a.useCallback)(async()=>{let t=e.is_maintenance?"online":"offline";return await h(t)},[e.is_maintenance,h]);return(0,a.useEffect)(()=>{u()},[u]),(0,a.useEffect)(()=>{let e=setInterval(()=>{n||u()},1e4);return()=>clearInterval(e)},[u,n]),{status:e,loading:n,error:i,toggleStatus:m,setStatus:h,refreshStatus:d,analytics:c}}},3385:function(){},5975:function(e){e.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c",variable:"__variable_e8ce0c"}},9979:function(e){e.exports={style:{fontFamily:"'__Poppins_51684b', '__Poppins_Fallback_51684b'",fontStyle:"normal"},className:"__className_51684b",variable:"__variable_51684b"}},4033:function(e,t,n){e.exports=n(5313)}},function(e){e.O(0,[872,671,690,23,971,938,744],function(){return e(e.s=864)}),_N_E=e.O()}]);