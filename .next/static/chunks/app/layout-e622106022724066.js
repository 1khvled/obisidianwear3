(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9434:function(e,t,r){Promise.resolve().then(r.t.bind(r,5975,23)),Promise.resolve().then(r.t.bind(r,9979,23)),Promise.resolve().then(r.t.bind(r,3385,23)),Promise.resolve().then(r.bind(r,573)),Promise.resolve().then(r.bind(r,8628)),Promise.resolve().then(r.bind(r,2095)),Promise.resolve().then(r.bind(r,9298)),Promise.resolve().then(r.bind(r,861)),Promise.resolve().then(r.bind(r,6713))},573:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var o=r(2265),n=r(4033);function a(){let e=(0,n.usePathname)(),t=(0,n.useRouter)(),[r,a]=(0,o.useState)(!1);(0,o.useEffect)(()=>{i()},[e]);let i=async()=>{if(e.startsWith("/admin")||"/maintenance"===e||e.startsWith("/_next")||e.includes(".")){a(!0);return}try{let r=await fetch("/api/maintenance"),o=await r.json();!0===o.is_maintenance_mode&&"/maintenance"!==e&&(console.log("\uD83D\uDD34 Store is OFF - Redirecting to maintenance page"),t.push("/maintenance"))}catch(e){console.error("Error checking store status:",e)}finally{a(!0)}};return null}},8628:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return i},useAuth:function(){return s}});var o=r(7437),n=r(2265);let a=(0,n.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)("");return(0,n.useEffect)(()=>{{let e=localStorage.getItem("obsidian-admin-auth"),t=localStorage.getItem("obsidian-admin-username");"true"===e&&t&&(i(!0),l(t))}},[]),(0,o.jsx)(a.Provider,{value:{isAuthenticated:r,login:(e,t)=>(i(!0),l(e),localStorage.setItem("obsidian-admin-auth","true"),localStorage.setItem("obsidian-admin-username",e),!0),logout:()=>{i(!1),l(""),localStorage.removeItem("obsidian-admin-auth"),localStorage.removeItem("obsidian-admin-username")},username:s},children:t})},s=()=>{let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2095:function(e,t,r){"use strict";r.r(t),r.d(t,{CartProvider:function(){return i},useCart:function(){return s}});var o=r(7437),n=r(2265);let a=(0,n.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,n.useState)([]),[s,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("obsidian-cart");if(e){let t=JSON.parse(e);if(Array.isArray(t)){let e=t.map(e=>({...e,addedAt:e.addedAt||new Date().toISOString()}));i(e),console.log("Cart loaded from localStorage:",e.length,"items")}else console.warn("Invalid cart data structure, clearing cart"),localStorage.removeItem("obsidian-cart")}d(null)}catch(e){console.error("Error loading cart from localStorage:",e),d("Failed to load cart data"),localStorage.removeItem("obsidian-cart")}finally{l(!0)}})()},[]),(0,n.useEffect)(()=>{if(s)try{localStorage.setItem("obsidian-cart",JSON.stringify(r)),console.log("Cart saved to localStorage:",r.length,"items"),d(null)}catch(e){console.error("Error saving cart to localStorage:",e),d("Failed to save cart data")}},[r,s]);let u=async(e,t,r,o)=>{console.log("CartContext: addToCart called with:",{product:e,selectedSize:t,selectedColor:r,quantity:o});let n="".concat(e.id,"-").concat(t,"-").concat(r);try{var a,s;let l=(null===(s=e.stock)||void 0===s?void 0:null===(a=s[t])||void 0===a?void 0:a[r])||0;if(e.stock){if(0===l){alert("❌ Size ".concat(t," in ").concat(r," is OUT OF STOCK!"));return}if(o>l){alert("❌ Not enough stock available in ".concat(t," ").concat(r,"!"));return}}else if(!e.inStock){alert("❌ This product is out of stock!");return}let c=await fetch("/api/inventory/reserve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e.id,size:t,color:r,quantity:o})});if(!c.ok){let e=await c.json();alert("❌ Inventory reservation failed: ".concat(e.error||"Unknown error"));return}i(a=>{let i=a.find(e=>e.id===n);if(i){let e=i.quantity+o;return a.map(t=>t.id===n?{...t,quantity:e}:t)}{let i={id:n,productId:e.id,name:e.name,price:e.price,image:e.image,selectedSize:t,selectedColor:r,quantity:o,addedAt:new Date().toISOString()};return[...a,i]}}),console.log("✅ Item added to cart and inventory reserved")}catch(e){console.error("❌ Error adding to cart:",e),alert("❌ Failed to add item to cart. Please try again.")}},f=async e=>{let t=r.find(t=>t.id===e);if(t)try{(await fetch("/api/inventory/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:t.productId,size:t.selectedSize,color:t.selectedColor,quantity:t.quantity})})).ok||console.error("❌ Failed to restore inventory, but removing from cart anyway"),i(t=>t.filter(t=>t.id!==e)),console.log("✅ Item removed from cart and inventory restored")}catch(t){console.error("❌ Error removing from cart:",t),i(t=>t.filter(t=>t.id!==e))}},m=async(e,t)=>{if(t<=0){await f(e);return}let o=r.find(t=>t.id===e);if(!o)return;let n=t-o.quantity;if(0!==n)try{if(n>0){let e=await fetch("/api/inventory/reserve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:o.productId,size:o.selectedSize,color:o.selectedColor,quantity:n})});if(!e.ok){let t=await e.json();alert("❌ Cannot increase quantity: ".concat(t.error||"Unknown error"));return}}else(await fetch("/api/inventory/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:o.productId,size:o.selectedSize,color:o.selectedColor,quantity:Math.abs(n)})})).ok||console.error("❌ Failed to restore inventory, but updating quantity anyway");i(r=>r.map(r=>r.id===e?{...r,quantity:t}:r)),console.log("✅ Quantity updated and inventory synced")}catch(e){console.error("❌ Error updating quantity:",e),alert("❌ Failed to update quantity. Please try again.")}},h=async()=>{for(let e of r)try{await fetch("/api/inventory/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e.productId,size:e.selectedSize,color:e.selectedColor,quantity:e.quantity})})}catch(t){console.error("❌ Failed to restore inventory for item:",e.id,t)}i([]),localStorage.removeItem("obsidian-cart"),console.log("✅ Cart cleared and all inventory restored")};return(0,o.jsx)(a.Provider,{value:{items:r,addToCart:u,removeFromCart:f,updateQuantity:m,clearCart:h,getTotalItems:()=>r.reduce((e,t)=>e+t.quantity,0),getTotalPrice:()=>r.reduce((e,t)=>e+t.price*t.quantity,0),isCartLoaded:s,cartError:c},children:t})},s=()=>{let e=(0,n.useContext)(a);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},861:function(e,t,r){"use strict";r.r(t),r.d(t,{SmartProductProvider:function(){return d},useAdminProducts:function(){return i.R},useProducts:function(){return u},useUserProducts:function(){return c}});var o=r(7437),n=r(2265),a=r(4033),i=r(7023),s=r(2042);r(3325),r(2136);let l=(0,n.createContext)(void 0),c=()=>{let e=(0,n.useContext)(l);if(void 0===e)throw Error("useUserProducts must be used within a UserProductProvider");return e},d=e=>{let{children:t}=e,r=(0,a.usePathname)();return(null==r?void 0:r.startsWith("/admin"))?(console.log("\uD83D\uDD27 Using AdminProductProvider (no cache)"),(0,o.jsx)(i.V,{children:t})):(console.log("\uD83D\uDE80 Using OptimizedUserDataProvider (loads all user data at once)"),(0,o.jsx)(s.V,{children:t}))},u=()=>{let e=(0,a.usePathname)();if(null==e?void 0:e.startsWith("/admin"))return(0,i.R)();{let e=(0,s.E)();return{products:e.products,loading:e.loading,lastUpdated:e.lastUpdated,timeUntilRefresh:e.timeUntilRefresh,refreshProducts:e.refreshAllData,getProduct:e.getProduct}}}},6713:function(e,t,r){"use strict";r.r(t),r.d(t,{ThemeProvider:function(){return i},useTheme:function(){return s}});var o=r(7437),n=r(2265);let a=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,n.useState)("dark");return(0,n.useEffect)(()=>{let e=localStorage.getItem("admin-theme");e&&i(e)},[]),(0,n.useEffect)(()=>{localStorage.setItem("admin-theme",r),document.documentElement.setAttribute("data-theme",r);let e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content","dark"===r?"#000000":"#ffffff")},[r]),(0,o.jsx)(a.Provider,{value:{theme:r,toggleTheme:()=>{i(e=>"dark"===e?"light":"dark")},setTheme:e=>{i(e)}},children:t})}function s(){let e=(0,n.useContext)(a);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},3385:function(){},5975:function(e){e.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c",variable:"__variable_e8ce0c"}},9979:function(e){e.exports={style:{fontFamily:"'__Poppins_51684b', '__Poppins_Fallback_51684b'",fontStyle:"normal"},className:"__className_51684b",variable:"__variable_51684b"}},622:function(e,t,r){"use strict";var o=r(2265),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var o,a={},c=null,d=null;for(o in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,o)&&!l.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===a[o]&&(a[o]=t[o]);return{$$typeof:n,type:e,key:c,ref:d,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},7437:function(e,t,r){"use strict";e.exports=r(622)},4033:function(e,t,r){e.exports=r(5313)}},function(e){e.O(0,[440,298,42,23,971,938,744],function(){return e(e.s=9434)}),_N_E=e.O()}]);