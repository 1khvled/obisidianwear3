"use strict";(()=>{var e={};e.id=666,e.ids=[666],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},49576:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>v,routeModule:()=>y,serverHooks:()=>I,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>q});var s={};r.r(s),r.d(s,{GET:()=>m,POST:()=>h});var n=r(95419),i=r(69108),o=r(99678),a=r(78070),u=r(32409),c=r(4627);let l="https://twlegtqcyydgjkycxngw.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3bGVndHFjeXlkZ2preWN4bmd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzQ2MDAsImV4cCI6MjA3Mjc1MDYwMH0.uD9GD_ksHCDgmmPAgR7fcLUAJHRJtTkT-J-SVjU-WR0";if(!l||!d)throw Error("Missing Supabase environment variables");let p=(0,u.eI)(l,d);async function m(){try{let{data:e,error:t}=await p.from("inventory").select(`
        *,
        products (
          id,
          name,
          image,
          price
        )
      `).order("created_at",{ascending:!1});if(t)return console.error("Inventory API: GET error:",t),a.Z.json({success:!1,error:"Failed to fetch inventory"},{status:500});return a.Z.json({success:!0,data:e,message:"Inventory fetched successfully",timestamp:Date.now()})}catch(e){return console.error("Inventory API: GET error:",e),a.Z.json({success:!1,error:"Failed to fetch inventory"},{status:500})}}let h=(0,c.QO)(async e=>{try{let t=await e.json();if(!t.productId||!t.size||!t.color)return a.Z.json({success:!1,error:"Product ID, size, and color are required"},{status:400});let r={id:`INV-${t.productId}-${t.size}-${t.color}`,product_id:t.productId,size:t.size,color:t.color,quantity:t.quantity||0,reserved_quantity:t.reservedQuantity||0,min_stock_level:t.minStockLevel||5,max_stock_level:t.maxStockLevel||100},{data:s,error:n}=await p.from("inventory").upsert([r]).select().single();if(n)return console.error("Inventory API: POST error:",n),a.Z.json({success:!1,error:"Failed to create/update inventory"},{status:500});return a.Z.json({success:!0,data:s,message:"Inventory updated successfully",timestamp:Date.now()})}catch(e){return console.error("Inventory API: POST error:",e),a.Z.json({success:!1,error:"Failed to create/update inventory"},{status:500})}}),y=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/inventory/route",pathname:"/api/inventory",filename:"route",bundlePath:"app/api/inventory/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\projectt\\src\\app\\api\\inventory\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:w,serverHooks:I,headerHooks:g,staticGenerationBailout:q}=y,f="/api/inventory/route";function x(){return(0,o.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:w})}},4627:(e,t,r)=>{r.d(t,{QO:()=>o});var s=r(78070);class n{constructor(e=6e4,t=100){this.requests=new Map,this.windowMs=e,this.maxRequests=t}isAllowed(e){let t=Date.now(),r=this.requests.get(e);return!r||t>r.resetTime?(this.requests.set(e,{count:1,resetTime:t+this.windowMs}),{allowed:!0,remaining:this.maxRequests-1,resetTime:t+this.windowMs}):r.count>=this.maxRequests?{allowed:!1,remaining:0,resetTime:r.resetTime}:(r.count++,this.requests.set(e,r),{allowed:!0,remaining:this.maxRequests-r.count,resetTime:r.resetTime})}cleanup(){let e=Date.now();this.requests.forEach((t,r)=>{e>t.resetTime&&this.requests.delete(r)})}}let i=new n(6e4,100);function o(e){return async(t,...r)=>{let n=new URL(t.url);if(["/api/maintenance","/api/test-db","/api/test-supabase"].some(e=>n.pathname.startsWith(e)))return e(t,...r);let o=function(e,t){let r=t.isAllowed(e);.01>Math.random()&&t.cleanup();let s={"X-RateLimit-Limit":t.maxRequests.toString(),"X-RateLimit-Remaining":r.remaining.toString(),"X-RateLimit-Reset":new Date(r.resetTime).toISOString()};return{allowed:r.allowed,headers:s}}(t.ip||t.headers.get("x-forwarded-for")||"unknown",i);return o.allowed?!function(e){let t=e.headers.get("authorization");return!!(t&&t.startsWith("Bearer "))&&t.substring(7)===(process.env.NEXT_PUBLIC_API_AUTH_TOKEN||"obsidian-api-token-2025")}(t)?s.Z.json({success:!1,error:"Unauthorized",message:"Authentication required"},{status:401,headers:o.headers}):e(t,...r):s.Z.json({success:!1,error:"Too Many Requests",message:"Rate limit exceeded. Please try again later."},{status:429,headers:o.headers})}}new n(3e5,5)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,2409],()=>r(49576));module.exports=s})();