"use strict";(()=>{var e={};e.id=364,e.ids=[364],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},79853:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>h,patchFetch:()=>k,requestAsyncStorage:()=>g,routeModule:()=>v,serverHooks:()=>I,staticGenerationAsyncStorage:()=>y,staticGenerationBailout:()=>j});var o={};t.r(o),t.d(o,{GET:()=>m,PUT:()=>l});var s=t(95419),n=t(69108),a=t(99678),i=t(78070),u=t(32409);let c="https://twlegtqcyydgjkycxngw.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3bGVndHFjeXlkZ2preWN4bmd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzQ2MDAsImV4cCI6MjA3Mjc1MDYwMH0.uD9GD_ksHCDgmmPAgR7fcLUAJHRJtTkT-J-SVjU-WR0";if(!c||!d)throw Error("Missing Supabase environment variables");let p=(0,u.eI)(c,d);async function l(e,{params:r}){try{let{id:t}=r,{quantity:o}=await e.json();console.log(`üîÑ Updating inventory record ${t} with quantity ${o}`);let s=t.replace("INV-","").split("-");if(s.length<3)return i.Z.json({success:!1,error:"Invalid inventory ID format"},{status:400});let n=s[0],a=s[1],u=s[2],{data:c,error:d}=await p.from("products").select("*").eq("id",n).single();if(d||!c)return console.error("‚ùå Product not found:",d),i.Z.json({success:!1,error:"Product not found"},{status:404});let l=c.stock||{};l[a]||(l[a]={}),l[a][u]=o;let{error:m}=await p.from("products").update({stock:l,in_stock:Object.values(l).some(e=>Object.values(e).some(e=>e>0))}).eq("id",n);if(m)return console.error("‚ùå Error updating product stock:",m),i.Z.json({success:!1,error:"Failed to update product stock"},{status:500});return console.log(`‚úÖ Successfully updated stock for ${c.name} - ${a} ${u}: ${o}`),i.Z.json({success:!0,message:"Inventory updated successfully",data:{id:t,product_id:n,size:a,color:u,quantity:o,product_name:c.name}})}catch(e){return console.error("‚ùå Error updating inventory:",e),i.Z.json({success:!1,error:"Internal server error"},{status:500})}}async function m(e,{params:r}){try{let{id:e}=r,t=e.replace("INV-","").split("-");if(t.length<3)return i.Z.json({success:!1,error:"Invalid inventory ID format"},{status:400});let o=t[0],s=t[1],n=t[2],{data:a,error:u}=await p.from("products").select("*").eq("id",o).single();if(u||!a)return i.Z.json({success:!1,error:"Product not found"},{status:404});let c=a.stock||{},d=c[s]?.[n]||0;return i.Z.json({success:!0,data:{id:e,product_id:o,size:s,color:n,quantity:d,product_name:a.name,product_image:a.image}})}catch(e){return console.error("‚ùå Error getting inventory record:",e),i.Z.json({success:!1,error:"Internal server error"},{status:500})}}let v=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/inventory/[id]/route",pathname:"/api/inventory/[id]",filename:"route",bundlePath:"app/api/inventory/[id]/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\Obsidian wear\\projectt\\src\\app\\api\\inventory\\[id]\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:y,serverHooks:I,headerHooks:f,staticGenerationBailout:j}=v,h="/api/inventory/[id]/route";function k(){return(0,a.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:y})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,6206,2409],()=>t(79853));module.exports=o})();