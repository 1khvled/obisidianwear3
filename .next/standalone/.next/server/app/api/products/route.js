"use strict";(()=>{var e={};e.id=9684,e.ids=[9684],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},86366:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>D,originalPathname:()=>y,patchFetch:()=>A,requestAsyncStorage:()=>P,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var s={};r.r(s),r.d(s,{GET:()=>d,POST:()=>m,runtime:()=>l});var o=r(95419),i=r(69108),a=r(99678),n=r(78070),u=r(4750),c=r(50316);let l="nodejs";async function d(){try{let e=await (0,u.Xp)();return console.log("Products API: GET request - returning",e.length,"products"),n.Z.json({success:!0,data:e,count:e.length,timestamp:Date.now()})}catch(e){return console.error("Products API: GET error:",e),n.Z.json({success:!1,error:"Failed to fetch products"},{status:500})}}async function m(e){try{console.log("\uD83D\uDD27 Products API: POST request received");let t=await e.json();console.log("\uD83D\uDD27 Products API: Product data:",JSON.stringify(t,null,2));let r=c.v.validateRequired(t,["name","price"]);if(!r.isValid)return console.error("❌ Products API: Validation failed:",r.missingFields),n.Z.json({success:!1,error:`Missing required fields: ${r.missingFields.join(", ")}`},{status:400});if(!c.v.validateLength(t.name,1,100))return n.Z.json({success:!1,error:"Product name must be between 1 and 100 characters"},{status:400});if(console.log("\uD83D\uDD27 Products API: Validating price:",t.price,"Type:",typeof t.price),console.log("\uD83D\uDD27 Products API: Number conversion:",Number(t.price)),console.log("\uD83D\uDD27 Products API: Is NaN:",isNaN(Number(t.price))),!c.v.isValidNumber(t.price,0,999999))return console.error("❌ Products API: Price validation failed for:",t.price),n.Z.json({success:!1,error:"Price must be a valid number between 0 and 999999"},{status:400});let s=c.v.sanitizeProductData(t),o={id:Date.now().toString(),...s,createdAt:new Date,updatedAt:new Date};console.log("\uD83D\uDD27 Products API: Calling addProduct with:",o);try{let e=await (0,u.gK)(o);if(console.log("\uD83D\uDD27 Products API: addProduct result:",e),!e)return console.error("❌ Products API: addProduct returned null"),n.Z.json({success:!1,error:"Failed to create product - addProduct returned null"},{status:500});return n.Z.json({success:!0,data:e,message:"Product created successfully"})}catch(e){return console.error("❌ Products API: addProduct threw error:",e),console.error("❌ Products API: Error type:",typeof e),console.error("❌ Products API: Error stack:",e instanceof Error?e.stack:"No stack"),n.Z.json({success:!1,error:"Failed to create product",details:e instanceof Error?e.message:"Unknown error",errorType:typeof e,fullError:JSON.stringify(e,null,2)},{status:500})}}catch(e){return console.error("❌ Products API: POST error:",e),console.error("❌ Products API: Error details:",e instanceof Error?e.message:"Unknown error"),n.Z.json({success:!1,error:"Failed to create product",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\projectt\\src\\app\\api\\products\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:P,staticGenerationAsyncStorage:h,serverHooks:g,headerHooks:D,staticGenerationBailout:f}=p,y="/api/products/route";function A(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},50316:(e,t,r)=>{r.d(t,{v:()=>s});class s{static sanitizeHtml(e){return"string"!=typeof e?"":e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}static isValidEmail(e){return"string"==typeof e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())}static isValidPhone(e){return"string"==typeof e&&/^[\+]?[0-9\s\-\(\)]{8,}$/.test(e.trim())}static validateRequired(e,t){let r=[];for(let s of t)e[s]&&("string"!=typeof e[s]||""!==e[s].trim())||r.push(s);return{isValid:0===r.length,missingFields:r}}static validateLength(e,t,r){if("string"!=typeof e)return!1;let s=e.trim().length;return s>=t&&s<=r}static isValidNumber(e,t,r){let s=Number(e);return!isNaN(s)&&(void 0===t||!(s<t))&&(void 0===r||!(s>r))}static sanitizeProductData(e){return{...e,name:this.sanitizeHtml(e.name||""),description:this.sanitizeHtml(e.description||""),category:this.sanitizeHtml(e.category||""),price:this.isValidNumber(e.price,0,999999)?Number(e.price):0,stock:e.stock||{},image:this.sanitizeHtml(e.image||""),colors:Array.isArray(e.colors)?e.colors.map(e=>this.sanitizeHtml(e)):[],sizes:Array.isArray(e.sizes)?e.sizes.map(e=>this.sanitizeHtml(e)):[]}}static sanitizeOrderData(e){return{...e,customerName:this.sanitizeHtml(e.customerName||""),customerEmail:this.isValidEmail(e.customerEmail)?e.customerEmail.trim():"",customerPhone:this.isValidPhone(e.customerPhone)?e.customerPhone.trim():"",customerAddress:this.sanitizeHtml(e.customerAddress||""),productName:this.sanitizeHtml(e.productName||""),selectedSize:this.sanitizeHtml(e.selectedSize||""),selectedColor:this.sanitizeHtml(e.selectedColor||""),notes:this.sanitizeHtml(e.notes||""),quantity:this.isValidNumber(e.quantity,1,100)?Number(e.quantity):1,total:this.isValidNumber(e.total,0,999999)?Number(e.total):0}}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,2409,4750],()=>r(86366));module.exports=s})();