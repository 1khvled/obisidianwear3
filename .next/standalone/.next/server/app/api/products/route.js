"use strict";(()=>{var e={};e.id=9684,e.ids=[9684],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},86366:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>A,patchFetch:()=>I,requestAsyncStorage:()=>g,routeModule:()=>P,serverHooks:()=>h,staticGenerationAsyncStorage:()=>D,staticGenerationBailout:()=>y});var s={};t.r(s),t.d(s,{DELETE:()=>m,GET:()=>l,POST:()=>p,runtime:()=>d});var o=t(95419),i=t(69108),a=t(99678),u=t(78070),c=t(4750),n=t(50316);let d="nodejs";async function l(){try{let e=await (0,c.Xp)();return console.log("Products API: GET request - returning",e.length,"products"),u.Z.json({success:!0,data:e,count:e.length,timestamp:Date.now()})}catch(e){return console.error("Products API: GET error:",e),u.Z.json({success:!1,error:"Failed to fetch products"},{status:500})}}async function p(e){try{console.log("\uD83D\uDD27 Products API: POST request received");let r=await e.json();console.log("\uD83D\uDD27 Products API: Product data:",JSON.stringify(r,null,2));let t=n.v.validateRequired(r,["name","price"]);if(!t.isValid)return console.error("❌ Products API: Validation failed:",t.missingFields),u.Z.json({success:!1,error:`Missing required fields: ${t.missingFields.join(", ")}`},{status:400});if(!n.v.validateLength(r.name,1,100))return u.Z.json({success:!1,error:"Product name must be between 1 and 100 characters"},{status:400});if(console.log("\uD83D\uDD27 Products API: Validating price:",r.price,"Type:",typeof r.price),console.log("\uD83D\uDD27 Products API: Number conversion:",Number(r.price)),console.log("\uD83D\uDD27 Products API: Is NaN:",isNaN(Number(r.price))),!n.v.isValidNumber(r.price,0,999999))return console.error("❌ Products API: Price validation failed for:",r.price),u.Z.json({success:!1,error:"Price must be a valid number between 0 and 999999"},{status:400});let s=n.v.sanitizeProductData(r),o={id:Date.now().toString(),...s,createdAt:new Date,updatedAt:new Date};console.log("\uD83D\uDD27 Products API: Calling addProduct with:",o);try{let e=await (0,c.gK)(o);if(console.log("\uD83D\uDD27 Products API: addProduct result:",e),!e)return console.error("❌ Products API: addProduct returned null"),u.Z.json({success:!1,error:"Failed to create product - addProduct returned null"},{status:500});return u.Z.json({success:!0,data:e,message:"Product created successfully"})}catch(e){return console.error("❌ Products API: addProduct threw error:",e),console.error("❌ Products API: Error type:",typeof e),console.error("❌ Products API: Error stack:",e instanceof Error?e.stack:"No stack"),u.Z.json({success:!1,error:"Failed to create product",details:e instanceof Error?e.message:"Unknown error",errorType:typeof e,fullError:JSON.stringify(e,null,2)},{status:500})}}catch(e){return console.error("❌ Products API: POST error:",e),console.error("❌ Products API: Error details:",e instanceof Error?e.message:"Unknown error"),u.Z.json({success:!1,error:"Failed to create product",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function m(e){try{console.log("\uD83D\uDD27 Products API: DELETE request received");let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return console.error("❌ Products API: No product ID provided"),u.Z.json({success:!1,error:"Product ID is required"},{status:400});if(console.log("\uD83D\uDD27 Products API: Deleting product with ID:",t),await (0,c.Ir)(t))return console.log("✅ Products API: Product deleted successfully"),u.Z.json({success:!0,message:"Product deleted successfully",deletedId:t});return console.error("❌ Products API: Failed to delete product"),u.Z.json({success:!1,error:"Failed to delete product"},{status:500})}catch(e){return console.error("❌ Products API: DELETE error:",e),u.Z.json({success:!1,error:"Failed to delete product",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let P=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"C:\\Users\\HP\\Desktop\\projectt\\src\\app\\api\\products\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:D,serverHooks:h,headerHooks:f,staticGenerationBailout:y}=P,A="/api/products/route";function I(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:D})}},50316:(e,r,t)=>{t.d(r,{v:()=>s});class s{static sanitizeHtml(e){return"string"!=typeof e?"":e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}static isValidEmail(e){return"string"==typeof e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())}static isValidPhone(e){return"string"==typeof e&&/^[\+]?[0-9\s\-\(\)]{8,}$/.test(e.trim())}static validateRequired(e,r){let t=[];for(let s of r)e[s]&&("string"!=typeof e[s]||""!==e[s].trim())||t.push(s);return{isValid:0===t.length,missingFields:t}}static validateLength(e,r,t){if("string"!=typeof e)return!1;let s=e.trim().length;return s>=r&&s<=t}static isValidNumber(e,r,t){let s=Number(e);return!isNaN(s)&&(void 0===r||!(s<r))&&(void 0===t||!(s>t))}static sanitizeProductData(e){return{...e,name:this.sanitizeHtml(e.name||""),description:this.sanitizeHtml(e.description||""),category:this.sanitizeHtml(e.category||""),price:this.isValidNumber(e.price,0,999999)?Number(e.price):0,stock:e.stock||{},image:this.sanitizeHtml(e.image||""),colors:Array.isArray(e.colors)?e.colors.map(e=>this.sanitizeHtml(e)):[],sizes:Array.isArray(e.sizes)?e.sizes.map(e=>this.sanitizeHtml(e)):[]}}static sanitizeOrderData(e){return{...e,customerName:this.sanitizeHtml(e.customerName||""),customerEmail:this.isValidEmail(e.customerEmail)?e.customerEmail.trim():"",customerPhone:this.isValidPhone(e.customerPhone)?e.customerPhone.trim():"",customerAddress:this.sanitizeHtml(e.customerAddress||""),productName:this.sanitizeHtml(e.productName||""),selectedSize:this.sanitizeHtml(e.selectedSize||""),selectedColor:this.sanitizeHtml(e.selectedColor||""),notes:this.sanitizeHtml(e.notes||""),quantity:this.isValidNumber(e.quantity,1,100)?Number(e.quantity):1,total:this.isValidNumber(e.total,0,999999)?Number(e.total):0}}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,2409,4750],()=>t(86366));module.exports=s})();